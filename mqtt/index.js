(()=>{var __webpack_modules__={3333:(e,t,r)=>{e.exports=r(6208)},7295:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(8537);class AbortSignal extends i.EventTarget{constructor(){super();throw new TypeError("AbortSignal cannot be constructed directly")}get aborted(){const e=n.get(this);if(typeof e!=="boolean"){throw new TypeError(`Expected 'this' to be an 'AbortSignal' object, but got ${this===null?"null":typeof this}`)}return e}}i.defineEventAttribute(AbortSignal.prototype,"abort");function createAbortSignal(){const e=Object.create(AbortSignal.prototype);i.EventTarget.call(e);n.set(e,false);return e}function abortSignal(e){if(n.get(e)!==false){return}n.set(e,true);e.dispatchEvent({type:"abort"})}const n=new WeakMap;Object.defineProperties(AbortSignal.prototype,{aborted:{enumerable:true}});if(typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol"){Object.defineProperty(AbortSignal.prototype,Symbol.toStringTag,{configurable:true,value:"AbortSignal"})}class AbortController{constructor(){s.set(this,createAbortSignal())}get signal(){return getSignal(this)}abort(){abortSignal(getSignal(this))}}const s=new WeakMap;function getSignal(e){const t=s.get(e);if(t==null){throw new TypeError(`Expected 'this' to be an 'AbortController' object, but got ${e===null?"null":typeof e}`)}return t}Object.defineProperties(AbortController.prototype,{signal:{enumerable:true},abort:{enumerable:true}});if(typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol"){Object.defineProperty(AbortController.prototype,Symbol.toStringTag,{configurable:true,value:"AbortController"})}t.AbortController=AbortController;t.AbortSignal=AbortSignal;t["default"]=AbortController;e.exports=AbortController;e.exports.AbortController=e.exports["default"]=AbortController;e.exports.AbortSignal=AbortSignal},2215:(e,t,r)=>{"use strict";const{Buffer:i}=r(4300);const n=Symbol.for("BufferList");function BufferList(e){if(!(this instanceof BufferList)){return new BufferList(e)}BufferList._init.call(this,e)}BufferList._init=function _init(e){Object.defineProperty(this,n,{value:true});this._bufs=[];this.length=0;if(e){this.append(e)}};BufferList.prototype._new=function _new(e){return new BufferList(e)};BufferList.prototype._offset=function _offset(e){if(e===0){return[0,0]}let t=0;for(let r=0;r<this._bufs.length;r++){const i=t+this._bufs[r].length;if(e<i||r===this._bufs.length-1){return[r,e-t]}t=i}};BufferList.prototype._reverseOffset=function(e){const t=e[0];let r=e[1];for(let e=0;e<t;e++){r+=this._bufs[e].length}return r};BufferList.prototype.get=function get(e){if(e>this.length||e<0){return undefined}const t=this._offset(e);return this._bufs[t[0]][t[1]]};BufferList.prototype.slice=function slice(e,t){if(typeof e==="number"&&e<0){e+=this.length}if(typeof t==="number"&&t<0){t+=this.length}return this.copy(null,0,e,t)};BufferList.prototype.copy=function copy(e,t,r,n){if(typeof r!=="number"||r<0){r=0}if(typeof n!=="number"||n>this.length){n=this.length}if(r>=this.length){return e||i.alloc(0)}if(n<=0){return e||i.alloc(0)}const copy=!!e;const s=this._offset(r);const o=n-r;let a=o;let l=copy&&t||0;let u=s[1];if(r===0&&n===this.length){if(!copy){return this._bufs.length===1?this._bufs[0]:i.concat(this._bufs,this.length)}for(let t=0;t<this._bufs.length;t++){this._bufs[t].copy(e,l);l+=this._bufs[t].length}return e}if(a<=this._bufs[s[0]].length-u){return copy?this._bufs[s[0]].copy(e,t,u,u+a):this._bufs[s[0]].slice(u,u+a)}if(!copy){e=i.allocUnsafe(o)}for(let t=s[0];t<this._bufs.length;t++){const r=this._bufs[t].length-u;if(a>r){this._bufs[t].copy(e,l,u);l+=r}else{this._bufs[t].copy(e,l,u,u+a);l+=r;break}a-=r;if(u){u=0}}if(e.length>l)return e.slice(0,l);return e};BufferList.prototype.shallowSlice=function shallowSlice(e,t){e=e||0;t=typeof t!=="number"?this.length:t;if(e<0){e+=this.length}if(t<0){t+=this.length}if(e===t){return this._new()}const r=this._offset(e);const i=this._offset(t);const n=this._bufs.slice(r[0],i[0]+1);if(i[1]===0){n.pop()}else{n[n.length-1]=n[n.length-1].slice(0,i[1])}if(r[1]!==0){n[0]=n[0].slice(r[1])}return this._new(n)};BufferList.prototype.toString=function toString(e,t,r){return this.slice(t,r).toString(e)};BufferList.prototype.consume=function consume(e){e=Math.trunc(e);if(Number.isNaN(e)||e<=0)return this;while(this._bufs.length){if(e>=this._bufs[0].length){e-=this._bufs[0].length;this.length-=this._bufs[0].length;this._bufs.shift()}else{this._bufs[0]=this._bufs[0].slice(e);this.length-=e;break}}return this};BufferList.prototype.duplicate=function duplicate(){const e=this._new();for(let t=0;t<this._bufs.length;t++){e.append(this._bufs[t])}return e};BufferList.prototype.append=function append(e){if(e==null){return this}if(e.buffer){this._appendBuffer(i.from(e.buffer,e.byteOffset,e.byteLength))}else if(Array.isArray(e)){for(let t=0;t<e.length;t++){this.append(e[t])}}else if(this._isBufferList(e)){for(let t=0;t<e._bufs.length;t++){this.append(e._bufs[t])}}else{if(typeof e==="number"){e=e.toString()}this._appendBuffer(i.from(e))}return this};BufferList.prototype._appendBuffer=function appendBuffer(e){this._bufs.push(e);this.length+=e.length};BufferList.prototype.indexOf=function(e,t,r){if(r===undefined&&typeof t==="string"){r=t;t=undefined}if(typeof e==="function"||Array.isArray(e)){throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.')}else if(typeof e==="number"){e=i.from([e])}else if(typeof e==="string"){e=i.from(e,r)}else if(this._isBufferList(e)){e=e.slice()}else if(Array.isArray(e.buffer)){e=i.from(e.buffer,e.byteOffset,e.byteLength)}else if(!i.isBuffer(e)){e=i.from(e)}t=Number(t||0);if(isNaN(t)){t=0}if(t<0){t=this.length+t}if(t<0){t=0}if(e.length===0){return t>this.length?this.length:t}const n=this._offset(t);let s=n[0];let o=n[1];for(;s<this._bufs.length;s++){const t=this._bufs[s];while(o<t.length){const r=t.length-o;if(r>=e.length){const r=t.indexOf(e,o);if(r!==-1){return this._reverseOffset([s,r])}o=t.length-e.length+1}else{const t=this._reverseOffset([s,o]);if(this._match(t,e)){return t}o++}}o=0}return-1};BufferList.prototype._match=function(e,t){if(this.length-e<t.length){return false}for(let r=0;r<t.length;r++){if(this.get(e+r)!==t[r]){return false}}return true};(function(){const e={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(const t in e){(function(t){if(e[t]===null){BufferList.prototype[t]=function(e,r){return this.slice(e,e+r)[t](0,r)}}else{BufferList.prototype[t]=function(r=0){return this.slice(r,r+e[t])[t](0)}}})(t)}})();BufferList.prototype._isBufferList=function _isBufferList(e){return e instanceof BufferList||BufferList.isBufferList(e)};BufferList.isBufferList=function isBufferList(e){return e!=null&&e[n]};e.exports=BufferList},3095:(e,t,r)=>{"use strict";const i=r(1621).Duplex;const n=r(757);const s=r(2215);function BufferListStream(e){if(!(this instanceof BufferListStream)){return new BufferListStream(e)}if(typeof e==="function"){this._callback=e;const t=function piper(e){if(this._callback){this._callback(e);this._callback=null}}.bind(this);this.on("pipe",(function onPipe(e){e.on("error",t)}));this.on("unpipe",(function onUnpipe(e){e.removeListener("error",t)}));e=null}s._init.call(this,e);i.call(this)}n(BufferListStream,i);Object.assign(BufferListStream.prototype,s.prototype);BufferListStream.prototype._new=function _new(e){return new BufferListStream(e)};BufferListStream.prototype._write=function _write(e,t,r){this._appendBuffer(e);if(typeof r==="function"){r()}};BufferListStream.prototype._read=function _read(e){if(!this.length){return this.push(null)}e=Math.min(e,this.length);this.push(this.slice(0,e));this.consume(e)};BufferListStream.prototype.end=function end(e){i.prototype.end.call(this,e);if(this._callback){this._callback(null,this.slice());this._callback=null}};BufferListStream.prototype._destroy=function _destroy(e,t){this._bufs.length=0;this.length=0;t(e)};BufferListStream.prototype._isBufferList=function _isBufferList(e){return e instanceof BufferListStream||e instanceof s||BufferListStream.isBufferList(e)};BufferListStream.isBufferList=s.isBufferList;e.exports=BufferListStream;e.exports.BufferListStream=BufferListStream;e.exports.BufferList=s},7243:(e,t,r)=>{t.formatArgs=formatArgs;t.save=save;t.load=load;t.useColors=useColors;t.storage=localstorage();t.destroy=(()=>{let e=false;return()=>{if(!e){e=true;console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}}})();t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function useColors(){if(typeof window!=="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)){return true}if(typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)){return false}return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function formatArgs(t){t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff);if(!this.useColors){return}const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let i=0;let n=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{if(e==="%%"){return}i++;if(e==="%c"){n=i}}));t.splice(n,0,r)}t.log=console.debug||console.log||(()=>{});function save(e){try{if(e){t.storage.setItem("debug",e)}else{t.storage.removeItem("debug")}}catch(e){}}function load(){let e;try{e=t.storage.getItem("debug")}catch(e){}if(!e&&typeof process!=="undefined"&&"env"in process){e=process.env.DEBUG}return e}function localstorage(){try{return localStorage}catch(e){}}e.exports=r(1282)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},1282:(e,t,r)=>{function setup(e){createDebug.debug=createDebug;createDebug.default=createDebug;createDebug.coerce=coerce;createDebug.disable=disable;createDebug.enable=enable;createDebug.enabled=enabled;createDebug.humanize=r(3212);createDebug.destroy=destroy;Object.keys(e).forEach((t=>{createDebug[t]=e[t]}));createDebug.names=[];createDebug.skips=[];createDebug.formatters={};function selectColor(e){let t=0;for(let r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r);t|=0}return createDebug.colors[Math.abs(t)%createDebug.colors.length]}createDebug.selectColor=selectColor;function createDebug(e){let t;let r=null;let i;let n;function debug(...e){if(!debug.enabled){return}const r=debug;const i=Number(new Date);const n=i-(t||i);r.diff=n;r.prev=t;r.curr=i;t=i;e[0]=createDebug.coerce(e[0]);if(typeof e[0]!=="string"){e.unshift("%O")}let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((t,i)=>{if(t==="%%"){return"%"}s++;const n=createDebug.formatters[i];if(typeof n==="function"){const i=e[s];t=n.call(r,i);e.splice(s,1);s--}return t}));createDebug.formatArgs.call(r,e);const o=r.log||createDebug.log;o.apply(r,e)}debug.namespace=e;debug.useColors=createDebug.useColors();debug.color=createDebug.selectColor(e);debug.extend=extend;debug.destroy=createDebug.destroy;Object.defineProperty(debug,"enabled",{enumerable:true,configurable:false,get:()=>{if(r!==null){return r}if(i!==createDebug.namespaces){i=createDebug.namespaces;n=createDebug.enabled(e)}return n},set:e=>{r=e}});if(typeof createDebug.init==="function"){createDebug.init(debug)}return debug}function extend(e,t){const r=createDebug(this.namespace+(typeof t==="undefined"?":":t)+e);r.log=this.log;return r}function enable(e){createDebug.save(e);createDebug.namespaces=e;createDebug.names=[];createDebug.skips=[];let t;const r=(typeof e==="string"?e:"").split(/[\s,]+/);const i=r.length;for(t=0;t<i;t++){if(!r[t]){continue}e=r[t].replace(/\*/g,".*?");if(e[0]==="-"){createDebug.skips.push(new RegExp("^"+e.slice(1)+"$"))}else{createDebug.names.push(new RegExp("^"+e+"$"))}}}function disable(){const e=[...createDebug.names.map(toNamespace),...createDebug.skips.map(toNamespace).map((e=>"-"+e))].join(",");createDebug.enable("");return e}function enabled(e){if(e[e.length-1]==="*"){return true}let t;let r;for(t=0,r=createDebug.skips.length;t<r;t++){if(createDebug.skips[t].test(e)){return false}}for(t=0,r=createDebug.names.length;t<r;t++){if(createDebug.names[t].test(e)){return true}}return false}function toNamespace(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}function coerce(e){if(e instanceof Error){return e.stack||e.message}return e}function destroy(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}createDebug.enable(createDebug.load());return createDebug}e.exports=setup},6248:(e,t,r)=>{if(typeof process==="undefined"||process.type==="renderer"||process.browser===true||process.__nwjs){e.exports=r(7243)}else{e.exports=r(4746)}},4746:(e,t,r)=>{const i=r(6224);const n=r(3837);t.init=init;t.log=log;t.formatArgs=formatArgs;t.save=save;t.load=load;t.useColors=useColors;t.destroy=n.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");t.colors=[6,2,3,4,5,1];try{const e=r(6750);if(e&&(e.stderr||e).level>=2){t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221]}}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let i=process.env[t];if(/^(yes|on|true|enabled)$/i.test(i)){i=true}else if(/^(no|off|false|disabled)$/i.test(i)){i=false}else if(i==="null"){i=null}else{i=Number(i)}e[r]=i;return e}),{});function useColors(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):i.isatty(process.stderr.fd)}function formatArgs(t){const{namespace:r,useColors:i}=this;if(i){const i=this.color;const n="[3"+(i<8?i:"8;5;"+i);const s=`  ${n};1m${r} [0m`;t[0]=s+t[0].split("\n").join("\n"+s);t.push(n+"m+"+e.exports.humanize(this.diff)+"[0m")}else{t[0]=getDate()+r+" "+t[0]}}function getDate(){if(t.inspectOpts.hideDate){return""}return(new Date).toISOString()+" "}function log(...e){return process.stderr.write(n.format(...e)+"\n")}function save(e){if(e){process.env.DEBUG=e}else{delete process.env.DEBUG}}function load(){return process.env.DEBUG}function init(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let i=0;i<r.length;i++){e.inspectOpts[r[i]]=t.inspectOpts[r[i]]}}e.exports=r(1282)(t);const{formatters:s}=e.exports;s.o=function(e){this.inspectOpts.colors=this.useColors;return n.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")};s.O=function(e){this.inspectOpts.colors=this.useColors;return n.inspect(e,this.inspectOpts)}},9499:(e,t,r)=>{var i=r(1621);var n=r(711);var s=r(757);var o=r(1080);var a=Buffer.from&&Buffer.from!==Uint8Array.from?Buffer.from([0]):new Buffer([0]);var onuncork=function(e,t){if(e._corked)e.once("uncork",t);else t()};var autoDestroy=function(e,t){if(e._autoDestroy)e.destroy(t)};var destroyer=function(e,t){return function(r){if(r)autoDestroy(e,r.message==="premature close"?null:r);else if(t&&!e._ended)e.end()}};var end=function(e,t){if(!e)return t();if(e._writableState&&e._writableState.finished)return t();if(e._writableState)return e.end(t);e.end();t()};var noop=function(){};var toStreams2=function(e){return new i.Readable({objectMode:true,highWaterMark:16}).wrap(e)};var Duplexify=function(e,t,r){if(!(this instanceof Duplexify))return new Duplexify(e,t,r);i.Duplex.call(this,r);this._writable=null;this._readable=null;this._readable2=null;this._autoDestroy=!r||r.autoDestroy!==false;this._forwardDestroy=!r||r.destroy!==false;this._forwardEnd=!r||r.end!==false;this._corked=1;this._ondrain=null;this._drained=false;this._forwarding=false;this._unwrite=null;this._unread=null;this._ended=false;this.destroyed=false;if(e)this.setWritable(e);if(t)this.setReadable(t)};s(Duplexify,i.Duplex);Duplexify.obj=function(e,t,r){if(!r)r={};r.objectMode=true;r.highWaterMark=16;return new Duplexify(e,t,r)};Duplexify.prototype.cork=function(){if(++this._corked===1)this.emit("cork")};Duplexify.prototype.uncork=function(){if(this._corked&&--this._corked===0)this.emit("uncork")};Duplexify.prototype.setWritable=function(e){if(this._unwrite)this._unwrite();if(this.destroyed){if(e&&e.destroy)e.destroy();return}if(e===null||e===false){this.end();return}var t=this;var r=n(e,{writable:true,readable:false},destroyer(this,this._forwardEnd));var ondrain=function(){var e=t._ondrain;t._ondrain=null;if(e)e()};var clear=function(){t._writable.removeListener("drain",ondrain);r()};if(this._unwrite)process.nextTick(ondrain);this._writable=e;this._writable.on("drain",ondrain);this._unwrite=clear;this.uncork()};Duplexify.prototype.setReadable=function(e){if(this._unread)this._unread();if(this.destroyed){if(e&&e.destroy)e.destroy();return}if(e===null||e===false){this.push(null);this.resume();return}var t=this;var r=n(e,{writable:false,readable:true},destroyer(this));var onreadable=function(){t._forward()};var onend=function(){t.push(null)};var clear=function(){t._readable2.removeListener("readable",onreadable);t._readable2.removeListener("end",onend);r()};this._drained=true;this._readable=e;this._readable2=e._readableState?e:toStreams2(e);this._readable2.on("readable",onreadable);this._readable2.on("end",onend);this._unread=clear;this._forward()};Duplexify.prototype._read=function(){this._drained=true;this._forward()};Duplexify.prototype._forward=function(){if(this._forwarding||!this._readable2||!this._drained)return;this._forwarding=true;var e;while(this._drained&&(e=o(this._readable2))!==null){if(this.destroyed)continue;this._drained=this.push(e)}this._forwarding=false};Duplexify.prototype.destroy=function(e,t){if(!t)t=noop;if(this.destroyed)return t(null);this.destroyed=true;var r=this;process.nextTick((function(){r._destroy(e);t(null)}))};Duplexify.prototype._destroy=function(e){if(e){var t=this._ondrain;this._ondrain=null;if(t)t(e);else this.emit("error",e)}if(this._forwardDestroy){if(this._readable&&this._readable.destroy)this._readable.destroy();if(this._writable&&this._writable.destroy)this._writable.destroy()}this.emit("close")};Duplexify.prototype._write=function(e,t,r){if(this.destroyed)return;if(this._corked)return onuncork(this,this._write.bind(this,e,t,r));if(e===a)return this._finish(r);if(!this._writable)return r();if(this._writable.write(e)===false)this._ondrain=r;else if(!this.destroyed)r()};Duplexify.prototype._finish=function(e){var t=this;this.emit("preend");onuncork(this,(function(){end(t._forwardEnd&&t._writable,(function(){if(t._writableState.prefinished===false)t._writableState.prefinished=true;t.emit("prefinish");onuncork(t,e)}))}))};Duplexify.prototype.end=function(e,t,r){if(typeof e==="function")return this.end(null,null,e);if(typeof t==="function")return this.end(e,null,t);this._ended=true;if(e)this.write(e);if(!this._writableState.ending&&!this._writableState.destroyed)this.write(a);return i.Writable.prototype.end.call(this,r)};e.exports=Duplexify},711:(e,t,r)=>{var i=r(3550);var noop=function(){};var isRequest=function(e){return e.setHeader&&typeof e.abort==="function"};var isChildProcess=function(e){return e.stdio&&Array.isArray(e.stdio)&&e.stdio.length===3};var eos=function(e,t,r){if(typeof t==="function")return eos(e,null,t);if(!t)t={};r=i(r||noop);var n=e._writableState;var s=e._readableState;var o=t.readable||t.readable!==false&&e.readable;var a=t.writable||t.writable!==false&&e.writable;var l=false;var onlegacyfinish=function(){if(!e.writable)onfinish()};var onfinish=function(){a=false;if(!o)r.call(e)};var onend=function(){o=false;if(!a)r.call(e)};var onexit=function(t){r.call(e,t?new Error("exited with error code: "+t):null)};var onerror=function(t){r.call(e,t)};var onclose=function(){process.nextTick(onclosenexttick)};var onclosenexttick=function(){if(l)return;if(o&&!(s&&(s.ended&&!s.destroyed)))return r.call(e,new Error("premature close"));if(a&&!(n&&(n.ended&&!n.destroyed)))return r.call(e,new Error("premature close"))};var onrequest=function(){e.req.on("finish",onfinish)};if(isRequest(e)){e.on("complete",onfinish);e.on("abort",onclose);if(e.req)onrequest();else e.on("request",onrequest)}else if(a&&!n){e.on("end",onlegacyfinish);e.on("close",onlegacyfinish)}if(isChildProcess(e))e.on("exit",onexit);e.on("end",onend);e.on("finish",onfinish);if(t.error!==false)e.on("error",onerror);e.on("close",onclose);return function(){l=true;e.removeListener("complete",onfinish);e.removeListener("abort",onclose);e.removeListener("request",onrequest);if(e.req)e.req.removeListener("finish",onfinish);e.removeListener("end",onlegacyfinish);e.removeListener("close",onlegacyfinish);e.removeListener("finish",onfinish);e.removeListener("exit",onexit);e.removeListener("end",onend);e.removeListener("error",onerror);e.removeListener("close",onclose)}};e.exports=eos},8537:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const r=new WeakMap;const i=new WeakMap;function pd(e){const t=r.get(e);console.assert(t!=null,"'this' is expected an Event object, but got",e);return t}function setCancelFlag(e){if(e.passiveListener!=null){if(typeof console!=="undefined"&&typeof console.error==="function"){console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener)}return}if(!e.event.cancelable){return}e.canceled=true;if(typeof e.event.preventDefault==="function"){e.event.preventDefault()}}function Event(e,t){r.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:false,stopped:false,immediateStopped:false,passiveListener:null,timeStamp:t.timeStamp||Date.now()});Object.defineProperty(this,"isTrusted",{value:false,enumerable:true});const i=Object.keys(t);for(let e=0;e<i.length;++e){const t=i[e];if(!(t in this)){Object.defineProperty(this,t,defineRedirectDescriptor(t))}}}Event.prototype={get type(){return pd(this).event.type},get target(){return pd(this).eventTarget},get currentTarget(){return pd(this).currentTarget},composedPath(){const e=pd(this).currentTarget;if(e==null){return[]}return[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return pd(this).eventPhase},stopPropagation(){const e=pd(this);e.stopped=true;if(typeof e.event.stopPropagation==="function"){e.event.stopPropagation()}},stopImmediatePropagation(){const e=pd(this);e.stopped=true;e.immediateStopped=true;if(typeof e.event.stopImmediatePropagation==="function"){e.event.stopImmediatePropagation()}},get bubbles(){return Boolean(pd(this).event.bubbles)},get cancelable(){return Boolean(pd(this).event.cancelable)},preventDefault(){setCancelFlag(pd(this))},get defaultPrevented(){return pd(this).canceled},get composed(){return Boolean(pd(this).event.composed)},get timeStamp(){return pd(this).timeStamp},get srcElement(){return pd(this).eventTarget},get cancelBubble(){return pd(this).stopped},set cancelBubble(e){if(!e){return}const t=pd(this);t.stopped=true;if(typeof t.event.cancelBubble==="boolean"){t.event.cancelBubble=true}},get returnValue(){return!pd(this).canceled},set returnValue(e){if(!e){setCancelFlag(pd(this))}},initEvent(){}};Object.defineProperty(Event.prototype,"constructor",{value:Event,configurable:true,writable:true});if(typeof window!=="undefined"&&typeof window.Event!=="undefined"){Object.setPrototypeOf(Event.prototype,window.Event.prototype);i.set(window.Event.prototype,Event)}function defineRedirectDescriptor(e){return{get(){return pd(this).event[e]},set(t){pd(this).event[e]=t},configurable:true,enumerable:true}}function defineCallDescriptor(e){return{value(){const t=pd(this).event;return t[e].apply(t,arguments)},configurable:true,enumerable:true}}function defineWrapper(e,t){const r=Object.keys(t);if(r.length===0){return e}function CustomEvent(t,r){e.call(this,t,r)}CustomEvent.prototype=Object.create(e.prototype,{constructor:{value:CustomEvent,configurable:true,writable:true}});for(let i=0;i<r.length;++i){const n=r[i];if(!(n in e.prototype)){const e=Object.getOwnPropertyDescriptor(t,n);const r=typeof e.value==="function";Object.defineProperty(CustomEvent.prototype,n,r?defineCallDescriptor(n):defineRedirectDescriptor(n))}}return CustomEvent}function getWrapper(e){if(e==null||e===Object.prototype){return Event}let t=i.get(e);if(t==null){t=defineWrapper(getWrapper(Object.getPrototypeOf(e)),e);i.set(e,t)}return t}function wrapEvent(e,t){const r=getWrapper(Object.getPrototypeOf(t));return new r(e,t)}function isStopped(e){return pd(e).immediateStopped}function setEventPhase(e,t){pd(e).eventPhase=t}function setCurrentTarget(e,t){pd(e).currentTarget=t}function setPassiveListener(e,t){pd(e).passiveListener=t}const n=new WeakMap;const s=1;const o=2;const a=3;function isObject(e){return e!==null&&typeof e==="object"}function getListeners(e){const t=n.get(e);if(t==null){throw new TypeError("'this' is expected an EventTarget object, but got another value.")}return t}function defineEventAttributeDescriptor(e){return{get(){const t=getListeners(this);let r=t.get(e);while(r!=null){if(r.listenerType===a){return r.listener}r=r.next}return null},set(t){if(typeof t!=="function"&&!isObject(t)){t=null}const r=getListeners(this);let i=null;let n=r.get(e);while(n!=null){if(n.listenerType===a){if(i!==null){i.next=n.next}else if(n.next!==null){r.set(e,n.next)}else{r.delete(e)}}else{i=n}n=n.next}if(t!==null){const n={listener:t,listenerType:a,passive:false,once:false,next:null};if(i===null){r.set(e,n)}else{i.next=n}}},configurable:true,enumerable:true}}function defineEventAttribute(e,t){Object.defineProperty(e,`on${t}`,defineEventAttributeDescriptor(t))}function defineCustomEventTarget(e){function CustomEventTarget(){EventTarget.call(this)}CustomEventTarget.prototype=Object.create(EventTarget.prototype,{constructor:{value:CustomEventTarget,configurable:true,writable:true}});for(let t=0;t<e.length;++t){defineEventAttribute(CustomEventTarget.prototype,e[t])}return CustomEventTarget}function EventTarget(){if(this instanceof EventTarget){n.set(this,new Map);return}if(arguments.length===1&&Array.isArray(arguments[0])){return defineCustomEventTarget(arguments[0])}if(arguments.length>0){const e=new Array(arguments.length);for(let t=0;t<arguments.length;++t){e[t]=arguments[t]}return defineCustomEventTarget(e)}throw new TypeError("Cannot call a class as a function")}EventTarget.prototype={addEventListener(e,t,r){if(t==null){return}if(typeof t!=="function"&&!isObject(t)){throw new TypeError("'listener' should be a function or an object.")}const i=getListeners(this);const n=isObject(r);const a=n?Boolean(r.capture):Boolean(r);const l=a?s:o;const u={listener:t,listenerType:l,passive:n&&Boolean(r.passive),once:n&&Boolean(r.once),next:null};let c=i.get(e);if(c===undefined){i.set(e,u);return}let h=null;while(c!=null){if(c.listener===t&&c.listenerType===l){return}h=c;c=c.next}h.next=u},removeEventListener(e,t,r){if(t==null){return}const i=getListeners(this);const n=isObject(r)?Boolean(r.capture):Boolean(r);const a=n?s:o;let l=null;let u=i.get(e);while(u!=null){if(u.listener===t&&u.listenerType===a){if(l!==null){l.next=u.next}else if(u.next!==null){i.set(e,u.next)}else{i.delete(e)}return}l=u;u=u.next}},dispatchEvent(e){if(e==null||typeof e.type!=="string"){throw new TypeError('"event.type" should be a string.')}const t=getListeners(this);const r=e.type;let i=t.get(r);if(i==null){return true}const n=wrapEvent(this,e);let s=null;while(i!=null){if(i.once){if(s!==null){s.next=i.next}else if(i.next!==null){t.set(r,i.next)}else{t.delete(r)}}else{s=i}setPassiveListener(n,i.passive?i.listener:null);if(typeof i.listener==="function"){try{i.listener.call(this,n)}catch(e){if(typeof console!=="undefined"&&typeof console.error==="function"){console.error(e)}}}else if(i.listenerType!==a&&typeof i.listener.handleEvent==="function"){i.listener.handleEvent(n)}if(isStopped(n)){break}i=i.next}setPassiveListener(n,null);setEventPhase(n,0);setCurrentTarget(n,null);return!n.defaultPrevented}};Object.defineProperty(EventTarget.prototype,"constructor",{value:EventTarget,configurable:true,writable:true});if(typeof window!=="undefined"&&typeof window.EventTarget!=="undefined"){Object.setPrototypeOf(EventTarget.prototype,window.EventTarget.prototype)}t.defineEventAttribute=defineEventAttribute;t.EventTarget=EventTarget;t["default"]=EventTarget;e.exports=EventTarget;e.exports.EventTarget=e.exports["default"]=EventTarget;e.exports.defineEventAttribute=defineEventAttribute},757:(e,t,r)=>{try{var i=r(3837);if(typeof i.inherits!=="function")throw"";e.exports=i.inherits}catch(t){e.exports=r(6320)}},6320:e=>{if(typeof Object.create==="function"){e.exports=function inherits(e,t){if(t){e.super_=t;e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}})}}}else{e.exports=function inherits(e,t){if(t){e.super_=t;var TempCtor=function(){};TempCtor.prototype=t.prototype;e.prototype=new TempCtor;e.prototype.constructor=e}}}},3914:(e,t)=>{"use strict";Object.defineProperty(t,"t",{value:true});t.ContainerIterator=t.Container=t.Base=void 0;class ContainerIterator{constructor(e=0){this.iteratorType=e}equals(e){return this.o===e.o}}t.ContainerIterator=ContainerIterator;class Base{constructor(){this.i=0}get length(){return this.i}size(){return this.i}empty(){return this.i===0}}t.Base=Base;class Container extends Base{}t.Container=Container},7587:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t.HashContainerIterator=t.HashContainer=void 0;var i=r(3914);var n=_interopRequireDefault(r(2651));var s=r(1881);function _interopRequireDefault(e){return e&&e.t?e:{default:e}}class HashContainerIterator extends i.ContainerIterator{constructor(e,t,r){super(r);this.o=e;this.h=t;if(this.iteratorType===0){this.pre=function(){if(this.o.L===this.h){(0,s.throwIteratorAccessError)()}this.o=this.o.L;return this};this.next=function(){if(this.o===this.h){(0,s.throwIteratorAccessError)()}this.o=this.o.B;return this}}else{this.pre=function(){if(this.o.B===this.h){(0,s.throwIteratorAccessError)()}this.o=this.o.B;return this};this.next=function(){if(this.o===this.h){(0,s.throwIteratorAccessError)()}this.o=this.o.L;return this}}}}t.HashContainerIterator=HashContainerIterator;class HashContainer extends i.Container{constructor(){super();this.H=[];this.g={};this.HASH_TAG=Symbol("@@HASH_TAG");Object.setPrototypeOf(this.g,null);this.h={};this.h.L=this.h.B=this.p=this._=this.h}V(e){const{L:t,B:r}=e;t.B=r;r.L=t;if(e===this.p){this.p=r}if(e===this._){this._=t}this.i-=1}M(e,t,r){if(r===undefined)r=(0,n.default)(e);let i;if(r){const r=e[this.HASH_TAG];if(r!==undefined){this.H[r].l=t;return this.i}Object.defineProperty(e,this.HASH_TAG,{value:this.H.length,configurable:true});i={u:e,l:t,L:this._,B:this.h};this.H.push(i)}else{const r=this.g[e];if(r){r.l=t;return this.i}i={u:e,l:t,L:this._,B:this.h};this.g[e]=i}if(this.i===0){this.p=i;this.h.B=i}else{this._.B=i}this._=i;this.h.L=i;return++this.i}I(e,t){if(t===undefined)t=(0,n.default)(e);if(t){const t=e[this.HASH_TAG];if(t===undefined)return this.h;return this.H[t]}else{return this.g[e]||this.h}}clear(){const e=this.HASH_TAG;this.H.forEach((function(t){delete t.u[e]}));this.H=[];this.g={};Object.setPrototypeOf(this.g,null);this.i=0;this.p=this._=this.h.L=this.h.B=this.h}eraseElementByKey(e,t){let r;if(t===undefined)t=(0,n.default)(e);if(t){const t=e[this.HASH_TAG];if(t===undefined)return false;delete e[this.HASH_TAG];r=this.H[t];delete this.H[t]}else{r=this.g[e];if(r===undefined)return false;delete this.g[e]}this.V(r);return true}eraseElementByIterator(e){const t=e.o;if(t===this.h){(0,s.throwIteratorAccessError)()}this.V(t);return e.next()}eraseElementByPos(e){if(e<0||e>this.i-1){throw new RangeError}let t=this.p;while(e--){t=t.B}this.V(t);return this.i}}t.HashContainer=HashContainer},5732:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=r(7587);var n=_interopRequireDefault(r(2651));var s=r(1881);function _interopRequireDefault(e){return e&&e.t?e:{default:e}}class HashMapIterator extends i.HashContainerIterator{constructor(e,t,r,i){super(e,t,i);this.container=r}get pointer(){if(this.o===this.h){(0,s.throwIteratorAccessError)()}const e=this;return new Proxy([],{get(t,r){if(r==="0")return e.o.u;else if(r==="1")return e.o.l},set(t,r,i){if(r!=="1"){throw new TypeError("props must be 1")}e.o.l=i;return true}})}copy(){return new HashMapIterator(this.o,this.h,this.container,this.iteratorType)}}class HashMap extends i.HashContainer{constructor(e=[]){super();const t=this;e.forEach((function(e){t.setElement(e[0],e[1])}))}begin(){return new HashMapIterator(this.p,this.h,this)}end(){return new HashMapIterator(this.h,this.h,this)}rBegin(){return new HashMapIterator(this._,this.h,this,1)}rEnd(){return new HashMapIterator(this.h,this.h,this,1)}front(){if(this.i===0)return;return[this.p.u,this.p.l]}back(){if(this.i===0)return;return[this._.u,this._.l]}setElement(e,t,r){return this.M(e,t,r)}getElementByKey(e,t){if(t===undefined)t=(0,n.default)(e);if(t){const t=e[this.HASH_TAG];return t!==undefined?this.H[t].l:undefined}const r=this.g[e];return r?r.l:undefined}getElementByPos(e){if(e<0||e>this.i-1){throw new RangeError}let t=this.p;while(e--){t=t.B}return[t.u,t.l]}find(e,t){const r=this.I(e,t);return new HashMapIterator(r,this.h,this)}forEach(e){let t=0;let r=this.p;while(r!==this.h){e([r.u,r.l],t++,this);r=r.B}}[Symbol.iterator](){return function*(){let e=this.p;while(e!==this.h){yield[e.u,e.l];e=e.B}}.bind(this)()}}var o=HashMap;t["default"]=o},6861:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=r(7587);var n=r(1881);class HashSetIterator extends i.HashContainerIterator{constructor(e,t,r,i){super(e,t,i);this.container=r}get pointer(){if(this.o===this.h){(0,n.throwIteratorAccessError)()}return this.o.u}copy(){return new HashSetIterator(this.o,this.h,this.container,this.iteratorType)}}class HashSet extends i.HashContainer{constructor(e=[]){super();const t=this;e.forEach((function(e){t.insert(e)}))}begin(){return new HashSetIterator(this.p,this.h,this)}end(){return new HashSetIterator(this.h,this.h,this)}rBegin(){return new HashSetIterator(this._,this.h,this,1)}rEnd(){return new HashSetIterator(this.h,this.h,this,1)}front(){return this.p.u}back(){return this._.u}insert(e,t){return this.M(e,undefined,t)}getElementByPos(e){if(e<0||e>this.i-1){throw new RangeError}let t=this.p;while(e--){t=t.B}return t.u}find(e,t){const r=this.I(e,t);return new HashSetIterator(r,this.h,this)}forEach(e){let t=0;let r=this.p;while(r!==this.h){e(r.u,t++,this);r=r.B}}[Symbol.iterator](){return function*(){let e=this.p;while(e!==this.h){yield e.u;e=e.B}}.bind(this)()}}var s=HashSet;t["default"]=s},4240:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=r(3914);class PriorityQueue extends i.Base{constructor(e=[],t=function(e,t){if(e>t)return-1;if(e<t)return 1;return 0},r=true){super();this.v=t;if(Array.isArray(e)){this.C=r?[...e]:e}else{this.C=[];const t=this;e.forEach((function(e){t.C.push(e)}))}this.i=this.C.length;const i=this.i>>1;for(let e=this.i-1>>1;e>=0;--e){this.k(e,i)}}m(e){const t=this.C[e];while(e>0){const r=e-1>>1;const i=this.C[r];if(this.v(i,t)<=0)break;this.C[e]=i;e=r}this.C[e]=t}k(e,t){const r=this.C[e];while(e<t){let t=e<<1|1;const i=t+1;let n=this.C[t];if(i<this.i&&this.v(n,this.C[i])>0){t=i;n=this.C[i]}if(this.v(n,r)>=0)break;this.C[e]=n;e=t}this.C[e]=r}clear(){this.i=0;this.C.length=0}push(e){this.C.push(e);this.m(this.i);this.i+=1}pop(){if(this.i===0)return;const e=this.C[0];const t=this.C.pop();this.i-=1;if(this.i){this.C[0]=t;this.k(0,this.i>>1)}return e}top(){return this.C[0]}find(e){return this.C.indexOf(e)>=0}remove(e){const t=this.C.indexOf(e);if(t<0)return false;if(t===0){this.pop()}else if(t===this.i-1){this.C.pop();this.i-=1}else{this.C.splice(t,1,this.C.pop());this.i-=1;this.m(t);this.k(t,this.i>>1)}return true}updateItem(e){const t=this.C.indexOf(e);if(t<0)return false;this.m(t);this.k(t,this.i>>1);return true}toArray(){return[...this.C]}}var n=PriorityQueue;t["default"]=n},5621:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=r(3914);class Queue extends i.Base{constructor(e=[]){super();this.j=0;this.q=[];const t=this;e.forEach((function(e){t.push(e)}))}clear(){this.q=[];this.i=this.j=0}push(e){const t=this.q.length;if(this.j/t>.5&&this.j+this.i>=t&&t>4096){const t=this.i;for(let e=0;e<t;++e){this.q[e]=this.q[this.j+e]}this.j=0;this.q[this.i]=e}else this.q[this.j+this.i]=e;return++this.i}pop(){if(this.i===0)return;const e=this.q[this.j++];this.i-=1;return e}front(){if(this.i===0)return;return this.q[this.j]}}var n=Queue;t["default"]=n},3169:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=r(3914);class Stack extends i.Base{constructor(e=[]){super();this.S=[];const t=this;e.forEach((function(e){t.push(e)}))}clear(){this.i=0;this.S=[]}push(e){this.S.push(e);this.i+=1;return this.i}pop(){if(this.i===0)return;this.i-=1;return this.S.pop()}top(){return this.S[this.i-1]}}var n=Stack;t["default"]=n},1062:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t.RandomIterator=void 0;var i=r(3914);var n=r(1881);class RandomIterator extends i.ContainerIterator{constructor(e,t){super(t);this.o=e;if(this.iteratorType===0){this.pre=function(){if(this.o===0){(0,n.throwIteratorAccessError)()}this.o-=1;return this};this.next=function(){if(this.o===this.container.size()){(0,n.throwIteratorAccessError)()}this.o+=1;return this}}else{this.pre=function(){if(this.o===this.container.size()-1){(0,n.throwIteratorAccessError)()}this.o+=1;return this};this.next=function(){if(this.o===-1){(0,n.throwIteratorAccessError)()}this.o-=1;return this}}}get pointer(){return this.container.getElementByPos(this.o)}set pointer(e){this.container.setElementByPos(this.o,e)}}t.RandomIterator=RandomIterator},9584:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=r(3914);class SequentialContainer extends i.Container{}var n=SequentialContainer;t["default"]=n},9200:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=_interopRequireDefault(r(9584));var n=r(1062);function _interopRequireDefault(e){return e&&e.t?e:{default:e}}class DequeIterator extends n.RandomIterator{constructor(e,t,r){super(e,r);this.container=t}copy(){return new DequeIterator(this.o,this.container,this.iteratorType)}}class Deque extends i.default{constructor(e=[],t=1<<12){super();this.j=0;this.D=0;this.R=0;this.N=0;this.P=0;this.A=[];const r=(()=>{if(typeof e.length==="number")return e.length;if(typeof e.size==="number")return e.size;if(typeof e.size==="function")return e.size();throw new TypeError("Cannot get the length or size of the container")})();this.F=t;this.P=Math.max(Math.ceil(r/this.F),1);for(let e=0;e<this.P;++e){this.A.push(new Array(this.F))}const i=Math.ceil(r/this.F);this.j=this.R=(this.P>>1)-(i>>1);this.D=this.N=this.F-r%this.F>>1;const n=this;e.forEach((function(e){n.pushBack(e)}))}T(){const e=[];const t=Math.max(this.P>>1,1);for(let r=0;r<t;++r){e[r]=new Array(this.F)}for(let t=this.j;t<this.P;++t){e[e.length]=this.A[t]}for(let t=0;t<this.R;++t){e[e.length]=this.A[t]}e[e.length]=[...this.A[this.R]];this.j=t;this.R=e.length-1;for(let r=0;r<t;++r){e[e.length]=new Array(this.F)}this.A=e;this.P=e.length}O(e){const t=this.D+e+1;const r=t%this.F;let i=r-1;let n=this.j+(t-r)/this.F;if(r===0)n-=1;n%=this.P;if(i<0)i+=this.F;return{curNodeBucketIndex:n,curNodePointerIndex:i}}clear(){this.A=[new Array(this.F)];this.P=1;this.j=this.R=this.i=0;this.D=this.N=this.F>>1}begin(){return new DequeIterator(0,this)}end(){return new DequeIterator(this.i,this)}rBegin(){return new DequeIterator(this.i-1,this,1)}rEnd(){return new DequeIterator(-1,this,1)}front(){if(this.i===0)return;return this.A[this.j][this.D]}back(){if(this.i===0)return;return this.A[this.R][this.N]}pushBack(e){if(this.i){if(this.N<this.F-1){this.N+=1}else if(this.R<this.P-1){this.R+=1;this.N=0}else{this.R=0;this.N=0}if(this.R===this.j&&this.N===this.D)this.T()}this.i+=1;this.A[this.R][this.N]=e;return this.i}popBack(){if(this.i===0)return;const e=this.A[this.R][this.N];if(this.i!==1){if(this.N>0){this.N-=1}else if(this.R>0){this.R-=1;this.N=this.F-1}else{this.R=this.P-1;this.N=this.F-1}}this.i-=1;return e}pushFront(e){if(this.i){if(this.D>0){this.D-=1}else if(this.j>0){this.j-=1;this.D=this.F-1}else{this.j=this.P-1;this.D=this.F-1}if(this.j===this.R&&this.D===this.N)this.T()}this.i+=1;this.A[this.j][this.D]=e;return this.i}popFront(){if(this.i===0)return;const e=this.A[this.j][this.D];if(this.i!==1){if(this.D<this.F-1){this.D+=1}else if(this.j<this.P-1){this.j+=1;this.D=0}else{this.j=0;this.D=0}}this.i-=1;return e}getElementByPos(e){if(e<0||e>this.i-1){throw new RangeError}const{curNodeBucketIndex:t,curNodePointerIndex:r}=this.O(e);return this.A[t][r]}setElementByPos(e,t){if(e<0||e>this.i-1){throw new RangeError}const{curNodeBucketIndex:r,curNodePointerIndex:i}=this.O(e);this.A[r][i]=t}insert(e,t,r=1){if(e<0||e>this.i){throw new RangeError}if(e===0){while(r--)this.pushFront(t)}else if(e===this.i){while(r--)this.pushBack(t)}else{const i=[];for(let t=e;t<this.i;++t){i.push(this.getElementByPos(t))}this.cut(e-1);for(let e=0;e<r;++e)this.pushBack(t);for(let e=0;e<i.length;++e)this.pushBack(i[e])}return this.i}cut(e){if(e<0){this.clear();return 0}const{curNodeBucketIndex:t,curNodePointerIndex:r}=this.O(e);this.R=t;this.N=r;this.i=e+1;return this.i}eraseElementByPos(e){if(e<0||e>this.i-1){throw new RangeError}if(e===0)this.popFront();else if(e===this.i-1)this.popBack();else{const t=[];for(let r=e+1;r<this.i;++r){t.push(this.getElementByPos(r))}this.cut(e);this.popBack();const r=this;t.forEach((function(e){r.pushBack(e)}))}return this.i}eraseElementByValue(e){if(this.i===0)return 0;const t=[];for(let r=0;r<this.i;++r){const i=this.getElementByPos(r);if(i!==e)t.push(i)}const r=t.length;for(let e=0;e<r;++e)this.setElementByPos(e,t[e]);return this.cut(r-1)}eraseElementByIterator(e){const t=e.o;this.eraseElementByPos(t);e=e.next();return e}find(e){for(let t=0;t<this.i;++t){if(this.getElementByPos(t)===e){return new DequeIterator(t,this)}}return this.end()}reverse(){let e=0;let t=this.i-1;while(e<t){const r=this.getElementByPos(e);this.setElementByPos(e,this.getElementByPos(t));this.setElementByPos(t,r);e+=1;t-=1}}unique(){if(this.i<=1){return this.i}let e=1;let t=this.getElementByPos(0);for(let r=1;r<this.i;++r){const i=this.getElementByPos(r);if(i!==t){t=i;this.setElementByPos(e++,i)}}while(this.i>e)this.popBack();return this.i}sort(e){const t=[];for(let e=0;e<this.i;++e){t.push(this.getElementByPos(e))}t.sort(e);for(let e=0;e<this.i;++e)this.setElementByPos(e,t[e])}shrinkToFit(){if(this.i===0)return;const e=[];this.forEach((function(t){e.push(t)}));this.P=Math.max(Math.ceil(this.i/this.F),1);this.i=this.j=this.R=this.D=this.N=0;this.A=[];for(let e=0;e<this.P;++e){this.A.push(new Array(this.F))}for(let t=0;t<e.length;++t)this.pushBack(e[t])}forEach(e){for(let t=0;t<this.i;++t){e(this.getElementByPos(t),t,this)}}[Symbol.iterator](){return function*(){for(let e=0;e<this.i;++e){yield this.getElementByPos(e)}}.bind(this)()}}var s=Deque;t["default"]=s},4863:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=_interopRequireDefault(r(9584));var n=r(3914);var s=r(1881);function _interopRequireDefault(e){return e&&e.t?e:{default:e}}class LinkListIterator extends n.ContainerIterator{constructor(e,t,r,i){super(i);this.o=e;this.h=t;this.container=r;if(this.iteratorType===0){this.pre=function(){if(this.o.L===this.h){(0,s.throwIteratorAccessError)()}this.o=this.o.L;return this};this.next=function(){if(this.o===this.h){(0,s.throwIteratorAccessError)()}this.o=this.o.B;return this}}else{this.pre=function(){if(this.o.B===this.h){(0,s.throwIteratorAccessError)()}this.o=this.o.B;return this};this.next=function(){if(this.o===this.h){(0,s.throwIteratorAccessError)()}this.o=this.o.L;return this}}}get pointer(){if(this.o===this.h){(0,s.throwIteratorAccessError)()}return this.o.l}set pointer(e){if(this.o===this.h){(0,s.throwIteratorAccessError)()}this.o.l=e}copy(){return new LinkListIterator(this.o,this.h,this.container,this.iteratorType)}}class LinkList extends i.default{constructor(e=[]){super();this.h={};this.p=this._=this.h.L=this.h.B=this.h;const t=this;e.forEach((function(e){t.pushBack(e)}))}V(e){const{L:t,B:r}=e;t.B=r;r.L=t;if(e===this.p){this.p=r}if(e===this._){this._=t}this.i-=1}G(e,t){const r=t.B;const i={l:e,L:t,B:r};t.B=i;r.L=i;if(t===this.h){this.p=i}if(r===this.h){this._=i}this.i+=1}clear(){this.i=0;this.p=this._=this.h.L=this.h.B=this.h}begin(){return new LinkListIterator(this.p,this.h,this)}end(){return new LinkListIterator(this.h,this.h,this)}rBegin(){return new LinkListIterator(this._,this.h,this,1)}rEnd(){return new LinkListIterator(this.h,this.h,this,1)}front(){return this.p.l}back(){return this._.l}getElementByPos(e){if(e<0||e>this.i-1){throw new RangeError}let t=this.p;while(e--){t=t.B}return t.l}eraseElementByPos(e){if(e<0||e>this.i-1){throw new RangeError}let t=this.p;while(e--){t=t.B}this.V(t);return this.i}eraseElementByValue(e){let t=this.p;while(t!==this.h){if(t.l===e){this.V(t)}t=t.B}return this.i}eraseElementByIterator(e){const t=e.o;if(t===this.h){(0,s.throwIteratorAccessError)()}e=e.next();this.V(t);return e}pushBack(e){this.G(e,this._);return this.i}popBack(){if(this.i===0)return;const e=this._.l;this.V(this._);return e}pushFront(e){this.G(e,this.h);return this.i}popFront(){if(this.i===0)return;const e=this.p.l;this.V(this.p);return e}setElementByPos(e,t){if(e<0||e>this.i-1){throw new RangeError}let r=this.p;while(e--){r=r.B}r.l=t}insert(e,t,r=1){if(e<0||e>this.i){throw new RangeError}if(r<=0)return this.i;if(e===0){while(r--)this.pushFront(t)}else if(e===this.i){while(r--)this.pushBack(t)}else{let i=this.p;for(let t=1;t<e;++t){i=i.B}const n=i.B;this.i+=r;while(r--){i.B={l:t,L:i};i.B.L=i;i=i.B}i.B=n;n.L=i}return this.i}find(e){let t=this.p;while(t!==this.h){if(t.l===e){return new LinkListIterator(t,this.h,this)}t=t.B}return this.end()}reverse(){if(this.i<=1)return;let e=this.p;let t=this._;let r=0;while(r<<1<this.i){const i=e.l;e.l=t.l;t.l=i;e=e.B;t=t.L;r+=1}}unique(){if(this.i<=1){return this.i}let e=this.p;while(e!==this.h){let t=e;while(t.B!==this.h&&t.l===t.B.l){t=t.B;this.i-=1}e.B=t.B;e.B.L=e;e=e.B}return this.i}sort(e){if(this.i<=1)return;const t=[];this.forEach((function(e){t.push(e)}));t.sort(e);let r=this.p;t.forEach((function(e){r.l=e;r=r.B}))}merge(e){const t=this;if(this.i===0){e.forEach((function(e){t.pushBack(e)}))}else{let r=this.p;e.forEach((function(e){while(r!==t.h&&r.l<=e){r=r.B}t.G(e,r.L)}))}return this.i}forEach(e){let t=this.p;let r=0;while(t!==this.h){e(t.l,r++,this);t=t.B}}[Symbol.iterator](){return function*(){if(this.i===0)return;let e=this.p;while(e!==this.h){yield e.l;e=e.B}}.bind(this)()}}var o=LinkList;t["default"]=o},8563:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=_interopRequireDefault(r(9584));var n=r(1062);function _interopRequireDefault(e){return e&&e.t?e:{default:e}}class VectorIterator extends n.RandomIterator{constructor(e,t,r){super(e,r);this.container=t}copy(){return new VectorIterator(this.o,this.container,this.iteratorType)}}class Vector extends i.default{constructor(e=[],t=true){super();if(Array.isArray(e)){this.J=t?[...e]:e;this.i=e.length}else{this.J=[];const t=this;e.forEach((function(e){t.pushBack(e)}))}}clear(){this.i=0;this.J.length=0}begin(){return new VectorIterator(0,this)}end(){return new VectorIterator(this.i,this)}rBegin(){return new VectorIterator(this.i-1,this,1)}rEnd(){return new VectorIterator(-1,this,1)}front(){return this.J[0]}back(){return this.J[this.i-1]}getElementByPos(e){if(e<0||e>this.i-1){throw new RangeError}return this.J[e]}eraseElementByPos(e){if(e<0||e>this.i-1){throw new RangeError}this.J.splice(e,1);this.i-=1;return this.i}eraseElementByValue(e){let t=0;for(let r=0;r<this.i;++r){if(this.J[r]!==e){this.J[t++]=this.J[r]}}this.i=this.J.length=t;return this.i}eraseElementByIterator(e){const t=e.o;e=e.next();this.eraseElementByPos(t);return e}pushBack(e){this.J.push(e);this.i+=1;return this.i}popBack(){if(this.i===0)return;this.i-=1;return this.J.pop()}setElementByPos(e,t){if(e<0||e>this.i-1){throw new RangeError}this.J[e]=t}insert(e,t,r=1){if(e<0||e>this.i){throw new RangeError}this.J.splice(e,0,...new Array(r).fill(t));this.i+=r;return this.i}find(e){for(let t=0;t<this.i;++t){if(this.J[t]===e){return new VectorIterator(t,this)}}return this.end()}reverse(){this.J.reverse()}unique(){let e=1;for(let t=1;t<this.i;++t){if(this.J[t]!==this.J[t-1]){this.J[e++]=this.J[t]}}this.i=this.J.length=e;return this.i}sort(e){this.J.sort(e)}forEach(e){for(let t=0;t<this.i;++t){e(this.J[t],t,this)}}[Symbol.iterator](){return function*(){yield*this.J}.bind(this)()}}var s=Vector;t["default"]=s},9173:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=r(3914);var n=r(1881);class TreeIterator extends i.ContainerIterator{constructor(e,t,r){super(r);this.o=e;this.h=t;if(this.iteratorType===0){this.pre=function(){if(this.o===this.h.U){(0,n.throwIteratorAccessError)()}this.o=this.o.L();return this};this.next=function(){if(this.o===this.h){(0,n.throwIteratorAccessError)()}this.o=this.o.B();return this}}else{this.pre=function(){if(this.o===this.h.W){(0,n.throwIteratorAccessError)()}this.o=this.o.B();return this};this.next=function(){if(this.o===this.h){(0,n.throwIteratorAccessError)()}this.o=this.o.L();return this}}}get index(){let e=this.o;const t=this.h.tt;if(e===this.h){if(t){return t.rt-1}return 0}let r=0;if(e.U){r+=e.U.rt}while(e!==t){const t=e.tt;if(e===t.W){r+=1;if(t.U){r+=t.U.rt}}e=t}return r}}var s=TreeIterator;t["default"]=s},8933:(e,t)=>{"use strict";Object.defineProperty(t,"t",{value:true});t.TreeNodeEnableIndex=t.TreeNode=void 0;class TreeNode{constructor(e,t){this.ee=1;this.u=undefined;this.l=undefined;this.U=undefined;this.W=undefined;this.tt=undefined;this.u=e;this.l=t}L(){let e=this;if(e.ee===1&&e.tt.tt===e){e=e.W}else if(e.U){e=e.U;while(e.W){e=e.W}}else{let t=e.tt;while(t.U===e){e=t;t=e.tt}e=t}return e}B(){let e=this;if(e.W){e=e.W;while(e.U){e=e.U}return e}else{let t=e.tt;while(t.W===e){e=t;t=e.tt}if(e.W!==t){return t}else return e}}te(){const e=this.tt;const t=this.W;const r=t.U;if(e.tt===this)e.tt=t;else if(e.U===this)e.U=t;else e.W=t;t.tt=e;t.U=this;this.tt=t;this.W=r;if(r)r.tt=this;return t}se(){const e=this.tt;const t=this.U;const r=t.W;if(e.tt===this)e.tt=t;else if(e.U===this)e.U=t;else e.W=t;t.tt=e;t.W=this;this.tt=t;this.U=r;if(r)r.tt=this;return t}}t.TreeNode=TreeNode;class TreeNodeEnableIndex extends TreeNode{constructor(){super(...arguments);this.rt=1}te(){const e=super.te();this.ie();e.ie();return e}se(){const e=super.se();this.ie();e.ie();return e}ie(){this.rt=1;if(this.U){this.rt+=this.U.rt}if(this.W){this.rt+=this.W.rt}}}t.TreeNodeEnableIndex=TreeNodeEnableIndex},2031:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=r(8933);var n=r(3914);var s=r(1881);class TreeContainer extends n.Container{constructor(e=function(e,t){if(e<t)return-1;if(e>t)return 1;return 0},t=false){super();this.Y=undefined;this.v=e;if(t){this.re=i.TreeNodeEnableIndex;this.M=function(e,t,r){const i=this.ne(e,t,r);if(i){let e=i.tt;while(e!==this.h){e.rt+=1;e=e.tt}const t=this.he(i);if(t){const{parentNode:e,grandParent:r,curNode:i}=t;e.ie();r.ie();i.ie()}}return this.i};this.V=function(e){let t=this.fe(e);while(t!==this.h){t.rt-=1;t=t.tt}}}else{this.re=i.TreeNode;this.M=function(e,t,r){const i=this.ne(e,t,r);if(i)this.he(i);return this.i};this.V=this.fe}this.h=new this.re}X(e,t){let r=this.h;while(e){const i=this.v(e.u,t);if(i<0){e=e.W}else if(i>0){r=e;e=e.U}else return e}return r}Z(e,t){let r=this.h;while(e){const i=this.v(e.u,t);if(i<=0){e=e.W}else{r=e;e=e.U}}return r}$(e,t){let r=this.h;while(e){const i=this.v(e.u,t);if(i<0){r=e;e=e.W}else if(i>0){e=e.U}else return e}return r}rr(e,t){let r=this.h;while(e){const i=this.v(e.u,t);if(i<0){r=e;e=e.W}else{e=e.U}}return r}ue(e){while(true){const t=e.tt;if(t===this.h)return;if(e.ee===1){e.ee=0;return}if(e===t.U){const r=t.W;if(r.ee===1){r.ee=0;t.ee=1;if(t===this.Y){this.Y=t.te()}else t.te()}else{if(r.W&&r.W.ee===1){r.ee=t.ee;t.ee=0;r.W.ee=0;if(t===this.Y){this.Y=t.te()}else t.te();return}else if(r.U&&r.U.ee===1){r.ee=1;r.U.ee=0;r.se()}else{r.ee=1;e=t}}}else{const r=t.U;if(r.ee===1){r.ee=0;t.ee=1;if(t===this.Y){this.Y=t.se()}else t.se()}else{if(r.U&&r.U.ee===1){r.ee=t.ee;t.ee=0;r.U.ee=0;if(t===this.Y){this.Y=t.se()}else t.se();return}else if(r.W&&r.W.ee===1){r.ee=1;r.W.ee=0;r.te()}else{r.ee=1;e=t}}}}}fe(e){if(this.i===1){this.clear();return this.h}let t=e;while(t.U||t.W){if(t.W){t=t.W;while(t.U)t=t.U}else{t=t.U}[e.u,t.u]=[t.u,e.u];[e.l,t.l]=[t.l,e.l];e=t}if(this.h.U===t){this.h.U=t.tt}else if(this.h.W===t){this.h.W=t.tt}this.ue(t);const r=t.tt;if(t===r.U){r.U=undefined}else r.W=undefined;this.i-=1;this.Y.ee=0;return r}oe(e,t){if(e===undefined)return false;const r=this.oe(e.U,t);if(r)return true;if(t(e))return true;return this.oe(e.W,t)}he(e){while(true){const t=e.tt;if(t.ee===0)return;const r=t.tt;if(t===r.U){const i=r.W;if(i&&i.ee===1){i.ee=t.ee=0;if(r===this.Y)return;r.ee=1;e=r;continue}else if(e===t.W){e.ee=0;if(e.U)e.U.tt=t;if(e.W)e.W.tt=r;t.W=e.U;r.U=e.W;e.U=t;e.W=r;if(r===this.Y){this.Y=e;this.h.tt=e}else{const t=r.tt;if(t.U===r){t.U=e}else t.W=e}e.tt=r.tt;t.tt=e;r.tt=e;r.ee=1;return{parentNode:t,grandParent:r,curNode:e}}else{t.ee=0;if(r===this.Y){this.Y=r.se()}else r.se();r.ee=1}}else{const i=r.U;if(i&&i.ee===1){i.ee=t.ee=0;if(r===this.Y)return;r.ee=1;e=r;continue}else if(e===t.U){e.ee=0;if(e.U)e.U.tt=r;if(e.W)e.W.tt=t;r.W=e.U;t.U=e.W;e.U=r;e.W=t;if(r===this.Y){this.Y=e;this.h.tt=e}else{const t=r.tt;if(t.U===r){t.U=e}else t.W=e}e.tt=r.tt;t.tt=e;r.tt=e;r.ee=1;return{parentNode:t,grandParent:r,curNode:e}}else{t.ee=0;if(r===this.Y){this.Y=r.te()}else r.te();r.ee=1}}return}}ne(e,t,r){if(this.Y===undefined){this.i+=1;this.Y=new this.re(e,t);this.Y.ee=0;this.Y.tt=this.h;this.h.tt=this.Y;this.h.U=this.Y;this.h.W=this.Y;return}let i;const n=this.h.U;const s=this.v(n.u,e);if(s===0){n.l=t;return}else if(s>0){n.U=new this.re(e,t);n.U.tt=n;i=n.U;this.h.U=i}else{const n=this.h.W;const s=this.v(n.u,e);if(s===0){n.l=t;return}else if(s<0){n.W=new this.re(e,t);n.W.tt=n;i=n.W;this.h.W=i}else{if(r!==undefined){const n=r.o;if(n!==this.h){const r=this.v(n.u,e);if(r===0){n.l=t;return}else if(r>0){const r=n.L();const s=this.v(r.u,e);if(s===0){r.l=t;return}else if(s<0){i=new this.re(e,t);if(r.W===undefined){r.W=i;i.tt=r}else{n.U=i;i.tt=n}}}}}if(i===undefined){i=this.Y;while(true){const r=this.v(i.u,e);if(r>0){if(i.U===undefined){i.U=new this.re(e,t);i.U.tt=i;i=i.U;break}i=i.U}else if(r<0){if(i.W===undefined){i.W=new this.re(e,t);i.W.tt=i;i=i.W;break}i=i.W}else{i.l=t;return}}}}}this.i+=1;return i}I(e,t){while(e){const r=this.v(e.u,t);if(r<0){e=e.W}else if(r>0){e=e.U}else return e}return e||this.h}clear(){this.i=0;this.Y=undefined;this.h.tt=undefined;this.h.U=this.h.W=undefined}updateKeyByIterator(e,t){const r=e.o;if(r===this.h){(0,s.throwIteratorAccessError)()}if(this.i===1){r.u=t;return true}if(r===this.h.U){if(this.v(r.B().u,t)>0){r.u=t;return true}return false}if(r===this.h.W){if(this.v(r.L().u,t)<0){r.u=t;return true}return false}const i=r.L().u;if(this.v(i,t)>=0)return false;const n=r.B().u;if(this.v(n,t)<=0)return false;r.u=t;return true}eraseElementByPos(e){if(e<0||e>this.i-1){throw new RangeError}let t=0;const r=this;this.oe(this.Y,(function(i){if(e===t){r.V(i);return true}t+=1;return false}));return this.i}eraseElementByKey(e){if(this.i===0)return false;const t=this.I(this.Y,e);if(t===this.h)return false;this.V(t);return true}eraseElementByIterator(e){const t=e.o;if(t===this.h){(0,s.throwIteratorAccessError)()}const r=t.W===undefined;const i=e.iteratorType===0;if(i){if(r)e.next()}else{if(!r||t.U===undefined)e.next()}this.V(t);return e}forEach(e){let t=0;for(const r of this)e(r,t++,this)}getElementByPos(e){if(e<0||e>this.i-1){throw new RangeError}let t;let r=0;for(const i of this){if(r===e){t=i;break}r+=1}return t}getHeight(){if(this.i===0)return 0;const traversal=function(e){if(!e)return 0;return Math.max(traversal(e.U),traversal(e.W))+1};return traversal(this.Y)}}var o=TreeContainer;t["default"]=o},3708:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=_interopRequireDefault(r(2031));var n=_interopRequireDefault(r(9173));var s=r(1881);function _interopRequireDefault(e){return e&&e.t?e:{default:e}}class OrderedMapIterator extends n.default{constructor(e,t,r,i){super(e,t,i);this.container=r}get pointer(){if(this.o===this.h){(0,s.throwIteratorAccessError)()}const e=this;return new Proxy([],{get(t,r){if(r==="0")return e.o.u;else if(r==="1")return e.o.l},set(t,r,i){if(r!=="1"){throw new TypeError("props must be 1")}e.o.l=i;return true}})}copy(){return new OrderedMapIterator(this.o,this.h,this.container,this.iteratorType)}}class OrderedMap extends i.default{constructor(e=[],t,r){super(t,r);const i=this;e.forEach((function(e){i.setElement(e[0],e[1])}))}*K(e){if(e===undefined)return;yield*this.K(e.U);yield[e.u,e.l];yield*this.K(e.W)}begin(){return new OrderedMapIterator(this.h.U||this.h,this.h,this)}end(){return new OrderedMapIterator(this.h,this.h,this)}rBegin(){return new OrderedMapIterator(this.h.W||this.h,this.h,this,1)}rEnd(){return new OrderedMapIterator(this.h,this.h,this,1)}front(){if(this.i===0)return;const e=this.h.U;return[e.u,e.l]}back(){if(this.i===0)return;const e=this.h.W;return[e.u,e.l]}lowerBound(e){const t=this.X(this.Y,e);return new OrderedMapIterator(t,this.h,this)}upperBound(e){const t=this.Z(this.Y,e);return new OrderedMapIterator(t,this.h,this)}reverseLowerBound(e){const t=this.$(this.Y,e);return new OrderedMapIterator(t,this.h,this)}reverseUpperBound(e){const t=this.rr(this.Y,e);return new OrderedMapIterator(t,this.h,this)}setElement(e,t,r){return this.M(e,t,r)}find(e){const t=this.I(this.Y,e);return new OrderedMapIterator(t,this.h,this)}getElementByKey(e){const t=this.I(this.Y,e);return t.l}union(e){const t=this;e.forEach((function(e){t.setElement(e[0],e[1])}));return this.i}[Symbol.iterator](){return this.K(this.Y)}}var o=OrderedMap;t["default"]=o},131:(e,t,r)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=void 0;var i=_interopRequireDefault(r(2031));var n=_interopRequireDefault(r(9173));var s=r(1881);function _interopRequireDefault(e){return e&&e.t?e:{default:e}}class OrderedSetIterator extends n.default{constructor(e,t,r,i){super(e,t,i);this.container=r}get pointer(){if(this.o===this.h){(0,s.throwIteratorAccessError)()}return this.o.u}copy(){return new OrderedSetIterator(this.o,this.h,this.container,this.iteratorType)}}class OrderedSet extends i.default{constructor(e=[],t,r){super(t,r);const i=this;e.forEach((function(e){i.insert(e)}))}*K(e){if(e===undefined)return;yield*this.K(e.U);yield e.u;yield*this.K(e.W)}begin(){return new OrderedSetIterator(this.h.U||this.h,this.h,this)}end(){return new OrderedSetIterator(this.h,this.h,this)}rBegin(){return new OrderedSetIterator(this.h.W||this.h,this.h,this,1)}rEnd(){return new OrderedSetIterator(this.h,this.h,this,1)}front(){return this.h.U?this.h.U.u:undefined}back(){return this.h.W?this.h.W.u:undefined}insert(e,t){return this.M(e,undefined,t)}find(e){const t=this.I(this.Y,e);return new OrderedSetIterator(t,this.h,this)}lowerBound(e){const t=this.X(this.Y,e);return new OrderedSetIterator(t,this.h,this)}upperBound(e){const t=this.Z(this.Y,e);return new OrderedSetIterator(t,this.h,this)}reverseLowerBound(e){const t=this.$(this.Y,e);return new OrderedSetIterator(t,this.h,this)}reverseUpperBound(e){const t=this.rr(this.Y,e);return new OrderedSetIterator(t,this.h,this)}union(e){const t=this;e.forEach((function(e){t.insert(e)}));return this.i}[Symbol.iterator](){return this.K(this.Y)}}var o=OrderedSet;t["default"]=o},8706:(e,t,r)=>{"use strict";var i;i={value:true};i={enumerable:true,get:function(){return u.default}};i={enumerable:true,get:function(){return p.default}};i={enumerable:true,get:function(){return d.default}};i={enumerable:true,get:function(){return l.default}};i={enumerable:true,get:function(){return h.default}};Object.defineProperty(t,"hU",{enumerable:true,get:function(){return c.default}});i={enumerable:true,get:function(){return o.default}};i={enumerable:true,get:function(){return s.default}};i={enumerable:true,get:function(){return n.default}};i={enumerable:true,get:function(){return a.default}};var n=_interopRequireDefault(r(3169));var s=_interopRequireDefault(r(5621));var o=_interopRequireDefault(r(4240));var a=_interopRequireDefault(r(8563));var l=_interopRequireDefault(r(4863));var u=_interopRequireDefault(r(9200));var c=_interopRequireDefault(r(131));var h=_interopRequireDefault(r(3708));var d=_interopRequireDefault(r(6861));var p=_interopRequireDefault(r(5732));function _interopRequireDefault(e){return e&&e.t?e:{default:e}}},2651:(e,t)=>{"use strict";Object.defineProperty(t,"t",{value:true});t["default"]=checkObject;function checkObject(e){const t=typeof e;return t==="object"&&e!==null||t==="function"}},1881:(e,t)=>{"use strict";Object.defineProperty(t,"t",{value:true});t.throwIteratorAccessError=throwIteratorAccessError;function throwIteratorAccessError(){throw new RangeError("Iterator access denied!")}},1378:(e,t,r)=>{const i=e.exports;const{Buffer:n}=r(4300);i.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"};i.requiredHeaderFlags={1:0,2:0,4:0,5:0,6:2,7:0,8:2,9:0,10:2,11:0,12:0,13:0,14:0,15:0};i.requiredHeaderFlagsErrors={};for(const e in i.requiredHeaderFlags){const t=i.requiredHeaderFlags[e];i.requiredHeaderFlagsErrors[e]="Invalid header flag bits, must be 0x"+t.toString(16)+" for "+i.types[e]+" packet"}i.codes={};for(const e in i.types){const t=i.types[e];i.codes[t]=e}i.CMD_SHIFT=4;i.CMD_MASK=240;i.DUP_MASK=8;i.QOS_MASK=3;i.QOS_SHIFT=1;i.RETAIN_MASK=1;i.VARBYTEINT_MASK=127;i.VARBYTEINT_FIN_MASK=128;i.VARBYTEINT_MAX=268435455;i.SESSIONPRESENT_MASK=1;i.SESSIONPRESENT_HEADER=n.from([i.SESSIONPRESENT_MASK]);i.CONNACK_HEADER=n.from([i.codes.connack<<i.CMD_SHIFT]);i.USERNAME_MASK=128;i.PASSWORD_MASK=64;i.WILL_RETAIN_MASK=32;i.WILL_QOS_MASK=24;i.WILL_QOS_SHIFT=3;i.WILL_FLAG_MASK=4;i.CLEAN_SESSION_MASK=2;i.CONNECT_HEADER=n.from([i.codes.connect<<i.CMD_SHIFT]);i.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11};i.propertiesCodes={};for(const e in i.properties){const t=i.properties[e];i.propertiesCodes[t]=e}i.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"};function genHeader(e){return[0,1,2].map((t=>[0,1].map((r=>[0,1].map((s=>{const o=n.alloc(1);o.writeUInt8(i.codes[e]<<i.CMD_SHIFT|(r?i.DUP_MASK:0)|t<<i.QOS_SHIFT|s,0,true);return o}))))))}i.PUBLISH_HEADER=genHeader("publish");i.SUBSCRIBE_HEADER=genHeader("subscribe");i.SUBSCRIBE_OPTIONS_QOS_MASK=3;i.SUBSCRIBE_OPTIONS_NL_MASK=1;i.SUBSCRIBE_OPTIONS_NL_SHIFT=2;i.SUBSCRIBE_OPTIONS_RAP_MASK=1;i.SUBSCRIBE_OPTIONS_RAP_SHIFT=3;i.SUBSCRIBE_OPTIONS_RH_MASK=3;i.SUBSCRIBE_OPTIONS_RH_SHIFT=4;i.SUBSCRIBE_OPTIONS_RH=[0,16,32];i.SUBSCRIBE_OPTIONS_NL=4;i.SUBSCRIBE_OPTIONS_RAP=8;i.SUBSCRIBE_OPTIONS_QOS=[0,1,2];i.UNSUBSCRIBE_HEADER=genHeader("unsubscribe");i.ACKS={unsuback:genHeader("unsuback"),puback:genHeader("puback"),pubcomp:genHeader("pubcomp"),pubrel:genHeader("pubrel"),pubrec:genHeader("pubrec")};i.SUBACK_HEADER=n.from([i.codes.suback<<i.CMD_SHIFT]);i.VERSION3=n.from([3]);i.VERSION4=n.from([4]);i.VERSION5=n.from([5]);i.VERSION131=n.from([131]);i.VERSION132=n.from([132]);i.QOS=[0,1,2].map((e=>n.from([e])));i.EMPTY={pingreq:n.from([i.codes.pingreq<<4,0]),pingresp:n.from([i.codes.pingresp<<4,0]),disconnect:n.from([i.codes.disconnect<<4,0])};i.MQTT5_PUBACK_PUBREC_CODES={0:"Success",16:"No matching subscribers",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",144:"Topic Name invalid",145:"Packet identifier in use",151:"Quota exceeded",153:"Payload format invalid"};i.MQTT5_PUBREL_PUBCOMP_CODES={0:"Success",146:"Packet Identifier not found"};i.MQTT5_SUBACK_CODES={0:"Granted QoS 0",1:"Granted QoS 1",2:"Granted QoS 2",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use",151:"Quota exceeded",158:"Shared Subscriptions not supported",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};i.MQTT5_UNSUBACK_CODES={0:"Success",17:"No subscription existed",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use"};i.MQTT5_DISCONNECT_CODES={0:"Normal disconnection",4:"Disconnect with Will Message",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",135:"Not authorized",137:"Server busy",139:"Server shutting down",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};i.MQTT5_AUTH_CODES={0:"Success",24:"Continue authentication",25:"Re-authenticate"}},2262:(e,t,r)=>{const i=r(5671);const n=r(2361);const{Buffer:s}=r(4300);function generate(e,t){const r=new Accumulator;i(e,r,t);return r.concat()}class Accumulator extends n{constructor(){super();this._array=new Array(20);this._i=0}write(e){this._array[this._i++]=e;return true}concat(){let e=0;const t=new Array(this._array.length);const r=this._array;let i=0;let n;for(n=0;n<r.length&&r[n]!==undefined;n++){if(typeof r[n]!=="string")t[n]=r[n].length;else t[n]=s.byteLength(r[n]);e+=t[n]}const o=s.allocUnsafe(e);for(n=0;n<r.length&&r[n]!==undefined;n++){if(typeof r[n]!=="string"){r[n].copy(o,i);i+=t[n]}else{o.write(r[n],i);i+=t[n]}}return o}destroy(e){if(e)this.emit("error",e)}}e.exports=generate},2825:(e,t,r)=>{t.parser=r(9988).parser;t.generate=r(2262);t.writeToStream=r(5671)},389:(e,t,r)=>{const{Buffer:i}=r(4300);const n=65536;const s={};const o=i.isBuffer(i.from([1,2]).subarray(0,1));function generateBuffer(e){const t=i.allocUnsafe(2);t.writeUInt8(e>>8,0);t.writeUInt8(e&255,0+1);return t}function generateCache(){for(let e=0;e<n;e++){s[e]=generateBuffer(e)}}function genBufVariableByteInt(e){const t=4;let r=0;let n=0;const s=i.allocUnsafe(t);do{r=e%128|0;e=e/128|0;if(e>0)r=r|128;s.writeUInt8(r,n++)}while(e>0&&n<t);if(e>0){n=0}return o?s.subarray(0,n):s.slice(0,n)}function generate4ByteBuffer(e){const t=i.allocUnsafe(4);t.writeUInt32BE(e,0);return t}e.exports={cache:s,generateCache:generateCache,generateNumber:generateBuffer,genBufVariableByteInt:genBufVariableByteInt,generate4ByteBuffer:generate4ByteBuffer}},351:e=>{class Packet{constructor(){this.cmd=null;this.retain=false;this.qos=0;this.dup=false;this.length=-1;this.topic=null;this.payload=null}}e.exports=Packet},9988:(e,t,r)=>{const i=r(3095);const n=r(2361);const s=r(351);const o=r(1378);const a=r(6248)("mqtt-packet:parser");class Parser extends n{constructor(){super();this.parser=this.constructor.parser}static parser(e){if(!(this instanceof Parser))return(new Parser).parser(e);this.settings=e||{};this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"];this._resetState();return this}_resetState(){a("_resetState: resetting packet, error, _list, and _stateCounter");this.packet=new s;this.error=null;this._list=i();this._stateCounter=0}parse(e){if(this.error)this._resetState();this._list.append(e);a("parse: current state: %s",this._states[this._stateCounter]);while((this.packet.length!==-1||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error){this._stateCounter++;a("parse: state complete. _stateCounter is now: %d",this._stateCounter);a("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length);if(this._stateCounter>=this._states.length)this._stateCounter=0}a("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length);return this._list.length}_parseHeader(){const e=this._list.readUInt8(0);const t=e>>o.CMD_SHIFT;this.packet.cmd=o.types[t];const r=e&15;const i=o.requiredHeaderFlags[t];if(i!=null&&r!==i){return this._emitError(new Error(o.requiredHeaderFlagsErrors[t]))}this.packet.retain=(e&o.RETAIN_MASK)!==0;this.packet.qos=e>>o.QOS_SHIFT&o.QOS_MASK;if(this.packet.qos>2){return this._emitError(new Error("Packet must not have both QoS bits set to 1"))}this.packet.dup=(e&o.DUP_MASK)!==0;a("_parseHeader: packet: %o",this.packet);this._list.consume(1);return true}_parseLength(){const e=this._parseVarByteNum(true);if(e){this.packet.length=e.value;this._list.consume(e.bytes)}a("_parseLength %d",e.value);return!!e}_parsePayload(){a("_parsePayload: payload %O",this._list);let e=false;if(this.packet.length===0||this._list.length>=this.packet.length){this._pos=0;switch(this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}e=true}a("_parsePayload complete result: %s",e);return e}_parseConnect(){a("_parseConnect");let e;let t;let r;let i;const n={};const s=this.packet;const l=this._parseString();if(l===null)return this._emitError(new Error("Cannot parse protocolId"));if(l!=="MQTT"&&l!=="MQIsdp"){return this._emitError(new Error("Invalid protocolId"))}s.protocolId=l;if(this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));s.protocolVersion=this._list.readUInt8(this._pos);if(s.protocolVersion>=128){s.bridgeMode=true;s.protocolVersion=s.protocolVersion-128}if(s.protocolVersion!==3&&s.protocolVersion!==4&&s.protocolVersion!==5){return this._emitError(new Error("Invalid protocol version"))}this._pos++;if(this._pos>=this._list.length){return this._emitError(new Error("Packet too short"))}if(this._list.readUInt8(this._pos)&1){return this._emitError(new Error("Connect flag bit 0 must be 0, but got 1"))}n.username=this._list.readUInt8(this._pos)&o.USERNAME_MASK;n.password=this._list.readUInt8(this._pos)&o.PASSWORD_MASK;n.will=this._list.readUInt8(this._pos)&o.WILL_FLAG_MASK;const u=!!(this._list.readUInt8(this._pos)&o.WILL_RETAIN_MASK);const c=(this._list.readUInt8(this._pos)&o.WILL_QOS_MASK)>>o.WILL_QOS_SHIFT;if(n.will){s.will={};s.will.retain=u;s.will.qos=c}else{if(u){return this._emitError(new Error("Will Retain Flag must be set to zero when Will Flag is set to 0"))}if(c){return this._emitError(new Error("Will QoS must be set to zero when Will Flag is set to 0"))}}s.clean=(this._list.readUInt8(this._pos)&o.CLEAN_SESSION_MASK)!==0;this._pos++;s.keepalive=this._parseNum();if(s.keepalive===-1)return this._emitError(new Error("Packet too short"));if(s.protocolVersion===5){const e=this._parseProperties();if(Object.getOwnPropertyNames(e).length){s.properties=e}}const h=this._parseString();if(h===null)return this._emitError(new Error("Packet too short"));s.clientId=h;a("_parseConnect: packet.clientId: %s",s.clientId);if(n.will){if(s.protocolVersion===5){const e=this._parseProperties();if(Object.getOwnPropertyNames(e).length){s.will.properties=e}}e=this._parseString();if(e===null)return this._emitError(new Error("Cannot parse will topic"));s.will.topic=e;a("_parseConnect: packet.will.topic: %s",s.will.topic);t=this._parseBuffer();if(t===null)return this._emitError(new Error("Cannot parse will payload"));s.will.payload=t;a("_parseConnect: packet.will.paylaod: %s",s.will.payload)}if(n.username){i=this._parseString();if(i===null)return this._emitError(new Error("Cannot parse username"));s.username=i;a("_parseConnect: packet.username: %s",s.username)}if(n.password){r=this._parseBuffer();if(r===null)return this._emitError(new Error("Cannot parse password"));s.password=r}this.settings=s;a("_parseConnect: complete");return s}_parseConnack(){a("_parseConnack");const e=this.packet;if(this._list.length<1)return null;const t=this._list.readUInt8(this._pos++);if(t>1){return this._emitError(new Error("Invalid connack flags, bits 7-1 must be set to 0"))}e.sessionPresent=!!(t&o.SESSIONPRESENT_MASK);if(this.settings.protocolVersion===5){if(this._list.length>=2){e.reasonCode=this._list.readUInt8(this._pos++)}else{e.reasonCode=0}}else{if(this._list.length<2)return null;e.returnCode=this._list.readUInt8(this._pos++)}if(e.returnCode===-1||e.reasonCode===-1)return this._emitError(new Error("Cannot parse return code"));if(this.settings.protocolVersion===5){const t=this._parseProperties();if(Object.getOwnPropertyNames(t).length){e.properties=t}}a("_parseConnack: complete")}_parsePublish(){a("_parsePublish");const e=this.packet;e.topic=this._parseString();if(e.topic===null)return this._emitError(new Error("Cannot parse topic"));if(e.qos>0)if(!this._parseMessageId()){return}if(this.settings.protocolVersion===5){const t=this._parseProperties();if(Object.getOwnPropertyNames(t).length){e.properties=t}}e.payload=this._list.slice(this._pos,e.length);a("_parsePublish: payload from buffer list: %o",e.payload)}_parseSubscribe(){a("_parseSubscribe");const e=this.packet;let t;let r;let i;let n;let s;let l;let u;e.subscriptions=[];if(!this._parseMessageId()){return}if(this.settings.protocolVersion===5){const t=this._parseProperties();if(Object.getOwnPropertyNames(t).length){e.properties=t}}if(e.length<=0){return this._emitError(new Error("Malformed subscribe, no payload specified"))}while(this._pos<e.length){t=this._parseString();if(t===null)return this._emitError(new Error("Cannot parse topic"));if(this._pos>=e.length)return this._emitError(new Error("Malformed Subscribe Payload"));r=this._parseByte();if(this.settings.protocolVersion===5){if(r&192){return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-6 must be 0"))}}else{if(r&252){return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-2 must be 0"))}}i=r&o.SUBSCRIBE_OPTIONS_QOS_MASK;if(i>2){return this._emitError(new Error("Invalid subscribe QoS, must be <= 2"))}l=(r>>o.SUBSCRIBE_OPTIONS_NL_SHIFT&o.SUBSCRIBE_OPTIONS_NL_MASK)!==0;s=(r>>o.SUBSCRIBE_OPTIONS_RAP_SHIFT&o.SUBSCRIBE_OPTIONS_RAP_MASK)!==0;n=r>>o.SUBSCRIBE_OPTIONS_RH_SHIFT&o.SUBSCRIBE_OPTIONS_RH_MASK;if(n>2){return this._emitError(new Error("Invalid retain handling, must be <= 2"))}u={topic:t,qos:i};if(this.settings.protocolVersion===5){u.nl=l;u.rap=s;u.rh=n}else if(this.settings.bridgeMode){u.rh=0;u.rap=true;u.nl=true}a("_parseSubscribe: push subscription `%s` to subscription",u);e.subscriptions.push(u)}}_parseSuback(){a("_parseSuback");const e=this.packet;this.packet.granted=[];if(!this._parseMessageId()){return}if(this.settings.protocolVersion===5){const t=this._parseProperties();if(Object.getOwnPropertyNames(t).length){e.properties=t}}if(e.length<=0){return this._emitError(new Error("Malformed suback, no payload specified"))}while(this._pos<this.packet.length){const e=this._list.readUInt8(this._pos++);if(this.settings.protocolVersion===5){if(!o.MQTT5_SUBACK_CODES[e]){return this._emitError(new Error("Invalid suback code"))}}else{if(e>2&&e!==128){return this._emitError(new Error("Invalid suback QoS, must be 0, 1, 2 or 128"))}}this.packet.granted.push(e)}}_parseUnsubscribe(){a("_parseUnsubscribe");const e=this.packet;e.unsubscriptions=[];if(!this._parseMessageId()){return}if(this.settings.protocolVersion===5){const t=this._parseProperties();if(Object.getOwnPropertyNames(t).length){e.properties=t}}if(e.length<=0){return this._emitError(new Error("Malformed unsubscribe, no payload specified"))}while(this._pos<e.length){const t=this._parseString();if(t===null)return this._emitError(new Error("Cannot parse topic"));a("_parseUnsubscribe: push topic `%s` to unsubscriptions",t);e.unsubscriptions.push(t)}}_parseUnsuback(){a("_parseUnsuback");const e=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if((this.settings.protocolVersion===3||this.settings.protocolVersion===4)&&e.length!==2){return this._emitError(new Error("Malformed unsuback, payload length must be 2"))}if(e.length<=0){return this._emitError(new Error("Malformed unsuback, no payload specified"))}if(this.settings.protocolVersion===5){const t=this._parseProperties();if(Object.getOwnPropertyNames(t).length){e.properties=t}e.granted=[];while(this._pos<this.packet.length){const e=this._list.readUInt8(this._pos++);if(!o.MQTT5_UNSUBACK_CODES[e]){return this._emitError(new Error("Invalid unsuback code"))}this.packet.granted.push(e)}}}_parseConfirmation(){a("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);const e=this.packet;this._parseMessageId();if(this.settings.protocolVersion===5){if(e.length>2){e.reasonCode=this._parseByte();switch(this.packet.cmd){case"puback":case"pubrec":if(!o.MQTT5_PUBACK_PUBREC_CODES[e.reasonCode]){return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"))}break;case"pubrel":case"pubcomp":if(!o.MQTT5_PUBREL_PUBCOMP_CODES[e.reasonCode]){return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"))}break}a("_parseConfirmation: packet.reasonCode `%d`",e.reasonCode)}else{e.reasonCode=0}if(e.length>3){const t=this._parseProperties();if(Object.getOwnPropertyNames(t).length){e.properties=t}}}return true}_parseDisconnect(){const e=this.packet;a("_parseDisconnect");if(this.settings.protocolVersion===5){if(this._list.length>0){e.reasonCode=this._parseByte();if(!o.MQTT5_DISCONNECT_CODES[e.reasonCode]){this._emitError(new Error("Invalid disconnect reason code"))}}else{e.reasonCode=0}const t=this._parseProperties();if(Object.getOwnPropertyNames(t).length){e.properties=t}}a("_parseDisconnect result: true");return true}_parseAuth(){a("_parseAuth");const e=this.packet;if(this.settings.protocolVersion!==5){return this._emitError(new Error("Not supported auth packet for this version MQTT"))}e.reasonCode=this._parseByte();if(!o.MQTT5_AUTH_CODES[e.reasonCode]){return this._emitError(new Error("Invalid auth reason code"))}const t=this._parseProperties();if(Object.getOwnPropertyNames(t).length){e.properties=t}a("_parseAuth: result: true");return true}_parseMessageId(){const e=this.packet;e.messageId=this._parseNum();if(e.messageId===null){this._emitError(new Error("Cannot parse messageId"));return false}a("_parseMessageId: packet.messageId %d",e.messageId);return true}_parseString(e){const t=this._parseNum();const r=t+this._pos;if(t===-1||r>this._list.length||r>this.packet.length)return null;const i=this._list.toString("utf8",this._pos,r);this._pos+=t;a("_parseString: result: %s",i);return i}_parseStringPair(){a("_parseStringPair");return{name:this._parseString(),value:this._parseString()}}_parseBuffer(){const e=this._parseNum();const t=e+this._pos;if(e===-1||t>this._list.length||t>this.packet.length)return null;const r=this._list.slice(this._pos,t);this._pos+=e;a("_parseBuffer: result: %o",r);return r}_parseNum(){if(this._list.length-this._pos<2)return-1;const e=this._list.readUInt16BE(this._pos);this._pos+=2;a("_parseNum: result: %s",e);return e}_parse4ByteNum(){if(this._list.length-this._pos<4)return-1;const e=this._list.readUInt32BE(this._pos);this._pos+=4;a("_parse4ByteNum: result: %s",e);return e}_parseVarByteNum(e){a("_parseVarByteNum");const t=4;let r=0;let i=1;let n=0;let s=false;let l;const u=this._pos?this._pos:0;while(r<t&&u+r<this._list.length){l=this._list.readUInt8(u+r++);n+=i*(l&o.VARBYTEINT_MASK);i*=128;if((l&o.VARBYTEINT_FIN_MASK)===0){s=true;break}if(this._list.length<=r){break}}if(!s&&r===t&&this._list.length>=r){this._emitError(new Error("Invalid variable byte integer"))}if(u){this._pos+=r}if(s){if(e){s={bytes:r,value:n}}else{s=n}}else{s=false}a("_parseVarByteNum: result: %o",s);return s}_parseByte(){let e;if(this._pos<this._list.length){e=this._list.readUInt8(this._pos);this._pos++}a("_parseByte: result: %o",e);return e}_parseByType(e){a("_parseByType: type: %s",e);switch(e){case"byte":{return this._parseByte()!==0}case"int8":{return this._parseByte()}case"int16":{return this._parseNum()}case"int32":{return this._parse4ByteNum()}case"var":{return this._parseVarByteNum()}case"string":{return this._parseString()}case"pair":{return this._parseStringPair()}case"binary":{return this._parseBuffer()}}}_parseProperties(){a("_parseProperties");const e=this._parseVarByteNum();const t=this._pos;const r=t+e;const i={};while(this._pos<r){const e=this._parseByte();if(!e){this._emitError(new Error("Cannot parse property code type"));return false}const t=o.propertiesCodes[e];if(!t){this._emitError(new Error("Unknown property"));return false}if(t==="userProperties"){if(!i[t]){i[t]=Object.create(null)}const e=this._parseByType(o.propertiesTypes[t]);if(i[t][e.name]){if(Array.isArray(i[t][e.name])){i[t][e.name].push(e.value)}else{const r=i[t][e.name];i[t][e.name]=[r];i[t][e.name].push(e.value)}}else{i[t][e.name]=e.value}continue}if(i[t]){if(Array.isArray(i[t])){i[t].push(this._parseByType(o.propertiesTypes[t]))}else{i[t]=[i[t]];i[t].push(this._parseByType(o.propertiesTypes[t]))}}else{i[t]=this._parseByType(o.propertiesTypes[t])}}return i}_newPacket(){a("_newPacket");if(this.packet){this._list.consume(this.packet.length);a("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length);this.emit("packet",this.packet)}a("_newPacket: new packet");this.packet=new s;this._pos=0;return true}_emitError(e){a("_emitError",e);this.error=e;this.emit("error",e)}}e.exports=Parser},5671:(e,t,r)=>{const i=r(1378);const{Buffer:n}=r(4300);const s=n.allocUnsafe(0);const o=n.from([0]);const a=r(389);const l=r(5951).nextTick;const u=r(6248)("mqtt-packet:writeToStream");const c=a.cache;const h=a.generateNumber;const d=a.generateCache;const p=a.genBufVariableByteInt;const b=a.generate4ByteBuffer;let g=writeNumberCached;let _=true;function generate(e,t,r){u("generate called");if(t.cork){t.cork();l(uncork,t)}if(_){_=false;d()}u("generate: packet.cmd: %s",e.cmd);switch(e.cmd){case"connect":return connect(e,t,r);case"connack":return connack(e,t,r);case"publish":return publish(e,t,r);case"puback":case"pubrec":case"pubrel":case"pubcomp":return confirmation(e,t,r);case"subscribe":return subscribe(e,t,r);case"suback":return suback(e,t,r);case"unsubscribe":return unsubscribe(e,t,r);case"unsuback":return unsuback(e,t,r);case"pingreq":case"pingresp":return emptyPacket(e,t,r);case"disconnect":return disconnect(e,t,r);case"auth":return auth(e,t,r);default:t.destroy(new Error("Unknown command"));return false}}Object.defineProperty(generate,"cacheNumbers",{get(){return g===writeNumberCached},set(e){if(e){if(!c||Object.keys(c).length===0)_=true;g=writeNumberCached}else{_=false;g=writeNumberGenerated}}});function uncork(e){e.uncork()}function connect(e,t,r){const s=e||{};const o=s.protocolId||"MQTT";let a=s.protocolVersion||4;const l=s.will;let u=s.clean;const c=s.keepalive||0;const h=s.clientId||"";const d=s.username;const p=s.password;const b=s.properties;if(u===undefined)u=true;let _=0;if(!o||typeof o!=="string"&&!n.isBuffer(o)){t.destroy(new Error("Invalid protocolId"));return false}else _+=o.length+2;if(a!==3&&a!==4&&a!==5){t.destroy(new Error("Invalid protocol version"));return false}else _+=1;if((typeof h==="string"||n.isBuffer(h))&&(h||a>=4)&&(h||u)){_+=n.byteLength(h)+2}else{if(a<4){t.destroy(new Error("clientId must be supplied before 3.1.1"));return false}if(u*1===0){t.destroy(new Error("clientId must be given if cleanSession set to 0"));return false}}if(typeof c!=="number"||c<0||c>65535||c%1!==0){t.destroy(new Error("Invalid keepalive"));return false}else _+=2;_+=1;let m;let y;if(a===5){m=getProperties(t,b);if(!m){return false}_+=m.length}if(l){if(typeof l!=="object"){t.destroy(new Error("Invalid will"));return false}if(!l.topic||typeof l.topic!=="string"){t.destroy(new Error("Invalid will topic"));return false}else{_+=n.byteLength(l.topic)+2}_+=2;if(l.payload){if(l.payload.length>=0){if(typeof l.payload==="string"){_+=n.byteLength(l.payload)}else{_+=l.payload.length}}else{t.destroy(new Error("Invalid will payload"));return false}}y={};if(a===5){y=getProperties(t,l.properties);if(!y){return false}_+=y.length}}let w=false;if(d!=null){if(isStringOrBuffer(d)){w=true;_+=n.byteLength(d)+2}else{t.destroy(new Error("Invalid username"));return false}}if(p!=null){if(!w){t.destroy(new Error("Username is required to use password"));return false}if(isStringOrBuffer(p)){_+=byteLength(p)+2}else{t.destroy(new Error("Invalid password"));return false}}t.write(i.CONNECT_HEADER);writeVarByteInt(t,_);writeStringOrBuffer(t,o);if(s.bridgeMode){a+=128}t.write(a===131?i.VERSION131:a===132?i.VERSION132:a===4?i.VERSION4:a===5?i.VERSION5:i.VERSION3);let S=0;S|=d!=null?i.USERNAME_MASK:0;S|=p!=null?i.PASSWORD_MASK:0;S|=l&&l.retain?i.WILL_RETAIN_MASK:0;S|=l&&l.qos?l.qos<<i.WILL_QOS_SHIFT:0;S|=l?i.WILL_FLAG_MASK:0;S|=u?i.CLEAN_SESSION_MASK:0;t.write(n.from([S]));g(t,c);if(a===5){m.write()}writeStringOrBuffer(t,h);if(l){if(a===5){y.write()}writeString(t,l.topic);writeStringOrBuffer(t,l.payload)}if(d!=null){writeStringOrBuffer(t,d)}if(p!=null){writeStringOrBuffer(t,p)}return true}function connack(e,t,r){const s=r?r.protocolVersion:4;const a=e||{};const l=s===5?a.reasonCode:a.returnCode;const u=a.properties;let c=2;if(typeof l!=="number"){t.destroy(new Error("Invalid return code"));return false}let h=null;if(s===5){h=getProperties(t,u);if(!h){return false}c+=h.length}t.write(i.CONNACK_HEADER);writeVarByteInt(t,c);t.write(a.sessionPresent?i.SESSIONPRESENT_HEADER:o);t.write(n.from([l]));if(h!=null){h.write()}return true}function publish(e,t,r){u("publish: packet: %o",e);const o=r?r.protocolVersion:4;const a=e||{};const l=a.qos||0;const c=a.retain?i.RETAIN_MASK:0;const h=a.topic;const d=a.payload||s;const p=a.messageId;const b=a.properties;let _=0;if(typeof h==="string")_+=n.byteLength(h)+2;else if(n.isBuffer(h))_+=h.length+2;else{t.destroy(new Error("Invalid topic"));return false}if(!n.isBuffer(d))_+=n.byteLength(d);else _+=d.length;if(l&&typeof p!=="number"){t.destroy(new Error("Invalid messageId"));return false}else if(l)_+=2;let m=null;if(o===5){m=getProperties(t,b);if(!m){return false}_+=m.length}t.write(i.PUBLISH_HEADER[l][a.dup?1:0][c?1:0]);writeVarByteInt(t,_);g(t,byteLength(h));t.write(h);if(l>0)g(t,p);if(m!=null){m.write()}u("publish: payload: %o",d);return t.write(d)}function confirmation(e,t,r){const s=r?r.protocolVersion:4;const o=e||{};const a=o.cmd||"puback";const l=o.messageId;const u=o.dup&&a==="pubrel"?i.DUP_MASK:0;let c=0;const h=o.reasonCode;const d=o.properties;let p=s===5?3:2;if(a==="pubrel")c=1;if(typeof l!=="number"){t.destroy(new Error("Invalid messageId"));return false}let b=null;if(s===5){if(typeof d==="object"){b=getPropertiesByMaximumPacketSize(t,d,r,p);if(!b){return false}p+=b.length}}t.write(i.ACKS[a][c][u][0]);if(p===3)p+=h!==0?1:-1;writeVarByteInt(t,p);g(t,l);if(s===5&&p!==2){t.write(n.from([h]))}if(b!==null){b.write()}else{if(p===4){t.write(n.from([0]))}}return true}function subscribe(e,t,r){u("subscribe: packet: ");const s=r?r.protocolVersion:4;const o=e||{};const a=o.dup?i.DUP_MASK:0;const l=o.messageId;const c=o.subscriptions;const h=o.properties;let d=0;if(typeof l!=="number"){t.destroy(new Error("Invalid messageId"));return false}else d+=2;let p=null;if(s===5){p=getProperties(t,h);if(!p){return false}d+=p.length}if(typeof c==="object"&&c.length){for(let e=0;e<c.length;e+=1){const r=c[e].topic;const i=c[e].qos;if(typeof r!=="string"){t.destroy(new Error("Invalid subscriptions - invalid topic"));return false}if(typeof i!=="number"){t.destroy(new Error("Invalid subscriptions - invalid qos"));return false}if(s===5){const r=c[e].nl||false;if(typeof r!=="boolean"){t.destroy(new Error("Invalid subscriptions - invalid No Local"));return false}const i=c[e].rap||false;if(typeof i!=="boolean"){t.destroy(new Error("Invalid subscriptions - invalid Retain as Published"));return false}const n=c[e].rh||0;if(typeof n!=="number"||n>2){t.destroy(new Error("Invalid subscriptions - invalid Retain Handling"));return false}}d+=n.byteLength(r)+2+1}}else{t.destroy(new Error("Invalid subscriptions"));return false}u("subscribe: writing to stream: %o",i.SUBSCRIBE_HEADER);t.write(i.SUBSCRIBE_HEADER[1][a?1:0][0]);writeVarByteInt(t,d);g(t,l);if(p!==null){p.write()}let b=true;for(const e of c){const r=e.topic;const o=e.qos;const a=+e.nl;const l=+e.rap;const u=e.rh;let c;writeString(t,r);c=i.SUBSCRIBE_OPTIONS_QOS[o];if(s===5){c|=a?i.SUBSCRIBE_OPTIONS_NL:0;c|=l?i.SUBSCRIBE_OPTIONS_RAP:0;c|=u?i.SUBSCRIBE_OPTIONS_RH[u]:0}b=t.write(n.from([c]))}return b}function suback(e,t,r){const s=r?r.protocolVersion:4;const o=e||{};const a=o.messageId;const l=o.granted;const u=o.properties;let c=0;if(typeof a!=="number"){t.destroy(new Error("Invalid messageId"));return false}else c+=2;if(typeof l==="object"&&l.length){for(let e=0;e<l.length;e+=1){if(typeof l[e]!=="number"){t.destroy(new Error("Invalid qos vector"));return false}c+=1}}else{t.destroy(new Error("Invalid qos vector"));return false}let h=null;if(s===5){h=getPropertiesByMaximumPacketSize(t,u,r,c);if(!h){return false}c+=h.length}t.write(i.SUBACK_HEADER);writeVarByteInt(t,c);g(t,a);if(h!==null){h.write()}return t.write(n.from(l))}function unsubscribe(e,t,r){const s=r?r.protocolVersion:4;const o=e||{};const a=o.messageId;const l=o.dup?i.DUP_MASK:0;const u=o.unsubscriptions;const c=o.properties;let h=0;if(typeof a!=="number"){t.destroy(new Error("Invalid messageId"));return false}else{h+=2}if(typeof u==="object"&&u.length){for(let e=0;e<u.length;e+=1){if(typeof u[e]!=="string"){t.destroy(new Error("Invalid unsubscriptions"));return false}h+=n.byteLength(u[e])+2}}else{t.destroy(new Error("Invalid unsubscriptions"));return false}let d=null;if(s===5){d=getProperties(t,c);if(!d){return false}h+=d.length}t.write(i.UNSUBSCRIBE_HEADER[1][l?1:0][0]);writeVarByteInt(t,h);g(t,a);if(d!==null){d.write()}let p=true;for(let e=0;e<u.length;e++){p=writeString(t,u[e])}return p}function unsuback(e,t,r){const s=r?r.protocolVersion:4;const o=e||{};const a=o.messageId;const l=o.dup?i.DUP_MASK:0;const u=o.granted;const c=o.properties;const h=o.cmd;const d=0;let p=2;if(typeof a!=="number"){t.destroy(new Error("Invalid messageId"));return false}if(s===5){if(typeof u==="object"&&u.length){for(let e=0;e<u.length;e+=1){if(typeof u[e]!=="number"){t.destroy(new Error("Invalid qos vector"));return false}p+=1}}else{t.destroy(new Error("Invalid qos vector"));return false}}let b=null;if(s===5){b=getPropertiesByMaximumPacketSize(t,c,r,p);if(!b){return false}p+=b.length}t.write(i.ACKS[h][d][l][0]);writeVarByteInt(t,p);g(t,a);if(b!==null){b.write()}if(s===5){t.write(n.from(u))}return true}function emptyPacket(e,t,r){return t.write(i.EMPTY[e.cmd])}function disconnect(e,t,r){const s=r?r.protocolVersion:4;const o=e||{};const a=o.reasonCode;const l=o.properties;let u=s===5?1:0;let c=null;if(s===5){c=getPropertiesByMaximumPacketSize(t,l,r,u);if(!c){return false}u+=c.length}t.write(n.from([i.codes.disconnect<<4]));writeVarByteInt(t,u);if(s===5){t.write(n.from([a]))}if(c!==null){c.write()}return true}function auth(e,t,r){const s=r?r.protocolVersion:4;const o=e||{};const a=o.reasonCode;const l=o.properties;let u=s===5?1:0;if(s!==5)t.destroy(new Error("Invalid mqtt version for auth packet"));const c=getPropertiesByMaximumPacketSize(t,l,r,u);if(!c){return false}u+=c.length;t.write(n.from([i.codes.auth<<4]));writeVarByteInt(t,u);t.write(n.from([a]));if(c!==null){c.write()}return true}const m={};function writeVarByteInt(e,t){if(t>i.VARBYTEINT_MAX){e.destroy(new Error(`Invalid variable byte integer: ${t}`));return false}let r=m[t];if(!r){r=p(t);if(t<16384)m[t]=r}u("writeVarByteInt: writing to stream: %o",r);return e.write(r)}function writeString(e,t){const r=n.byteLength(t);g(e,r);u("writeString: %s",t);return e.write(t,"utf8")}function writeStringPair(e,t,r){writeString(e,t);writeString(e,r)}function writeNumberCached(e,t){u("writeNumberCached: number: %d",t);u("writeNumberCached: %o",c[t]);return e.write(c[t])}function writeNumberGenerated(e,t){const r=h(t);u("writeNumberGenerated: %o",r);return e.write(r)}function write4ByteNumber(e,t){const r=b(t);u("write4ByteNumber: %o",r);return e.write(r)}function writeStringOrBuffer(e,t){if(typeof t==="string"){writeString(e,t)}else if(t){g(e,t.length);e.write(t)}else g(e,0)}function getProperties(e,t){if(typeof t!=="object"||t.length!=null){return{length:1,write(){writeProperties(e,{},0)}}}let r=0;function getLengthProperty(t,r){const s=i.propertiesTypes[t];let o=0;switch(s){case"byte":{if(typeof r!=="boolean"){e.destroy(new Error(`Invalid ${t}: ${r}`));return false}o+=1+1;break}case"int8":{if(typeof r!=="number"||r<0||r>255){e.destroy(new Error(`Invalid ${t}: ${r}`));return false}o+=1+1;break}case"binary":{if(r&&r===null){e.destroy(new Error(`Invalid ${t}: ${r}`));return false}o+=1+n.byteLength(r)+2;break}case"int16":{if(typeof r!=="number"||r<0||r>65535){e.destroy(new Error(`Invalid ${t}: ${r}`));return false}o+=1+2;break}case"int32":{if(typeof r!=="number"||r<0||r>4294967295){e.destroy(new Error(`Invalid ${t}: ${r}`));return false}o+=1+4;break}case"var":{if(typeof r!=="number"||r<0||r>268435455){e.destroy(new Error(`Invalid ${t}: ${r}`));return false}o+=1+n.byteLength(p(r));break}case"string":{if(typeof r!=="string"){e.destroy(new Error(`Invalid ${t}: ${r}`));return false}o+=1+2+n.byteLength(r.toString());break}case"pair":{if(typeof r!=="object"){e.destroy(new Error(`Invalid ${t}: ${r}`));return false}o+=Object.getOwnPropertyNames(r).reduce(((e,t)=>{const i=r[t];if(Array.isArray(i)){e+=i.reduce(((e,r)=>{e+=1+2+n.byteLength(t.toString())+2+n.byteLength(r.toString());return e}),0)}else{e+=1+2+n.byteLength(t.toString())+2+n.byteLength(r[t].toString())}return e}),0);break}default:{e.destroy(new Error(`Invalid property ${t}: ${r}`));return false}}return o}if(t){for(const e in t){let i=0;let n=0;const s=t[e];if(Array.isArray(s)){for(let t=0;t<s.length;t++){n=getLengthProperty(e,s[t]);if(!n){return false}i+=n}}else{n=getLengthProperty(e,s);if(!n){return false}i=n}if(!i)return false;r+=i}}const s=n.byteLength(p(r));return{length:s+r,write(){writeProperties(e,t,r)}}}function getPropertiesByMaximumPacketSize(e,t,r,i){const n=["reasonString","userProperties"];const s=r&&r.properties&&r.properties.maximumPacketSize?r.properties.maximumPacketSize:0;let o=getProperties(e,t);if(s){while(i+o.length>s){const r=n.shift();if(r&&t[r]){delete t[r];o=getProperties(e,t)}else{return false}}}return o}function writeProperty(e,t,r){const s=i.propertiesTypes[t];switch(s){case"byte":{e.write(n.from([i.properties[t]]));e.write(n.from([+r]));break}case"int8":{e.write(n.from([i.properties[t]]));e.write(n.from([r]));break}case"binary":{e.write(n.from([i.properties[t]]));writeStringOrBuffer(e,r);break}case"int16":{e.write(n.from([i.properties[t]]));g(e,r);break}case"int32":{e.write(n.from([i.properties[t]]));write4ByteNumber(e,r);break}case"var":{e.write(n.from([i.properties[t]]));writeVarByteInt(e,r);break}case"string":{e.write(n.from([i.properties[t]]));writeString(e,r);break}case"pair":{Object.getOwnPropertyNames(r).forEach((s=>{const o=r[s];if(Array.isArray(o)){o.forEach((r=>{e.write(n.from([i.properties[t]]));writeStringPair(e,s.toString(),r.toString())}))}else{e.write(n.from([i.properties[t]]));writeStringPair(e,s.toString(),o.toString())}}));break}default:{e.destroy(new Error(`Invalid property ${t} value: ${r}`));return false}}}function writeProperties(e,t,r){writeVarByteInt(e,r);for(const r in t){if(Object.prototype.hasOwnProperty.call(t,r)&&t[r]!==null){const i=t[r];if(Array.isArray(i)){for(let t=0;t<i.length;t++){writeProperty(e,r,i[t])}}else{writeProperty(e,r,i)}}}}function byteLength(e){if(!e)return 0;else if(e instanceof n)return e.length;else return n.byteLength(e)}function isStringOrBuffer(e){return typeof e==="string"||e instanceof n}e.exports=generate},5498:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.TypedEventEmitter=void 0;const n=i(r(2361));const s=r(6849);class TypedEventEmitter{}t.TypedEventEmitter=TypedEventEmitter;(0,s.applyMixin)(TypedEventEmitter,n.default)},8935:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){if(i===undefined)i=r;var n=Object.getOwnPropertyDescriptor(t,r);if(!n||("get"in n?!t.__esModule:n.writable||n.configurable)){n={enumerable:true,get:function(){return t[r]}}}Object.defineProperty(e,i,n)}:function(e,t,r,i){if(i===undefined)i=r;e[i]=t[r]});var n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(r!=="default"&&Object.prototype.hasOwnProperty.call(e,r))i(t,e,r);n(t,e);return t};var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const a=o(r(1419));const l=o(r(2825));const u=o(r(5629));const c=r(9943);const h=o(r(590));const d=o(r(7114));const p=s(r(1386));const b=o(r(6248));const g=o(r(7212));const _=o(r(127));const m=r(5498);const y=process?process.nextTick:e=>{setTimeout(e,0)};const w=global.setImmediate||((...e)=>{const t=e.shift();y((()=>{t(...e)}))});const S={keepalive:60,reschedulePings:true,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:30*1e3,clean:true,resubscribe:true,writeCache:true};const v=["ECONNREFUSED","EADDRINUSE","ECONNRESET","ENOTFOUND","ETIMEDOUT"];class MqttClient extends m.TypedEventEmitter{static defaultId(){return`mqttjs_${Math.random().toString(16).substr(2,8)}`}constructor(e,t){super();this.options=t||{};for(const e in S){if(typeof this.options[e]==="undefined"){this.options[e]=S[e]}else{this.options[e]=t[e]}}this.log=this.options.log||(0,b.default)("mqttjs:client");this.noop=this._noop.bind(this);this.log("MqttClient :: options.protocol",t.protocol);this.log("MqttClient :: options.protocolVersion",t.protocolVersion);this.log("MqttClient :: options.username",t.username);this.log("MqttClient :: options.keepalive",t.keepalive);this.log("MqttClient :: options.reconnectPeriod",t.reconnectPeriod);this.log("MqttClient :: options.rejectUnauthorized",t.rejectUnauthorized);this.log("MqttClient :: options.properties.topicAliasMaximum",t.properties?t.properties.topicAliasMaximum:undefined);this.options.clientId=typeof t.clientId==="string"?t.clientId:MqttClient.defaultId();this.log("MqttClient :: clientId",this.options.clientId);this.options.customHandleAcks=t.protocolVersion===5&&t.customHandleAcks?t.customHandleAcks:(...e)=>{e[3](null,0)};if(!this.options.writeCache){l.default.writeToStream.cacheNumbers=false}this.streamBuilder=e;this.messageIdProvider=typeof this.options.messageIdProvider==="undefined"?new u.default:this.options.messageIdProvider;this.outgoingStore=t.outgoingStore||new g.default;this.incomingStore=t.incomingStore||new g.default;this.queueQoSZero=t.queueQoSZero===undefined?true:t.queueQoSZero;this._resubscribeTopics={};this.messageIdToTopic={};this.pingTimer=null;this.connected=false;this.disconnecting=false;this.queue=[];this.connackTimer=null;this.reconnectTimer=null;this._storeProcessing=false;this._packetIdsDuringStoreProcessing={};this._storeProcessingQueue=[];this.outgoing={};this._firstConnection=true;if(t.properties&&t.properties.topicAliasMaximum>0){if(t.properties.topicAliasMaximum>65535){this.log("MqttClient :: options.properties.topicAliasMaximum is out of range")}else{this.topicAliasRecv=new a.default(t.properties.topicAliasMaximum)}}this.on("connect",(()=>{const{queue:e}=this;const deliver=()=>{const t=e.shift();this.log("deliver :: entry %o",t);let r=null;if(!t){this._resubscribe();return}r=t.packet;this.log("deliver :: call _sendPacket for %o",r);let i=true;if(r.messageId&&r.messageId!==0){if(!this.messageIdProvider.register(r.messageId)){i=false}}if(i){this._sendPacket(r,(e=>{if(t.cb){t.cb(e)}deliver()}))}else{this.log("messageId: %d has already used. The message is skipped and removed.",r.messageId);deliver()}};this.log("connect :: sending queued packets");deliver()}));this.on("close",(()=>{this.log("close :: connected set to `false`");this.connected=false;this.log("close :: clearing connackTimer");clearTimeout(this.connackTimer);this.log("close :: clearing ping timer");if(this.pingTimer!==null){this.pingTimer.clear();this.pingTimer=null}if(this.topicAliasRecv){this.topicAliasRecv.clear()}this.log("close :: calling _setupReconnect");this._setupReconnect()}));if(!this.options.manualConnect){this.log("MqttClient :: setting up stream");this.connect()}}handleAuth(e,t){t()}handleMessage(e,t){t()}_nextId(){return this.messageIdProvider.allocate()}getLastMessageId(){return this.messageIdProvider.getLastAllocated()}connect(){var e;const t=new c.Writable;const r=l.default.parser(this.options);let i=null;const n=[];this.log("connect :: calling method to clear reconnect");this._clearReconnect();this.log("connect :: using streamBuilder provided to client to create stream");this.stream=this.streamBuilder(this);r.on("packet",(e=>{this.log("parser :: on packet push to packets array.");n.push(e)}));const work=()=>{this.log("work :: getting next packet in queue");const e=n.shift();if(e){this.log("work :: packet pulled from queue");(0,_.default)(this,e,nextTickWork)}else{this.log("work :: no packets in queue");const e=i;i=null;this.log("work :: done flag is %s",!!e);if(e)e()}};const nextTickWork=()=>{if(n.length){y(work)}else{const e=i;i=null;e()}};t._write=(e,t,n)=>{i=n;this.log("writable stream :: parsing buffer");r.parse(e);work()};const streamErrorHandler=e=>{this.log("streamErrorHandler :: error",e.message);if(v.includes(e.code)){this.log("streamErrorHandler :: emitting error");this.emit("error",e)}else{this.noop(e)}};this.log("connect :: pipe stream to writable stream");this.stream.pipe(t);this.stream.on("error",streamErrorHandler);this.stream.on("close",(()=>{this.log("(%s)stream :: on close",this.options.clientId);this._flushVolatile();this.log("stream: emit close to MqttClient");this.emit("close")}));this.log("connect: sending packet `connect`");const s={cmd:"connect",protocolId:this.options.protocolId,protocolVersion:this.options.protocolVersion,clean:this.options.clean,clientId:this.options.clientId,keepalive:this.options.keepalive,username:this.options.username,password:this.options.password,properties:this.options.properties};if(this.options.will){s.will=Object.assign(Object.assign({},this.options.will),{payload:(e=this.options.will)===null||e===void 0?void 0:e.payload})}if(this.topicAliasRecv){if(!s.properties){s.properties={}}if(this.topicAliasRecv){s.properties.topicAliasMaximum=this.topicAliasRecv.max}}this._writePacket(s);r.on("error",this.emit.bind(this,"error"));if(this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData){this.end((()=>this.emit("error",new Error("Packet has no Authentication Method"))));return this}if(this.options.properties.authenticationMethod&&this.options.authPacket&&typeof this.options.authPacket==="object"){const e=Object.assign({cmd:"auth",reasonCode:0},this.options.authPacket);this._writePacket(e)}}this.stream.setMaxListeners(1e3);clearTimeout(this.connackTimer);this.connackTimer=setTimeout((()=>{this.log("!!connectTimeout hit!! Calling _cleanUp with force `true`");this._cleanUp(true)}),this.options.connectTimeout);return this}publish(e,t,r,i){this.log("publish :: message `%s` to topic `%s`",t,e);const{options:n}=this;if(typeof r==="function"){i=r;r=null}r=r||{};const s={qos:0,retain:false,dup:false};r=Object.assign(Object.assign({},s),r);const{qos:o,retain:a,dup:l,properties:u,cbStorePut:c}=r;if(this._checkDisconnecting(i)){return this}const publishProc=()=>{let r=0;if(o===1||o===2){r=this._nextId();if(r===null){this.log("No messageId left");return false}}const s={cmd:"publish",topic:e,payload:t,qos:o,retain:a,messageId:r,dup:l};if(n.protocolVersion===5){s.properties=u}this.log("publish :: qos",o);switch(o){case 1:case 2:this.outgoing[s.messageId]={volatile:false,cb:i||this.noop};this.log("MqttClient:publish: packet cmd: %s",s.cmd);this._sendPacket(s,undefined,c);break;default:this.log("MqttClient:publish: packet cmd: %s",s.cmd);this._sendPacket(s,i,c);break}return true};if(this._storeProcessing||this._storeProcessingQueue.length>0||!publishProc()){this._storeProcessingQueue.push({invoke:publishProc,cbStorePut:r.cbStorePut,callback:i})}return this}publishAsync(e,t,r){return new Promise(((i,n)=>{this.publish(e,t,r,(e=>{if(e){n(e)}else{i()}}))}))}subscribe(e,t,r){const i=this.options.protocolVersion;if(typeof t==="function"){r=t}r=r||this.noop;let n=false;let s=[];if(typeof e==="string"){e=[e];s=e}else if(Array.isArray(e)){s=e}else if(typeof e==="object"){n=e.resubscribe;delete e.resubscribe;s=Object.keys(e)}const o=p.validateTopics(s);if(o!==null){w(r,new Error(`Invalid topic ${o}`));return this}if(this._checkDisconnecting(r)){this.log("subscribe: discconecting true");return this}const a={qos:0};if(i===5){a.nl=false;a.rap=false;a.rh=0}t=Object.assign(Object.assign({},a),t);const l=t.properties;const u=[];const parseSub=(e,r)=>{r=r||t;if(!Object.prototype.hasOwnProperty.call(this._resubscribeTopics,e)||this._resubscribeTopics[e].qos<r.qos||n){const t={topic:e,qos:r.qos};if(i===5){t.nl=r.nl;t.rap=r.rap;t.rh=r.rh;t.properties=l}this.log("subscribe: pushing topic `%s` and qos `%s` to subs list",t.topic,t.qos);u.push(t)}};if(Array.isArray(e)){e.forEach((e=>{this.log("subscribe: array topic %s",e);parseSub(e)}))}else{Object.keys(e).forEach((t=>{this.log("subscribe: object topic %s, %o",t,e[t]);parseSub(t,e[t])}))}if(!u.length){r(null,[]);return this}const subscribeProc=()=>{const e=this._nextId();if(e===null){this.log("No messageId left");return false}const t={cmd:"subscribe",subscriptions:u,messageId:e};if(l){t.properties=l}if(this.options.resubscribe){this.log("subscribe :: resubscribe true");const e=[];u.forEach((t=>{if(this.options.reconnectPeriod>0){const r={qos:t.qos};if(i===5){r.nl=t.nl||false;r.rap=t.rap||false;r.rh=t.rh||0;r.properties=t.properties}this._resubscribeTopics[t.topic]=r;e.push(t.topic)}}));this.messageIdToTopic[t.messageId]=e}this.outgoing[t.messageId]={volatile:true,cb(e,t){if(!e){const{granted:e}=t;for(let t=0;t<e.length;t+=1){u[t].qos=e[t]}}r(e,u)}};this.log("subscribe :: call _sendPacket");this._sendPacket(t);return true};if(this._storeProcessing||this._storeProcessingQueue.length>0||!subscribeProc()){this._storeProcessingQueue.push({invoke:subscribeProc,callback:r})}return this}subscribeAsync(e,t){return new Promise(((r,i)=>{this.subscribe(e,t,((e,t)=>{if(e){i(e)}else{r(t)}}))}))}unsubscribe(e,t,r){if(typeof e==="string"){e=[e]}if(typeof t==="function"){r=t}r=r||this.noop;const i=p.validateTopics(e);if(i!==null){w(r,new Error(`Invalid topic ${i}`));return this}if(this._checkDisconnecting(r)){return this}const unsubscribeProc=()=>{const i=this._nextId();if(i===null){this.log("No messageId left");return false}const n={cmd:"unsubscribe",messageId:i,unsubscriptions:[]};if(typeof e==="string"){n.unsubscriptions=[e]}else if(Array.isArray(e)){n.unsubscriptions=e}if(this.options.resubscribe){n.unsubscriptions.forEach((e=>{delete this._resubscribeTopics[e]}))}if(typeof t==="object"&&t.properties){n.properties=t.properties}this.outgoing[n.messageId]={volatile:true,cb:r};this.log("unsubscribe: call _sendPacket");this._sendPacket(n);return true};if(this._storeProcessing||this._storeProcessingQueue.length>0||!unsubscribeProc()){this._storeProcessingQueue.push({invoke:unsubscribeProc,callback:r})}return this}unsubscribeAsync(e,t){return new Promise(((r,i)=>{this.unsubscribe(e,t,(e=>{if(e){i(e)}else{r()}}))}))}end(e,t,r){this.log("end :: (%s)",this.options.clientId);if(e==null||typeof e!=="boolean"){r=r||t;t=e;e=false}if(typeof t!=="object"){r=r||t;t=null}this.log("end :: cb? %s",!!r);if(!r||typeof r!=="function"){r=this.noop}const closeStores=()=>{this.log("end :: closeStores: closing incoming and outgoing stores");this.disconnected=true;this.incomingStore.close((e=>{this.outgoingStore.close((t=>{this.log("end :: closeStores: emitting end");this.emit("end");if(r){const i=e||t;this.log("end :: closeStores: invoking callback with args");r(i)}}))}));if(this._deferredReconnect){this._deferredReconnect()}};const finish=()=>{this.log("end :: (%s) :: finish :: calling _cleanUp with force %s",this.options.clientId,e);this._cleanUp(e,(()=>{this.log("end :: finish :: calling process.nextTick on closeStores");y(closeStores)}),t)};if(this.disconnecting){r();return this}this._clearReconnect();this.disconnecting=true;if(!e&&Object.keys(this.outgoing).length>0){this.log("end :: (%s) :: calling finish in 10ms once outgoing is empty",this.options.clientId);this.once("outgoingEmpty",setTimeout.bind(null,finish,10))}else{this.log("end :: (%s) :: immediately calling finish",this.options.clientId);finish()}return this}endAsync(e,t){return new Promise(((r,i)=>{this.end(e,t,(e=>{if(e){i(e)}else{r()}}))}))}removeOutgoingMessage(e){if(this.outgoing[e]){const{cb:t}=this.outgoing[e];this._removeOutgoingAndStoreMessage(e,(()=>{t(new Error("Message removed"))}))}return this}reconnect(e){this.log("client reconnect");const f=()=>{if(e){this.options.incomingStore=e.incomingStore;this.options.outgoingStore=e.outgoingStore}else{this.options.incomingStore=null;this.options.outgoingStore=null}this.incomingStore=this.options.incomingStore||new g.default;this.outgoingStore=this.options.outgoingStore||new g.default;this.disconnecting=false;this.disconnected=false;this._deferredReconnect=null;this._reconnect()};if(this.disconnecting&&!this.disconnected){this._deferredReconnect=f}else{f()}return this}_flushVolatile(){if(this.outgoing){this.log("_flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function");Object.keys(this.outgoing).forEach((e=>{if(this.outgoing[e].volatile&&typeof this.outgoing[e].cb==="function"){this.outgoing[e].cb(new Error("Connection closed"));delete this.outgoing[e]}}))}}_flush(){if(this.outgoing){this.log("_flush: queue exists? %b",!!this.outgoing);Object.keys(this.outgoing).forEach((e=>{if(typeof this.outgoing[e].cb==="function"){this.outgoing[e].cb(new Error("Connection closed"));delete this.outgoing[e]}}))}}_removeTopicAliasAndRecoverTopicName(e){let t;if(e.properties){t=e.properties.topicAlias}let r=e.topic.toString();this.log("_removeTopicAliasAndRecoverTopicName :: alias %d, topic %o",t,r);if(r.length===0){if(typeof t==="undefined"){return new Error("Unregistered Topic Alias")}r=this.topicAliasSend.getTopicByAlias(t);if(typeof r==="undefined"){return new Error("Unregistered Topic Alias")}e.topic=r}if(t){delete e.properties.topicAlias}}_checkDisconnecting(e){if(this.disconnecting){if(e&&e!==this.noop){e(new Error("client disconnecting"))}else{this.emit("error",new Error("client disconnecting"))}}return this.disconnecting}_reconnect(){this.log("_reconnect: emitting reconnect to client");this.emit("reconnect");if(this.connected){this.end((()=>{this.connect()}));this.log("client already connected. disconnecting first.")}else{this.log("_reconnect: calling connect");this.connect()}}_setupReconnect(){if(!this.disconnecting&&!this.reconnectTimer&&this.options.reconnectPeriod>0){if(!this.reconnecting){this.log("_setupReconnect :: emit `offline` state");this.emit("offline");this.log("_setupReconnect :: set `reconnecting` to `true`");this.reconnecting=true}this.log("_setupReconnect :: setting reconnectTimer for %d ms",this.options.reconnectPeriod);this.reconnectTimer=setInterval((()=>{this.log("reconnectTimer :: reconnect triggered!");this._reconnect()}),this.options.reconnectPeriod)}else{this.log("_setupReconnect :: doing nothing...")}}_clearReconnect(){this.log("_clearReconnect : clearing reconnect timer");if(this.reconnectTimer){clearInterval(this.reconnectTimer);this.reconnectTimer=null}}_cleanUp(e,t,r={}){if(t){this.log("_cleanUp :: done callback provided for on stream close");this.stream.on("close",t)}this.log("_cleanUp :: forced? %s",e);if(e){if(this.options.reconnectPeriod===0&&this.options.clean){this._flush()}this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId);this.stream.destroy()}else{const e=Object.assign({cmd:"disconnect"},r);this.log("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId);this._sendPacket(e,(()=>{this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId);w((()=>{this.stream.end((()=>{this.log("_cleanUp :: (%s) :: stream destroyed",this.options.clientId)}))}))}))}if(!this.disconnecting){this.log("_cleanUp :: client not disconnecting. Clearing and resetting reconnect.");this._clearReconnect();this._setupReconnect()}if(this.pingTimer!==null){this.log("_cleanUp :: clearing pingTimer");this.pingTimer.clear();this.pingTimer=null}if(t&&!this.connected){this.log("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId);this.stream.removeListener("close",t);t()}}_storeAndSend(e,t,r){this.log("storeAndSend :: store packet with cmd %s to outgoingStore",e.cmd);let i=e;let n;if(i.cmd==="publish"){i=(0,d.default)(e);n=this._removeTopicAliasAndRecoverTopicName(i);if(n){return t&&t(n)}}this.outgoingStore.put(i,(i=>{if(i){return t&&t(i)}r();this._writePacket(e,t)}))}_applyTopicAlias(e){if(this.options.protocolVersion===5){if(e.cmd==="publish"){let t;if(e.properties){t=e.properties.topicAlias}const r=e.topic.toString();if(this.topicAliasSend){if(t){if(r.length!==0){this.log("applyTopicAlias :: register topic: %s - alias: %d",r,t);if(!this.topicAliasSend.put(r,t)){this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",r,t);return new Error("Sending Topic Alias out of range")}}}else if(r.length!==0){if(this.options.autoAssignTopicAlias){t=this.topicAliasSend.getAliasByTopic(r);if(t){e.topic="";e.properties=Object.assign(Object.assign({},e.properties),{topicAlias:t});this.log("applyTopicAlias :: auto assign(use) topic: %s - alias: %d",r,t)}else{t=this.topicAliasSend.getLruAlias();this.topicAliasSend.put(r,t);e.properties=Object.assign(Object.assign({},e.properties),{topicAlias:t});this.log("applyTopicAlias :: auto assign topic: %s - alias: %d",r,t)}}else if(this.options.autoUseTopicAlias){t=this.topicAliasSend.getAliasByTopic(r);if(t){e.topic="";e.properties=Object.assign(Object.assign({},e.properties),{topicAlias:t});this.log("applyTopicAlias :: auto use topic: %s - alias: %d",r,t)}}}}else if(t){this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",r,t);return new Error("Sending Topic Alias out of range")}}}}_noop(e){this.log("noop ::",e)}_writePacket(e,t){this.log("_writePacket :: packet: %O",e);this.log("_writePacket :: emitting `packetsend`");this.emit("packetsend",e);this._shiftPingInterval();this.log("_writePacket :: writing to stream");const r=l.default.writeToStream(e,this.stream,this.options);this.log("_writePacket :: writeToStream result %s",r);if(!r&&t&&t!==this.noop){this.log("_writePacket :: handle events on `drain` once through callback.");this.stream.once("drain",t)}else if(t){this.log("_writePacket :: invoking cb");t()}}_sendPacket(e,t,r,i){this.log("_sendPacket :: (%s) ::  start",this.options.clientId);r=r||this.noop;t=t||this.noop;const n=this._applyTopicAlias(e);if(n){t(n);return}if(!this.connected){if(e.cmd==="auth"){this._writePacket(e,t);return}this.log("_sendPacket :: client not connected. Storing packet offline.");this._storePacket(e,t,r);return}if(i){this._writePacket(e,t);return}switch(e.cmd){case"publish":break;case"pubrel":this._storeAndSend(e,t,r);return;default:this._writePacket(e,t);return}switch(e.qos){case 2:case 1:this._storeAndSend(e,t,r);break;case 0:default:this._writePacket(e,t);break}this.log("_sendPacket :: (%s) ::  end",this.options.clientId)}_storePacket(e,t,r){this.log("_storePacket :: packet: %o",e);this.log("_storePacket :: cb? %s",!!t);r=r||this.noop;let i=e;if(i.cmd==="publish"){i=(0,d.default)(e);const r=this._removeTopicAliasAndRecoverTopicName(i);if(r){return t&&t(r)}}const n=i.qos||0;if(n===0&&this.queueQoSZero||i.cmd!=="publish"){this.queue.push({packet:i,cb:t})}else if(n>0){t=this.outgoing[i.messageId]?this.outgoing[i.messageId].cb:null;this.outgoingStore.put(i,(e=>{if(e){return t&&t(e)}r()}))}else if(t){t(new Error("No connection to broker"))}}_setupPingTimer(){this.log("_setupPingTimer :: keepalive %d (seconds)",this.options.keepalive);if(!this.pingTimer&&this.options.keepalive){this.pingResp=true;this.pingTimer=(0,h.default)((()=>{this._checkPing()}),this.options.keepalive*1e3)}}_shiftPingInterval(){if(this.pingTimer&&this.options.keepalive&&this.options.reschedulePings){this.pingTimer.reschedule(this.options.keepalive*1e3)}}_checkPing(){this.log("_checkPing :: checking ping...");if(this.pingResp){this.log("_checkPing :: ping response received. Clearing flag and sending `pingreq`");this.pingResp=false;this._sendPacket({cmd:"pingreq"})}else{this.log("_checkPing :: calling _cleanUp with force true");this._cleanUp(true)}}_resubscribe(){this.log("_resubscribe");const e=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||this.options.protocolVersion>=4&&!this.connackPacket.sessionPresent)&&e.length>0){if(this.options.resubscribe){if(this.options.protocolVersion===5){this.log("_resubscribe: protocolVersion 5");for(let t=0;t<e.length;t++){const r={};r[e[t]]=this._resubscribeTopics[e[t]];r.resubscribe=true;this.subscribe(r,{properties:r[e[t]].properties})}}else{this._resubscribeTopics.resubscribe=true;this.subscribe(this._resubscribeTopics)}}else{this._resubscribeTopics={}}}this._firstConnection=false}_onConnect(e){if(this.disconnected){this.emit("connect",e);return}this.connackPacket=e;this.messageIdProvider.clear();this._setupPingTimer();this.connected=true;const startStreamProcess=()=>{let t=this.outgoingStore.createStream();const remove=()=>{t.destroy();t=null;this._flushStoreProcessingQueue();clearStoreProcessing()};const clearStoreProcessing=()=>{this._storeProcessing=false;this._packetIdsDuringStoreProcessing={}};this.once("close",remove);t.on("error",(e=>{clearStoreProcessing();this._flushStoreProcessingQueue();this.removeListener("close",remove);this.emit("error",e)}));const storeDeliver=()=>{if(!t){return}const e=t.read(1);let r;if(!e){t.once("readable",storeDeliver);return}this._storeProcessing=true;if(this._packetIdsDuringStoreProcessing[e.messageId]){storeDeliver();return}if(!this.disconnecting&&!this.reconnectTimer){r=this.outgoing[e.messageId]?this.outgoing[e.messageId].cb:null;this.outgoing[e.messageId]={volatile:false,cb(e,t){if(r){r(e,t)}storeDeliver()}};this._packetIdsDuringStoreProcessing[e.messageId]=true;if(this.messageIdProvider.register(e.messageId)){this._sendPacket(e,undefined,undefined,true)}else{this.log("messageId: %d has already used.",e.messageId)}}else if(t.destroy){t.destroy()}};t.on("end",(()=>{let t=true;for(const e in this._packetIdsDuringStoreProcessing){if(!this._packetIdsDuringStoreProcessing[e]){t=false;break}}if(t){clearStoreProcessing();this.removeListener("close",remove);this._invokeAllStoreProcessingQueue();this.emit("connect",e)}else{startStreamProcess()}}));storeDeliver()};startStreamProcess()}_invokeStoreProcessingQueue(){if(!this._storeProcessing&&this._storeProcessingQueue.length>0){const e=this._storeProcessingQueue[0];if(e&&e.invoke()){this._storeProcessingQueue.shift();return true}}return false}_invokeAllStoreProcessingQueue(){while(this._invokeStoreProcessingQueue()){}}_flushStoreProcessingQueue(){for(const e of this._storeProcessingQueue){if(e.cbStorePut)e.cbStorePut(new Error("Connection closed"));if(e.callback)e.callback(new Error("Connection closed"))}this._storeProcessingQueue.splice(0)}_removeOutgoingAndStoreMessage(e,t){delete this.outgoing[e];this.outgoingStore.del({messageId:e},((r,i)=>{t(r,i);this.messageIdProvider.deallocate(e);this._invokeStoreProcessingQueue()}))}}t["default"]=MqttClient},2790:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const n=r(4300);const s=r(9943);const o=i(r(9499));let a;let l;let u;let c=false;function buildProxy(){const e=new s.Transform;e._write=(e,t,r)=>{a.sendSocketMessage({data:e.buffer,success(){r()},fail(){r(new Error)}})};e._flush=e=>{a.closeSocket({success(){e()}})};return e}function setDefaultOpts(e){if(!e.hostname){e.hostname="localhost"}if(!e.path){e.path="/"}if(!e.wsOptions){e.wsOptions={}}}function buildUrl(e,t){const r=e.protocol==="alis"?"wss":"ws";let i=`${r}://${e.hostname}${e.path}`;if(e.port&&e.port!==80&&e.port!==443){i=`${r}://${e.hostname}:${e.port}${e.path}`}if(typeof e.transformWsUrl==="function"){i=e.transformWsUrl(i,e,t)}return i}function bindEventHandler(){if(c)return;c=true;a.onSocketOpen((()=>{u.setReadable(l);u.setWritable(l);u.emit("connect")}));a.onSocketMessage((e=>{if(typeof e.data==="string"){const t=n.Buffer.from(e.data,"base64");l.push(t)}else{const t=new FileReader;t.addEventListener("load",(()=>{let e=t.result;if(e instanceof ArrayBuffer)e=n.Buffer.from(e);else e=n.Buffer.from(e,"utf8");l.push(e)}));t.readAsArrayBuffer(e.data)}}));a.onSocketClose((()=>{u.end();u.destroy()}));a.onSocketError((e=>{u.destroy(e)}))}const buildStream=(e,t)=>{t.hostname=t.hostname||t.host;if(!t.hostname){throw new Error("Could not determine host. Specify host manually.")}const r=t.protocolId==="MQIsdp"&&t.protocolVersion===3?"mqttv3.1":"mqtt";setDefaultOpts(t);const i=buildUrl(t,e);a=t.my;a.connectSocket({url:i,protocols:r});l=buildProxy();u=o.default.obj();bindEventHandler();return u};t["default"]=buildStream},8264:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.connectAsync=void 0;const n=i(r(6248));const s=i(r(7310));const o=i(r(8935));const a=i(r(5069));const l=(0,n.default)("mqttjs");const u={};if(!a.default){u.mqtt=r(1424)["default"];u.tcp=r(1424)["default"];u.ssl=r(8872)["default"];u.tls=u.ssl;u.mqtts=r(8872)["default"]}else{u.wx=r(6082)["default"];u.wxs=r(6082)["default"];u.ali=r(2790)["default"];u.alis=r(2790)["default"]}u.ws=r(9387)["default"];u.wss=r(9387)["default"];function parseAuthOptions(e){let t;if(e.auth){t=e.auth.match(/^(.+):(.+)$/);if(t){e.username=t[1];e.password=t[2]}else{e.username=e.auth}}}function connect(e,t){l("connecting to an MQTT broker...");if(typeof e==="object"&&!t){t=e;e=""}t=t||{};if(e&&typeof e==="string"){const r=s.default.parse(e,true);if(r.port!=null){r.port=Number(r.port)}t=Object.assign(Object.assign({},r),t);if(t.protocol===null){throw new Error("Missing protocol")}t.protocol=t.protocol.replace(/:$/,"")}parseAuthOptions(t);if(t.query&&typeof t.query.clientId==="string"){t.clientId=t.query.clientId}if(t.cert&&t.key){if(t.protocol){if(["mqtts","wss","wxs","alis"].indexOf(t.protocol)===-1){switch(t.protocol){case"mqtt":t.protocol="mqtts";break;case"ws":t.protocol="wss";break;case"wx":t.protocol="wxs";break;case"ali":t.protocol="alis";break;default:throw new Error(`Unknown protocol for secure connection: "${t.protocol}"!`)}}}else{throw new Error("Missing secure protocol key")}}if(!u[t.protocol]){const e=["mqtts","wss"].indexOf(t.protocol)!==-1;t.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter(((t,r)=>{if(e&&r%2===0){return false}return typeof u[t]==="function"}))[0]}if(t.clean===false&&!t.clientId){throw new Error("Missing clientId for unclean clients")}if(t.protocol){t.defaultProtocol=t.protocol}function wrapper(e){if(t.servers){if(!e._reconnectCount||e._reconnectCount===t.servers.length){e._reconnectCount=0}t.host=t.servers[e._reconnectCount].host;t.port=t.servers[e._reconnectCount].port;t.protocol=!t.servers[e._reconnectCount].protocol?t.defaultProtocol:t.servers[e._reconnectCount].protocol;t.hostname=t.host;e._reconnectCount++}l("calling streambuilder for",t.protocol);return u[t.protocol](e,t)}const r=new o.default(wrapper,t);r.on("error",(()=>{}));return r}function connectAsync(e,t,r=true){return new Promise(((i,n)=>{const s=connect(e,t);const o={connect:e=>{removePromiseResolutionListeners();i(s)},end:()=>{removePromiseResolutionListeners();i(s)},error:e=>{removePromiseResolutionListeners();s.end();n(e)}};if(r===false){o.close=()=>{o.error(new Error("Couldn't connect to server"))}}function removePromiseResolutionListeners(){Object.keys(o).forEach((e=>{s.off(e,o[e])}))}Object.keys(o).forEach((e=>{s.on(e,o[e])}))}))}t.connectAsync=connectAsync;t["default"]=connect},1424:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const n=i(r(1808));const s=i(r(6248));const o=(0,s.default)("mqttjs:tcp");const buildStream=(e,t)=>{t.port=t.port||1883;t.hostname=t.hostname||t.host||"localhost";const{port:r}=t;const i=t.hostname;o("port %d and host %s",r,i);return n.default.createConnection(r,i)};t["default"]=buildStream},8872:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const n=i(r(4404));const s=i(r(1808));const o=i(r(6248));const a=(0,o.default)("mqttjs:tls");const buildStream=(e,t)=>{t.port=t.port||8883;t.host=t.hostname||t.host||"localhost";if(s.default.isIP(t.host)===0){t.servername=t.host}t.rejectUnauthorized=t.rejectUnauthorized!==false;delete t.path;a("port %d host %s rejectUnauthorized %b",t.port,t.host,t.rejectUnauthorized);const r=n.default.connect(t);r.on("secureConnect",(()=>{if(t.rejectUnauthorized&&!r.authorized){r.emit("error",new Error("TLS not authorized"))}else{r.removeListener("error",handleTLSerrors)}}));function handleTLSerrors(i){if(t.rejectUnauthorized){e.emit("error",i)}r.end()}r.on("error",handleTLSerrors);return r};t["default"]=buildStream},9387:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const n=r(4300);const s=i(r(4636));const o=i(r(6248));const a=i(r(9499));const l=r(9943);const u=i(r(5069));const c=(0,o.default)("mqttjs:ws");const h=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];function buildUrl(e,t){let r=`${e.protocol}://${e.hostname}:${e.port}${e.path}`;if(typeof e.transformWsUrl==="function"){r=e.transformWsUrl(r,e,t)}return r}function setDefaultOpts(e){const t=e;if(!e.hostname){t.hostname="localhost"}if(!e.port){if(e.protocol==="wss"){t.port=443}else{t.port=80}}if(!e.path){t.path="/"}if(!e.wsOptions){t.wsOptions={}}if(!u.default&&e.protocol==="wss"){h.forEach((r=>{if(Object.prototype.hasOwnProperty.call(e,r)&&!Object.prototype.hasOwnProperty.call(e.wsOptions,r)){t.wsOptions[r]=e[r]}}))}return t}function setDefaultBrowserOpts(e){const t=setDefaultOpts(e);if(!t.hostname){t.hostname=t.host}if(!t.hostname){if(typeof document==="undefined"){throw new Error("Could not determine host. Specify host manually.")}const e=new URL(document.URL);t.hostname=e.hostname;if(!t.port){t.port=Number(e.port)}}if(t.objectMode===undefined){t.objectMode=!(t.binary===true||t.binary===undefined)}return t}function createWebSocket(e,t,r){c("createWebSocket");c(`protocol: ${r.protocolId} ${r.protocolVersion}`);const i=r.protocolId==="MQIsdp"&&r.protocolVersion===3?"mqttv3.1":"mqtt";c(`creating new Websocket for url: ${t} and protocol: ${i}`);const n=new s.default(t,[i],r.wsOptions);return n}function createBrowserWebSocket(e,t){const r=t.protocolId==="MQIsdp"&&t.protocolVersion===3?"mqttv3.1":"mqtt";const i=buildUrl(t,e);const n=new WebSocket(i,[r]);n.binaryType="arraybuffer";return n}const streamBuilder=(e,t)=>{c("streamBuilder");const r=setDefaultOpts(t);const i=buildUrl(r,e);const n=createWebSocket(e,i,r);const o=s.default.createWebSocketStream(n,r.wsOptions);o["url"]=i;n.on("close",(()=>{o.destroy()}));return o};const browserStreamBuilder=(e,t)=>{c("browserStreamBuilder");let r;const i=setDefaultBrowserOpts(t);const s=i.browserBufferSize||1024*512;const o=t.browserBufferTimeout||1e3;const u=!t.objectMode;const h=createBrowserWebSocket(e,t);const d=buildProxy(t,socketWriteBrowser,socketEndBrowser);if(!t.objectMode){d._writev=writev}d.on("close",(()=>{h.close()}));const p=typeof h.addEventListener!=="undefined";if(h.readyState===h.OPEN){r=d}else{r=(0,a.default)(undefined,undefined,t);if(!t.objectMode){r._writev=writev}if(p){h.addEventListener("open",onOpen)}else{h.onopen=onOpen}}r.socket=h;if(p){h.addEventListener("close",onClose);h.addEventListener("error",onError);h.addEventListener("message",onMessage)}else{h.onclose=onClose;h.onerror=onError;h.onmessage=onMessage}function buildProxy(e,t,r){const i=new l.Transform({objectMode:e.objectMode});i._write=t;i._flush=r;return i}function onOpen(){r.setReadable(d);r.setWritable(d);r.emit("connect")}function onClose(){r.end();r.destroy()}function onError(e){r.destroy(e)}function onMessage(e){let{data:t}=e;if(t instanceof ArrayBuffer)t=n.Buffer.from(t);else t=n.Buffer.from(t,"utf8");d.push(t)}function writev(e,t){const r=new Array(e.length);for(let t=0;t<e.length;t++){if(typeof e[t].chunk==="string"){r[t]=n.Buffer.from(e[t],"utf8")}else{r[t]=e[t].chunk}}this._write(n.Buffer.concat(r),"binary",t)}function socketWriteBrowser(e,t,r){if(h.bufferedAmount>s){setTimeout(socketWriteBrowser,o,e,t,r)}if(u&&typeof e==="string"){e=n.Buffer.from(e,"utf8")}try{h.send(e)}catch(e){return r(e)}r()}function socketEndBrowser(e){h.close();e()}return r};t["default"]=u.default?browserStreamBuilder:streamBuilder},6082:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const n=r(4300);const s=r(9943);const o=i(r(9499));let a;let l;let u;function buildProxy(){const e=new s.Transform;e._write=(e,t,r)=>{a.send({data:e.buffer,success(){r()},fail(e){r(new Error(e))}})};e._flush=e=>{a.close({success(){e()}})};return e}function setDefaultOpts(e){if(!e.hostname){e.hostname="localhost"}if(!e.path){e.path="/"}if(!e.wsOptions){e.wsOptions={}}}function buildUrl(e,t){const r=e.protocol==="wxs"?"wss":"ws";let i=`${r}://${e.hostname}${e.path}`;if(e.port&&e.port!==80&&e.port!==443){i=`${r}://${e.hostname}:${e.port}${e.path}`}if(typeof e.transformWsUrl==="function"){i=e.transformWsUrl(i,e,t)}return i}function bindEventHandler(){a.onOpen((()=>{u.setReadable(l);u.setWritable(l);u.emit("connect")}));a.onMessage((e=>{let{data:t}=e;if(t instanceof ArrayBuffer)t=n.Buffer.from(t);else t=n.Buffer.from(t,"utf8");l.push(t)}));a.onClose((()=>{u.emit("close");u.end();u.destroy()}));a.onError((e=>{u.destroy(new Error(e.errMsg))}))}const buildStream=(e,t)=>{t.hostname=t.hostname||t.host;if(!t.hostname){throw new Error("Could not determine host. Specify host manually.")}const r=t.protocolId==="MQIsdp"&&t.protocolVersion===3?"mqttv3.1":"mqtt";setDefaultOpts(t);const i=buildUrl(t,e);a=wx.connectSocket({url:i,protocols:[r]});l=buildProxy();u=o.default.obj();u._destroy=(e,t)=>{a.close({success(){if(t)t(e)}})};const n=u.destroy;u.destroy=()=>{u.destroy=n;setTimeout((()=>{a.close({fail(){u._destroy(new Error)}})}),0)};bindEventHandler();return u};t["default"]=buildStream},5629:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});class DefaultMessageIdProvider{constructor(){this.nextId=Math.max(1,Math.floor(Math.random()*65535))}allocate(){const e=this.nextId++;if(this.nextId===65536){this.nextId=1}return e}getLastAllocated(){return this.nextId===1?65535:this.nextId-1}register(e){return true}deallocate(e){}clear(){}}t["default"]=DefaultMessageIdProvider},553:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ReasonCodes=void 0;t.ReasonCodes={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};const handleAck=(e,r)=>{const{messageId:i}=r;const n=r.cmd;let s=null;const o=e.outgoing[i]?e.outgoing[i].cb:null;let a;if(!o){e.log("_handleAck :: Server sent an ack in error. Ignoring.");return}e.log("_handleAck :: packet type",n);switch(n){case"pubcomp":case"puback":{const n=r.reasonCode;if(n&&n>0&&n!==16){a=new Error(`Publish error: ${t.ReasonCodes[n]}`);a.code=n;e["_removeOutgoingAndStoreMessage"](i,(()=>{o(a,r)}))}else{e["_removeOutgoingAndStoreMessage"](i,o)}break}case"pubrec":{s={cmd:"pubrel",qos:2,messageId:i};const n=r.reasonCode;if(n&&n>0&&n!==16){a=new Error(`Publish error: ${t.ReasonCodes[n]}`);a.code=n;e["_removeOutgoingAndStoreMessage"](i,(()=>{o(a,r)}))}else{e["_sendPacket"](s)}break}case"suback":{delete e.outgoing[i];e.messageIdProvider.deallocate(i);const t=r.granted;for(let r=0;r<t.length;r++){if((t[r]&128)!==0){const t=e.messageIdToTopic[i];if(t){t.forEach((t=>{delete e["_resubscribeTopics"][t]}))}}}delete e.messageIdToTopic[i];e["_invokeStoreProcessingQueue"]();o(null,r);break}case"unsuback":{delete e.outgoing[i];e.messageIdProvider.deallocate(i);e["_invokeStoreProcessingQueue"]();o(null);break}default:e.emit("error",new Error("unrecognized packet type"))}if(e.disconnecting&&Object.keys(e.outgoing).length===0){e.emit("outgoingEmpty")}};t["default"]=handleAck},5390:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const i=r(6849);const n=r(553);const handleAuth=(e,t)=>{const{options:r}=e;const s=r.protocolVersion;const o=s===5?t.reasonCode:t.returnCode;if(s!==5){const t=new i.ErrorWithReasonCode(`Protocol error: Auth packets are only supported in MQTT 5. Your version:${s}`,o);e.emit("error",t);return}e.handleAuth(t,((t,r)=>{if(t){e.emit("error",t);return}if(o===24){e.reconnecting=false;e["_sendPacket"](r)}else{const t=new i.ErrorWithReasonCode(`Connection refused: ${n.ReasonCodes[o]}`,o);e.emit("error",t)}}))};t["default"]=handleAuth},6106:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const n=r(553);const s=i(r(3300));const o=r(6849);const handleConnack=(e,t)=>{e.log("_handleConnack");const{options:r}=e;const i=r.protocolVersion;const a=i===5?t.reasonCode:t.returnCode;clearTimeout(e["connackTimer"]);delete e["topicAliasSend"];if(t.properties){if(t.properties.topicAliasMaximum){if(t.properties.topicAliasMaximum>65535){e.emit("error",new Error("topicAliasMaximum from broker is out of range"));return}if(t.properties.topicAliasMaximum>0){e["topicAliasSend"]=new s.default(t.properties.topicAliasMaximum)}}if(t.properties.serverKeepAlive&&r.keepalive){r.keepalive=t.properties.serverKeepAlive;e["_shiftPingInterval"]()}if(t.properties.maximumPacketSize){if(!r.properties){r.properties={}}r.properties.maximumPacketSize=t.properties.maximumPacketSize}}if(a===0){e.reconnecting=false;e["_onConnect"](t)}else if(a>0){const t=new o.ErrorWithReasonCode(`Connection refused: ${n.ReasonCodes[a]}`,a);e.emit("error",t)}};t["default"]=handleConnack},127:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const n=i(r(7898));const s=i(r(5390));const o=i(r(6106));const a=i(r(553));const l=i(r(6218));const handle=(e,t,r)=>{const{options:i}=e;if(i.protocolVersion===5&&i.properties&&i.properties.maximumPacketSize&&i.properties.maximumPacketSize<t.length){e.emit("error",new Error(`exceeding packets size ${t.cmd}`));e.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}});return e}e.log("_handlePacket :: emitting packetreceive");e.emit("packetreceive",t);switch(t.cmd){case"publish":(0,n.default)(e,t,r);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":(0,a.default)(e,t);r();break;case"pubrel":(0,l.default)(e,t,r);break;case"connack":(0,o.default)(e,t);r();break;case"auth":(0,s.default)(e,t);r();break;case"pingresp":e.pingResp=true;r();break;case"disconnect":e.emit("disconnect",t);r();break;default:e.log("_handlePacket :: unknown command");r();break}};t["default"]=handle},7898:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const r=[0,16,128,131,135,144,145,151,153];const handlePublish=(e,t,i)=>{e.log("handlePublish: packet %o",t);i=typeof i!=="undefined"?i:e.noop;let n=t.topic.toString();const s=t.payload;const{qos:o}=t;const{messageId:a}=t;const{options:l}=e;if(e.options.protocolVersion===5){let r;if(t.properties){r=t.properties.topicAlias}if(typeof r!=="undefined"){if(n.length===0){if(r>0&&r<=65535){const t=e["topicAliasRecv"].getTopicByAlias(r);if(t){n=t;e.log("handlePublish :: topic complemented by alias. topic: %s - alias: %d",n,r)}else{e.log("handlePublish :: unregistered topic alias. alias: %d",r);e.emit("error",new Error("Received unregistered Topic Alias"));return}}else{e.log("handlePublish :: topic alias out of range. alias: %d",r);e.emit("error",new Error("Received Topic Alias is out of range"));return}}else if(e["topicAliasRecv"].put(n,r)){e.log("handlePublish :: registered topic: %s - alias: %d",n,r)}else{e.log("handlePublish :: topic alias out of range. alias: %d",r);e.emit("error",new Error("Received Topic Alias is out of range"));return}}}e.log("handlePublish: qos %d",o);switch(o){case 2:{l.customHandleAcks(n,s,t,((n,s)=>{if(typeof n==="number"){s=n;n=null}if(n){return e.emit("error",n)}if(r.indexOf(s)===-1){return e.emit("error",new Error("Wrong reason code for pubrec"))}if(s){e["_sendPacket"]({cmd:"pubrec",messageId:a,reasonCode:s},i)}else{e.incomingStore.put(t,(()=>{e["_sendPacket"]({cmd:"pubrec",messageId:a},i)}))}}));break}case 1:{l.customHandleAcks(n,s,t,((o,l)=>{if(typeof o==="number"){l=o;o=null}if(o){return e.emit("error",o)}if(r.indexOf(l)===-1){return e.emit("error",new Error("Wrong reason code for puback"))}if(!l){e.emit("message",n,s,t)}e.handleMessage(t,(t=>{if(t){return i&&i(t)}e["_sendPacket"]({cmd:"puback",messageId:a,reasonCode:l},i)}))}));break}case 0:e.emit("message",n,s,t);e.handleMessage(t,i);break;default:e.log("handlePublish: unknown QoS. Doing nothing.");break}};t["default"]=handlePublish},6218:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const handlePubrel=(e,t,r)=>{e.log("handling pubrel packet");const i=typeof r!=="undefined"?r:e.noop;const{messageId:n}=t;const s={cmd:"pubcomp",messageId:n};e.incomingStore.get(t,((t,r)=>{if(!t){e.emit("message",r.topic,r.payload,r);e.handleMessage(r,(t=>{if(t){return i(t)}e.incomingStore.del(r,e.noop);e["_sendPacket"](s,i)}))}else{e["_sendPacket"](s,i)}}))};t["default"]=handlePubrel},5069:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const r=typeof window!=="undefined"&&typeof window.document!=="undefined";t["default"]=r},6849:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.applyMixin=t.ErrorWithReasonCode=void 0;class ErrorWithReasonCode extends Error{constructor(e,t){super(e);this.code=t;Object.setPrototypeOf(this,ErrorWithReasonCode.prototype);Object.getPrototypeOf(this).name="ErrorWithReasonCode"}}t.ErrorWithReasonCode=ErrorWithReasonCode;function applyMixin(e,t,r=false){var i;const n=[t];while(true){const e=n[0];const t=Object.getPrototypeOf(e);if(t===null||t===void 0?void 0:t.prototype){n.unshift(t)}else{break}}for(const t of n){for(const n of Object.getOwnPropertyNames(t.prototype)){if(r||n!=="constructor"){Object.defineProperty(e.prototype,n,(i=Object.getOwnPropertyDescriptor(t.prototype,n))!==null&&i!==void 0?i:Object.create(null))}}}}t.applyMixin=applyMixin},7212:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const i=r(9943);const n={objectMode:true};const s={clean:true};class Store{constructor(e){this.options=e||{};this.options=Object.assign(Object.assign({},s),e);this._inflights=new Map}put(e,t){this._inflights.set(e.messageId,e);if(t){t()}return this}createStream(){const e=new i.Readable(n);const t=[];let r=false;let s=0;this._inflights.forEach(((e,r)=>{t.push(e)}));e._read=()=>{if(!r&&s<t.length){e.push(t[s++])}else{e.push(null)}};e.destroy=t=>{if(r){return}r=true;setTimeout((()=>{e.emit("close")}),0);return e};return e}del(e,t){const r=this._inflights.get(e.messageId);if(r){this._inflights.delete(e.messageId);t(null,r)}else if(t){t(new Error("missing packet"))}return this}get(e,t){const r=this._inflights.get(e.messageId);if(r){t(null,r)}else if(t){t(new Error("missing packet"))}return this}close(e){if(this.options.clean){this._inflights=null}if(e){e()}}}t["default"]=Store},1419:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});class TopicAliasRecv{constructor(e){this.aliasToTopic={};this.max=e}put(e,t){if(t===0||t>this.max){return false}this.aliasToTopic[t]=e;this.length=Object.keys(this.aliasToTopic).length;return true}getTopicByAlias(e){return this.aliasToTopic[e]}clear(){this.aliasToTopic={}}}t["default"]=TopicAliasRecv},3300:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const n=i(r(5393));const s=r(1543);class TopicAliasSend{constructor(e){if(e>0){this.aliasToTopic=new n.default({max:e});this.topicToAlias={};this.numberAllocator=new s.NumberAllocator(1,e);this.max=e;this.length=0}}put(e,t){if(t===0||t>this.max){return false}const r=this.aliasToTopic.get(t);if(r){delete this.topicToAlias[r]}this.aliasToTopic.set(t,e);this.topicToAlias[e]=t;this.numberAllocator.use(t);this.length=this.aliasToTopic.size;return true}getTopicByAlias(e){return this.aliasToTopic.get(e)}getAliasByTopic(e){const t=this.topicToAlias[e];if(typeof t!=="undefined"){this.aliasToTopic.get(t)}return t}clear(){this.aliasToTopic.clear();this.topicToAlias={};this.numberAllocator.clear();this.length=0}getLruAlias(){const e=this.numberAllocator.firstVacant();if(e)return e;return[...this.aliasToTopic.keys()][this.aliasToTopic.size-1]}}t["default"]=TopicAliasSend},2274:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const i=r(1543);class UniqueMessageIdProvider{constructor(){this.numberAllocator=new i.NumberAllocator(1,65535)}allocate(){this.lastId=this.numberAllocator.alloc();return this.lastId}getLastAllocated(){return this.lastId}register(e){return this.numberAllocator.use(e)}deallocate(e){this.numberAllocator.free(e)}clear(){this.numberAllocator.clear()}}t["default"]=UniqueMessageIdProvider},1386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.validateTopics=t.validateTopic=void 0;function validateTopic(e){const t=e.split("/");for(let e=0;e<t.length;e++){if(t[e]==="+"){continue}if(t[e]==="#"){return e===t.length-1}if(t[e].indexOf("+")!==-1||t[e].indexOf("#")!==-1){return false}}return true}t.validateTopic=validateTopic;function validateTopics(e){if(e.length===0){return"empty_topic_list"}for(let t=0;t<e.length;t++){if(!validateTopic(e[t])){return e[t]}}return null}t.validateTopics=validateTopics},6208:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){if(i===undefined)i=r;var n=Object.getOwnPropertyDescriptor(t,r);if(!n||("get"in n?!t.__esModule:n.writable||n.configurable)){n={enumerable:true,get:function(){return t[r]}}}Object.defineProperty(e,i,n)}:function(e,t,r,i){if(i===undefined)i=r;e[i]=t[r]});var n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(r!=="default"&&Object.prototype.hasOwnProperty.call(e,r))i(t,e,r);n(t,e);return t};var o=this&&this.__exportStar||function(e,t){for(var r in e)if(r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r))i(t,e,r)};var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.ReasonCodes=t.UniqueMessageIdProvider=t.DefaultMessageIdProvider=t.Store=t.MqttClient=t.connectAsync=t.connect=t.Client=void 0;const l=a(r(8935));t.MqttClient=l.default;const u=a(r(5629));t.DefaultMessageIdProvider=u.default;const c=a(r(2274));t.UniqueMessageIdProvider=c.default;const h=a(r(7212));t.Store=h.default;const d=s(r(8264));t.connect=d.default;Object.defineProperty(t,"connectAsync",{enumerable:true,get:function(){return d.connectAsync}});t.Client=l.default;o(r(8935),t);o(r(6849),t);var p=r(553);Object.defineProperty(t,"ReasonCodes",{enumerable:true,get:function(){return p.ReasonCodes}})},6364:(e,t,r)=>{"use strict";const{AbortError:i,codes:n}=r(3304);const{isNodeStream:s,isWebStream:o,kControllerErrorFunction:a}=r(1089);const l=r(7463);const{ERR_INVALID_ARG_TYPE:u}=n;const validateAbortSignal=(e,t)=>{if(typeof e!=="object"||!("aborted"in e)){throw new u(t,"AbortSignal",e)}};e.exports.addAbortSignal=function addAbortSignal(t,r){validateAbortSignal(t,"signal");if(!s(r)&&!o(r)){throw new u("stream",["ReadableStream","WritableStream","Stream"],r)}return e.exports.addAbortSignalNoValidate(t,r)};e.exports.addAbortSignalNoValidate=function(e,t){if(typeof e!=="object"||!("aborted"in e)){return t}const r=s(t)?()=>{t.destroy(new i(undefined,{cause:e.reason}))}:()=>{t[a](new i(undefined,{cause:e.reason}))};if(e.aborted){r()}else{e.addEventListener("abort",r);l(t,(()=>e.removeEventListener("abort",r)))}return t}},9471:(e,t,r)=>{"use strict";const{StringPrototypeSlice:i,SymbolIterator:n,TypedArrayPrototypeSet:s,Uint8Array:o}=r(7086);const{Buffer:a}=r(4300);const{inspect:l}=r(6911);e.exports=class BufferList{constructor(){this.head=null;this.tail=null;this.length=0}push(e){const t={data:e,next:null};if(this.length>0)this.tail.next=t;else this.head=t;this.tail=t;++this.length}unshift(e){const t={data:e,next:this.head};if(this.length===0)this.tail=t;this.head=t;++this.length}shift(){if(this.length===0)return;const e=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return e}clear(){this.head=this.tail=null;this.length=0}join(e){if(this.length===0)return"";let t=this.head;let r=""+t.data;while((t=t.next)!==null)r+=e+t.data;return r}concat(e){if(this.length===0)return a.alloc(0);const t=a.allocUnsafe(e>>>0);let r=this.head;let i=0;while(r){s(t,r.data,i);i+=r.data.length;r=r.next}return t}consume(e,t){const r=this.head.data;if(e<r.length){const t=r.slice(0,e);this.head.data=r.slice(e);return t}if(e===r.length){return this.shift()}return t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[n](){for(let e=this.head;e;e=e.next){yield e.data}}_getString(e){let t="";let r=this.head;let n=0;do{const s=r.data;if(e>s.length){t+=s;e-=s.length}else{if(e===s.length){t+=s;++n;if(r.next)this.head=r.next;else this.head=this.tail=null}else{t+=i(s,0,e);this.head=r;r.data=i(s,e)}break}++n}while((r=r.next)!==null);this.length-=n;return t}_getBuffer(e){const t=a.allocUnsafe(e);const r=e;let i=this.head;let n=0;do{const a=i.data;if(e>a.length){s(t,a,r-e);e-=a.length}else{if(e===a.length){s(t,a,r-e);++n;if(i.next)this.head=i.next;else this.head=this.tail=null}else{s(t,new o(a.buffer,a.byteOffset,e),r-e);this.head=i;i.data=a.slice(e)}break}++n}while((i=i.next)!==null);this.length-=n;return t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return l(this,{...t,depth:0,customInspect:false})}}},242:(e,t,r)=>{"use strict";const{pipeline:i}=r(5759);const n=r(7545);const{destroyer:s}=r(6693);const{isNodeStream:o,isReadable:a,isWritable:l,isWebStream:u,isTransformStream:c,isWritableStream:h,isReadableStream:d}=r(1089);const{AbortError:p,codes:{ERR_INVALID_ARG_VALUE:b,ERR_MISSING_ARGS:g}}=r(3304);const _=r(7463);e.exports=function compose(...e){if(e.length===0){throw new g("streams")}if(e.length===1){return n.from(e[0])}const t=[...e];if(typeof e[0]==="function"){e[0]=n.from(e[0])}if(typeof e[e.length-1]==="function"){const t=e.length-1;e[t]=n.from(e[t])}for(let r=0;r<e.length;++r){if(!o(e[r])&&!u(e[r])){continue}if(r<e.length-1&&!(a(e[r])||d(e[r])||c(e[r]))){throw new b(`streams[${r}]`,t[r],"must be readable")}if(r>0&&!(l(e[r])||h(e[r])||c(e[r]))){throw new b(`streams[${r}]`,t[r],"must be writable")}}let r;let m;let y;let w;let S;function onfinished(e){const t=w;w=null;if(t){t(e)}else if(e){S.destroy(e)}else if(!R&&!T){S.destroy()}}const v=e[0];const k=i(e,onfinished);const T=!!(l(v)||h(v)||c(v));const R=!!(a(k)||d(k)||c(k));S=new n({writableObjectMode:!!(v!==null&&v!==undefined&&v.writableObjectMode),readableObjectMode:!!(k!==null&&k!==undefined&&k.writableObjectMode),writable:T,readable:R});if(T){if(o(v)){S._write=function(e,t,i){if(v.write(e,t)){i()}else{r=i}};S._final=function(e){v.end();m=e};v.on("drain",(function(){if(r){const e=r;r=null;e()}}))}else if(u(v)){const e=c(v)?v.writable:v;const t=e.getWriter();S._write=async function(e,r,i){try{await t.ready;t.write(e).catch((()=>{}));i()}catch(e){i(e)}};S._final=async function(e){try{await t.ready;t.close().catch((()=>{}));m=e}catch(t){e(t)}}}const e=c(k)?k.readable:k;_(e,(()=>{if(m){const e=m;m=null;e()}}))}if(R){if(o(k)){k.on("readable",(function(){if(y){const e=y;y=null;e()}}));k.on("end",(function(){S.push(null)}));S._read=function(){while(true){const e=k.read();if(e===null){y=S._read;return}if(!S.push(e)){return}}}}else if(u(k)){const e=c(k)?k.readable:k;const t=e.getReader();S._read=async function(){while(true){try{const{value:e,done:r}=await t.read();if(!S.push(e)){return}if(r){S.push(null);return}}catch{return}}}}}S._destroy=function(e,t){if(!e&&w!==null){e=new p}y=null;r=null;m=null;if(w===null){t(e)}else{w=t;if(o(k)){s(k,e)}}};return S}},6693:(e,t,r)=>{"use strict";const i=r(9929);const{aggregateTwoErrors:n,codes:{ERR_MULTIPLE_CALLBACK:s},AbortError:o}=r(3304);const{Symbol:a}=r(7086);const{kDestroyed:l,isDestroyed:u,isFinished:c,isServerRequest:h}=r(1089);const d=a("kDestroy");const p=a("kConstruct");function checkError(e,t,r){if(e){e.stack;if(t&&!t.errored){t.errored=e}if(r&&!r.errored){r.errored=e}}}function destroy(e,t){const r=this._readableState;const i=this._writableState;const s=i||r;if(i!==null&&i!==undefined&&i.destroyed||r!==null&&r!==undefined&&r.destroyed){if(typeof t==="function"){t()}return this}checkError(e,i,r);if(i){i.destroyed=true}if(r){r.destroyed=true}if(!s.constructed){this.once(d,(function(r){_destroy(this,n(r,e),t)}))}else{_destroy(this,e,t)}return this}function _destroy(e,t,r){let n=false;function onDestroy(t){if(n){return}n=true;const s=e._readableState;const o=e._writableState;checkError(t,o,s);if(o){o.closed=true}if(s){s.closed=true}if(typeof r==="function"){r(t)}if(t){i.nextTick(emitErrorCloseNT,e,t)}else{i.nextTick(emitCloseNT,e)}}try{e._destroy(t||null,onDestroy)}catch(t){onDestroy(t)}}function emitErrorCloseNT(e,t){emitErrorNT(e,t);emitCloseNT(e)}function emitCloseNT(e){const t=e._readableState;const r=e._writableState;if(r){r.closeEmitted=true}if(t){t.closeEmitted=true}if(r!==null&&r!==undefined&&r.emitClose||t!==null&&t!==undefined&&t.emitClose){e.emit("close")}}function emitErrorNT(e,t){const r=e._readableState;const i=e._writableState;if(i!==null&&i!==undefined&&i.errorEmitted||r!==null&&r!==undefined&&r.errorEmitted){return}if(i){i.errorEmitted=true}if(r){r.errorEmitted=true}e.emit("error",t)}function undestroy(){const e=this._readableState;const t=this._writableState;if(e){e.constructed=true;e.closed=false;e.closeEmitted=false;e.destroyed=false;e.errored=null;e.errorEmitted=false;e.reading=false;e.ended=e.readable===false;e.endEmitted=e.readable===false}if(t){t.constructed=true;t.destroyed=false;t.closed=false;t.closeEmitted=false;t.errored=null;t.errorEmitted=false;t.finalCalled=false;t.prefinished=false;t.ended=t.writable===false;t.ending=t.writable===false;t.finished=t.writable===false}}function errorOrDestroy(e,t,r){const n=e._readableState;const s=e._writableState;if(s!==null&&s!==undefined&&s.destroyed||n!==null&&n!==undefined&&n.destroyed){return this}if(n!==null&&n!==undefined&&n.autoDestroy||s!==null&&s!==undefined&&s.autoDestroy)e.destroy(t);else if(t){t.stack;if(s&&!s.errored){s.errored=t}if(n&&!n.errored){n.errored=t}if(r){i.nextTick(emitErrorNT,e,t)}else{emitErrorNT(e,t)}}}function construct(e,t){if(typeof e._construct!=="function"){return}const r=e._readableState;const n=e._writableState;if(r){r.constructed=false}if(n){n.constructed=false}e.once(p,t);if(e.listenerCount(p)>1){return}i.nextTick(constructNT,e)}function constructNT(e){let t=false;function onConstruct(r){if(t){errorOrDestroy(e,r!==null&&r!==undefined?r:new s);return}t=true;const n=e._readableState;const o=e._writableState;const a=o||n;if(n){n.constructed=true}if(o){o.constructed=true}if(a.destroyed){e.emit(d,r)}else if(r){errorOrDestroy(e,r,true)}else{i.nextTick(emitConstructNT,e)}}try{e._construct((e=>{i.nextTick(onConstruct,e)}))}catch(e){i.nextTick(onConstruct,e)}}function emitConstructNT(e){e.emit(p)}function isRequest(e){return(e===null||e===undefined?undefined:e.setHeader)&&typeof e.abort==="function"}function emitCloseLegacy(e){e.emit("close")}function emitErrorCloseLegacy(e,t){e.emit("error",t);i.nextTick(emitCloseLegacy,e)}function destroyer(e,t){if(!e||u(e)){return}if(!t&&!c(e)){t=new o}if(h(e)){e.socket=null;e.destroy(t)}else if(isRequest(e)){e.abort()}else if(isRequest(e.req)){e.req.abort()}else if(typeof e.destroy==="function"){e.destroy(t)}else if(typeof e.close==="function"){e.close()}else if(t){i.nextTick(emitErrorCloseLegacy,e,t)}else{i.nextTick(emitCloseLegacy,e)}if(!e.destroyed){e[l]=true}}e.exports={construct:construct,destroyer:destroyer,destroy:destroy,undestroy:undestroy,errorOrDestroy:errorOrDestroy}},7545:(e,t,r)=>{"use strict";const{ObjectDefineProperties:i,ObjectGetOwnPropertyDescriptor:n,ObjectKeys:s,ObjectSetPrototypeOf:o}=r(7086);e.exports=Duplex;const a=r(2159);const l=r(7649);o(Duplex.prototype,a.prototype);o(Duplex,a);{const e=s(l.prototype);for(let t=0;t<e.length;t++){const r=e[t];if(!Duplex.prototype[r])Duplex.prototype[r]=l.prototype[r]}}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);a.call(this,e);l.call(this,e);if(e){this.allowHalfOpen=e.allowHalfOpen!==false;if(e.readable===false){this._readableState.readable=false;this._readableState.ended=true;this._readableState.endEmitted=true}if(e.writable===false){this._writableState.writable=false;this._writableState.ending=true;this._writableState.ended=true;this._writableState.finished=true}}else{this.allowHalfOpen=true}}i(Duplex.prototype,{writable:{__proto__:null,...n(l.prototype,"writable")},writableHighWaterMark:{__proto__:null,...n(l.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...n(l.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...n(l.prototype,"writableBuffer")},writableLength:{__proto__:null,...n(l.prototype,"writableLength")},writableFinished:{__proto__:null,...n(l.prototype,"writableFinished")},writableCorked:{__proto__:null,...n(l.prototype,"writableCorked")},writableEnded:{__proto__:null,...n(l.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...n(l.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){if(this._readableState===undefined||this._writableState===undefined){return false}return this._readableState.destroyed&&this._writableState.destroyed},set(e){if(this._readableState&&this._writableState){this._readableState.destroyed=e;this._writableState.destroyed=e}}}});let u;function lazyWebStreams(){if(u===undefined)u={};return u}Duplex.fromWeb=function(e,t){return lazyWebStreams().newStreamDuplexFromReadableWritablePair(e,t)};Duplex.toWeb=function(e){return lazyWebStreams().newReadableWritablePairFromDuplex(e)};let c;Duplex.from=function(e){if(!c){c=r(8022)}return c(e,"body")}},8022:(e,t,r)=>{const i=r(9929);"use strict";const n=r(4300);const{isReadable:s,isWritable:o,isIterable:a,isNodeStream:l,isReadableNodeStream:u,isWritableNodeStream:c,isDuplexNodeStream:h}=r(1089);const d=r(7463);const{AbortError:p,codes:{ERR_INVALID_ARG_TYPE:b,ERR_INVALID_RETURN_VALUE:g}}=r(3304);const{destroyer:_}=r(6693);const m=r(7545);const y=r(2159);const{createDeferredPromise:w}=r(6911);const S=r(3311);const v=globalThis.Blob||n.Blob;const k=typeof v!=="undefined"?function isBlob(e){return e instanceof v}:function isBlob(e){return false};const T=globalThis.AbortController||r(7295).AbortController;const{FunctionPrototypeCall:R}=r(7086);class Duplexify extends m{constructor(e){super(e);if((e===null||e===undefined?undefined:e.readable)===false){this._readableState.readable=false;this._readableState.ended=true;this._readableState.endEmitted=true}if((e===null||e===undefined?undefined:e.writable)===false){this._writableState.writable=false;this._writableState.ending=true;this._writableState.ended=true;this._writableState.finished=true}}}e.exports=function duplexify(e,t){if(h(e)){return e}if(u(e)){return _duplexify({readable:e})}if(c(e)){return _duplexify({writable:e})}if(l(e)){return _duplexify({writable:false,readable:false})}if(typeof e==="function"){const{value:r,write:n,final:s,destroy:o}=fromAsyncGen(e);if(a(r)){return S(Duplexify,r,{objectMode:true,write:n,final:s,destroy:o})}const l=r===null||r===undefined?undefined:r.then;if(typeof l==="function"){let e;const t=R(l,r,(e=>{if(e!=null){throw new g("nully","body",e)}}),(t=>{_(e,t)}));return e=new Duplexify({objectMode:true,readable:false,write:n,final(e){s((async()=>{try{await t;i.nextTick(e,null)}catch(t){i.nextTick(e,t)}}))},destroy:o})}throw new g("Iterable, AsyncIterable or AsyncFunction",t,r)}if(k(e)){return duplexify(e.arrayBuffer())}if(a(e)){return S(Duplexify,e,{objectMode:true,writable:false})}if(typeof(e===null||e===undefined?undefined:e.writable)==="object"||typeof(e===null||e===undefined?undefined:e.readable)==="object"){const t=e!==null&&e!==undefined&&e.readable?u(e===null||e===undefined?undefined:e.readable)?e===null||e===undefined?undefined:e.readable:duplexify(e.readable):undefined;const r=e!==null&&e!==undefined&&e.writable?c(e===null||e===undefined?undefined:e.writable)?e===null||e===undefined?undefined:e.writable:duplexify(e.writable):undefined;return _duplexify({readable:t,writable:r})}const r=e===null||e===undefined?undefined:e.then;if(typeof r==="function"){let t;R(r,e,(e=>{if(e!=null){t.push(e)}t.push(null)}),(e=>{_(t,e)}));return t=new Duplexify({objectMode:true,writable:false,read(){}})}throw new b(t,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],e)};function fromAsyncGen(e){let{promise:t,resolve:r}=w();const n=new T;const s=n.signal;const o=e(async function*(){while(true){const e=t;t=null;const{chunk:n,done:o,cb:a}=await e;i.nextTick(a);if(o)return;if(s.aborted)throw new p(undefined,{cause:s.reason});({promise:t,resolve:r}=w());yield n}}(),{signal:s});return{value:o,write(e,t,i){const n=r;r=null;n({chunk:e,done:false,cb:i})},final(e){const t=r;r=null;t({done:true,cb:e})},destroy(e,t){n.abort();t(e)}}}function _duplexify(e){const t=e.readable&&typeof e.readable.read!=="function"?y.wrap(e.readable):e.readable;const r=e.writable;let i=!!s(t);let n=!!o(r);let a;let l;let u;let c;let h;function onfinished(e){const t=c;c=null;if(t){t(e)}else if(e){h.destroy(e)}}h=new Duplexify({readableObjectMode:!!(t!==null&&t!==undefined&&t.readableObjectMode),writableObjectMode:!!(r!==null&&r!==undefined&&r.writableObjectMode),readable:i,writable:n});if(n){d(r,(e=>{n=false;if(e){_(t,e)}onfinished(e)}));h._write=function(e,t,i){if(r.write(e,t)){i()}else{a=i}};h._final=function(e){r.end();l=e};r.on("drain",(function(){if(a){const e=a;a=null;e()}}));r.on("finish",(function(){if(l){const e=l;l=null;e()}}))}if(i){d(t,(e=>{i=false;if(e){_(t,e)}onfinished(e)}));t.on("readable",(function(){if(u){const e=u;u=null;e()}}));t.on("end",(function(){h.push(null)}));h._read=function(){while(true){const e=t.read();if(e===null){u=h._read;return}if(!h.push(e)){return}}}}h._destroy=function(e,i){if(!e&&c!==null){e=new p}u=null;a=null;l=null;if(c===null){i(e)}else{c=i;_(r,e);_(t,e)}};return h}},7463:(e,t,r)=>{const i=r(9929);"use strict";const{AbortError:n,codes:s}=r(3304);const{ERR_INVALID_ARG_TYPE:o,ERR_STREAM_PREMATURE_CLOSE:a}=s;const{kEmptyObject:l,once:u}=r(6911);const{validateAbortSignal:c,validateFunction:h,validateObject:d,validateBoolean:p}=r(2135);const{Promise:b,PromisePrototypeThen:g}=r(7086);const{isClosed:_,isReadable:m,isReadableNodeStream:y,isReadableStream:w,isReadableFinished:S,isReadableErrored:v,isWritable:k,isWritableNodeStream:T,isWritableStream:R,isWritableFinished:A,isWritableErrored:I,isNodeStream:O,willEmitClose:x,kIsClosedPromise:C}=r(1089);function isRequest(e){return e.setHeader&&typeof e.abort==="function"}const nop=()=>{};function eos(e,t,r){var s,p;if(arguments.length===2){r=t;t=l}else if(t==null){t=l}else{d(t,"options")}h(r,"callback");c(t.signal,"options.signal");r=u(r);if(w(e)||R(e)){return eosWeb(e,t,r)}if(!O(e)){throw new o("stream",["ReadableStream","WritableStream","Stream"],e)}const b=(s=t.readable)!==null&&s!==undefined?s:y(e);const g=(p=t.writable)!==null&&p!==undefined?p:T(e);const C=e._writableState;const P=e._readableState;const onlegacyfinish=()=>{if(!e.writable){onfinish()}};let B=x(e)&&y(e)===b&&T(e)===g;let M=A(e,false);const onfinish=()=>{M=true;if(e.destroyed){B=false}if(B&&(!e.readable||b)){return}if(!b||L){r.call(e)}};let L=S(e,false);const onend=()=>{L=true;if(e.destroyed){B=false}if(B&&(!e.writable||g)){return}if(!g||M){r.call(e)}};const onerror=t=>{r.call(e,t)};let N=_(e);const onclose=()=>{N=true;const t=I(e)||v(e);if(t&&typeof t!=="boolean"){return r.call(e,t)}if(b&&!L&&y(e,true)){if(!S(e,false))return r.call(e,new a)}if(g&&!M){if(!A(e,false))return r.call(e,new a)}r.call(e)};const onclosed=()=>{N=true;const t=I(e)||v(e);if(t&&typeof t!=="boolean"){return r.call(e,t)}r.call(e)};const onrequest=()=>{e.req.on("finish",onfinish)};if(isRequest(e)){e.on("complete",onfinish);if(!B){e.on("abort",onclose)}if(e.req){onrequest()}else{e.on("request",onrequest)}}else if(g&&!C){e.on("end",onlegacyfinish);e.on("close",onlegacyfinish)}if(!B&&typeof e.aborted==="boolean"){e.on("aborted",onclose)}e.on("end",onend);e.on("finish",onfinish);if(t.error!==false){e.on("error",onerror)}e.on("close",onclose);if(N){i.nextTick(onclose)}else if(C!==null&&C!==undefined&&C.errorEmitted||P!==null&&P!==undefined&&P.errorEmitted){if(!B){i.nextTick(onclosed)}}else if(!b&&(!B||m(e))&&(M||k(e)===false)){i.nextTick(onclosed)}else if(!g&&(!B||k(e))&&(L||m(e)===false)){i.nextTick(onclosed)}else if(P&&e.req&&e.aborted){i.nextTick(onclosed)}const cleanup=()=>{r=nop;e.removeListener("aborted",onclose);e.removeListener("complete",onfinish);e.removeListener("abort",onclose);e.removeListener("request",onrequest);if(e.req)e.req.removeListener("finish",onfinish);e.removeListener("end",onlegacyfinish);e.removeListener("close",onlegacyfinish);e.removeListener("finish",onfinish);e.removeListener("end",onend);e.removeListener("error",onerror);e.removeListener("close",onclose)};if(t.signal&&!N){const abort=()=>{const i=r;cleanup();i.call(e,new n(undefined,{cause:t.signal.reason}))};if(t.signal.aborted){i.nextTick(abort)}else{const i=r;r=u(((...r)=>{t.signal.removeEventListener("abort",abort);i.apply(e,r)}));t.signal.addEventListener("abort",abort)}}return cleanup}function eosWeb(e,t,r){let s=false;let o=nop;if(t.signal){o=()=>{s=true;r.call(e,new n(undefined,{cause:t.signal.reason}))};if(t.signal.aborted){i.nextTick(o)}else{const i=r;r=u(((...r)=>{t.signal.removeEventListener("abort",o);i.apply(e,r)}));t.signal.addEventListener("abort",o)}}const resolverFn=(...t)=>{if(!s){i.nextTick((()=>r.apply(e,t)))}};g(e[C].promise,resolverFn,resolverFn);return nop}function finished(e,t){var r;let i=false;if(t===null){t=l}if((r=t)!==null&&r!==undefined&&r.cleanup){p(t.cleanup,"cleanup");i=t.cleanup}return new b(((r,n)=>{const s=eos(e,t,(e=>{if(i){s()}if(e){n(e)}else{r()}}))}))}e.exports=eos;e.exports.finished=finished},3311:(e,t,r)=>{"use strict";const i=r(9929);const{PromisePrototypeThen:n,SymbolAsyncIterator:s,SymbolIterator:o}=r(7086);const{Buffer:a}=r(4300);const{ERR_INVALID_ARG_TYPE:l,ERR_STREAM_NULL_VALUES:u}=r(3304).codes;function from(e,t,r){let c;if(typeof t==="string"||t instanceof a){return new e({objectMode:true,...r,read(){this.push(t);this.push(null)}})}let h;if(t&&t[s]){h=true;c=t[s]()}else if(t&&t[o]){h=false;c=t[o]()}else{throw new l("iterable",["Iterable"],t)}const d=new e({objectMode:true,highWaterMark:1,...r});let p=false;d._read=function(){if(!p){p=true;next()}};d._destroy=function(e,t){n(close(e),(()=>i.nextTick(t,e)),(r=>i.nextTick(t,r||e)))};async function close(e){const t=e!==undefined&&e!==null;const r=typeof c.throw==="function";if(t&&r){const{value:t,done:r}=await c.throw(e);await t;if(r){return}}if(typeof c.return==="function"){const{value:e}=await c.return();await e}}async function next(){for(;;){try{const{value:e,done:t}=h?await c.next():c.next();if(t){d.push(null)}else{const t=e&&typeof e.then==="function"?await e:e;if(t===null){p=false;throw new u}else if(d.push(t)){continue}else{p=false}}}catch(e){d.destroy(e)}break}}return d}e.exports=from},2019:(e,t,r)=>{"use strict";const{ArrayIsArray:i,ObjectSetPrototypeOf:n}=r(7086);const{EventEmitter:s}=r(2361);function Stream(e){s.call(this,e)}n(Stream.prototype,s.prototype);n(Stream,s);Stream.prototype.pipe=function(e,t){const r=this;function ondata(t){if(e.writable&&e.write(t)===false&&r.pause){r.pause()}}r.on("data",ondata);function ondrain(){if(r.readable&&r.resume){r.resume()}}e.on("drain",ondrain);if(!e._isStdio&&(!t||t.end!==false)){r.on("end",onend);r.on("close",onclose)}let i=false;function onend(){if(i)return;i=true;e.end()}function onclose(){if(i)return;i=true;if(typeof e.destroy==="function")e.destroy()}function onerror(e){cleanup();if(s.listenerCount(this,"error")===0){this.emit("error",e)}}prependListener(r,"error",onerror);prependListener(e,"error",onerror);function cleanup(){r.removeListener("data",ondata);e.removeListener("drain",ondrain);r.removeListener("end",onend);r.removeListener("close",onclose);r.removeListener("error",onerror);e.removeListener("error",onerror);r.removeListener("end",cleanup);r.removeListener("close",cleanup);e.removeListener("close",cleanup)}r.on("end",cleanup);r.on("close",cleanup);e.on("close",cleanup);e.emit("pipe",r);return e};function prependListener(e,t,r){if(typeof e.prependListener==="function")return e.prependListener(t,r);if(!e._events||!e._events[t])e.on(t,r);else if(i(e._events[t]))e._events[t].unshift(r);else e._events[t]=[r,e._events[t]]}e.exports={Stream:Stream,prependListener:prependListener}},2366:(e,t,r)=>{"use strict";const i=globalThis.AbortController||r(7295).AbortController;const{codes:{ERR_INVALID_ARG_VALUE:n,ERR_INVALID_ARG_TYPE:s,ERR_MISSING_ARGS:o,ERR_OUT_OF_RANGE:a},AbortError:l}=r(3304);const{validateAbortSignal:u,validateInteger:c,validateObject:h}=r(2135);const d=r(7086).Symbol("kWeak");const{finished:p}=r(7463);const b=r(242);const{addAbortSignalNoValidate:g}=r(6364);const{isWritable:_,isNodeStream:m}=r(1089);const{ArrayPrototypePush:y,MathFloor:w,Number:S,NumberIsNaN:v,Promise:k,PromiseReject:T,PromisePrototypeThen:R,Symbol:A}=r(7086);const I=A("kEmpty");const O=A("kEof");function compose(e,t){if(t!=null){h(t,"options")}if((t===null||t===undefined?undefined:t.signal)!=null){u(t.signal,"options.signal")}if(m(e)&&!_(e)){throw new n("stream",e,"must be writable")}const r=b(this,e);if(t!==null&&t!==undefined&&t.signal){g(t.signal,r)}return r}function map(e,t){if(typeof e!=="function"){throw new s("fn",["Function","AsyncFunction"],e)}if(t!=null){h(t,"options")}if((t===null||t===undefined?undefined:t.signal)!=null){u(t.signal,"options.signal")}let r=1;if((t===null||t===undefined?undefined:t.concurrency)!=null){r=w(t.concurrency)}c(r,"concurrency",1);return async function*map(){var n,s;const o=new i;const a=this;const u=[];const c=o.signal;const h={signal:c};const abort=()=>o.abort();if(t!==null&&t!==undefined&&(n=t.signal)!==null&&n!==undefined&&n.aborted){abort()}t===null||t===undefined?undefined:(s=t.signal)===null||s===undefined?undefined:s.addEventListener("abort",abort);let d;let p;let b=false;function onDone(){b=true}async function pump(){try{for await(let t of a){var i;if(b){return}if(c.aborted){throw new l}try{t=e(t,h)}catch(e){t=T(e)}if(t===I){continue}if(typeof((i=t)===null||i===undefined?undefined:i.catch)==="function"){t.catch(onDone)}u.push(t);if(d){d();d=null}if(!b&&u.length&&u.length>=r){await new k((e=>{p=e}))}}u.push(O)}catch(e){const t=T(e);R(t,undefined,onDone);u.push(t)}finally{var n;b=true;if(d){d();d=null}t===null||t===undefined?undefined:(n=t.signal)===null||n===undefined?undefined:n.removeEventListener("abort",abort)}}pump();try{while(true){while(u.length>0){const e=await u[0];if(e===O){return}if(c.aborted){throw new l}if(e!==I){yield e}u.shift();if(p){p();p=null}}await new k((e=>{d=e}))}}finally{o.abort();b=true;if(p){p();p=null}}}.call(this)}function asIndexedPairs(e=undefined){if(e!=null){h(e,"options")}if((e===null||e===undefined?undefined:e.signal)!=null){u(e.signal,"options.signal")}return async function*asIndexedPairs(){let t=0;for await(const i of this){var r;if(e!==null&&e!==undefined&&(r=e.signal)!==null&&r!==undefined&&r.aborted){throw new l({cause:e.signal.reason})}yield[t++,i]}}.call(this)}async function some(e,t=undefined){for await(const r of filter.call(this,e,t)){return true}return false}async function every(e,t=undefined){if(typeof e!=="function"){throw new s("fn",["Function","AsyncFunction"],e)}return!await some.call(this,(async(...t)=>!await e(...t)),t)}async function find(e,t){for await(const r of filter.call(this,e,t)){return r}return undefined}async function forEach(e,t){if(typeof e!=="function"){throw new s("fn",["Function","AsyncFunction"],e)}async function forEachFn(t,r){await e(t,r);return I}for await(const e of map.call(this,forEachFn,t));}function filter(e,t){if(typeof e!=="function"){throw new s("fn",["Function","AsyncFunction"],e)}async function filterFn(t,r){if(await e(t,r)){return t}return I}return map.call(this,filterFn,t)}class ReduceAwareErrMissingArgs extends o{constructor(){super("reduce");this.message="Reduce of an empty stream requires an initial value"}}async function reduce(e,t,r){var n;if(typeof e!=="function"){throw new s("reducer",["Function","AsyncFunction"],e)}if(r!=null){h(r,"options")}if((r===null||r===undefined?undefined:r.signal)!=null){u(r.signal,"options.signal")}let o=arguments.length>1;if(r!==null&&r!==undefined&&(n=r.signal)!==null&&n!==undefined&&n.aborted){const e=new l(undefined,{cause:r.signal.reason});this.once("error",(()=>{}));await p(this.destroy(e));throw e}const a=new i;const c=a.signal;if(r!==null&&r!==undefined&&r.signal){const e={once:true,[d]:this};r.signal.addEventListener("abort",(()=>a.abort()),e)}let b=false;try{for await(const i of this){var g;b=true;if(r!==null&&r!==undefined&&(g=r.signal)!==null&&g!==undefined&&g.aborted){throw new l}if(!o){t=i;o=true}else{t=await e(t,i,{signal:c})}}if(!b&&!o){throw new ReduceAwareErrMissingArgs}}finally{a.abort()}return t}async function toArray(e){if(e!=null){h(e,"options")}if((e===null||e===undefined?undefined:e.signal)!=null){u(e.signal,"options.signal")}const t=[];for await(const i of this){var r;if(e!==null&&e!==undefined&&(r=e.signal)!==null&&r!==undefined&&r.aborted){throw new l(undefined,{cause:e.signal.reason})}y(t,i)}return t}function flatMap(e,t){const r=map.call(this,e,t);return async function*flatMap(){for await(const e of r){yield*e}}.call(this)}function toIntegerOrInfinity(e){e=S(e);if(v(e)){return 0}if(e<0){throw new a("number",">= 0",e)}return e}function drop(e,t=undefined){if(t!=null){h(t,"options")}if((t===null||t===undefined?undefined:t.signal)!=null){u(t.signal,"options.signal")}e=toIntegerOrInfinity(e);return async function*drop(){var r;if(t!==null&&t!==undefined&&(r=t.signal)!==null&&r!==undefined&&r.aborted){throw new l}for await(const r of this){var i;if(t!==null&&t!==undefined&&(i=t.signal)!==null&&i!==undefined&&i.aborted){throw new l}if(e--<=0){yield r}}}.call(this)}function take(e,t=undefined){if(t!=null){h(t,"options")}if((t===null||t===undefined?undefined:t.signal)!=null){u(t.signal,"options.signal")}e=toIntegerOrInfinity(e);return async function*take(){var r;if(t!==null&&t!==undefined&&(r=t.signal)!==null&&r!==undefined&&r.aborted){throw new l}for await(const r of this){var i;if(t!==null&&t!==undefined&&(i=t.signal)!==null&&i!==undefined&&i.aborted){throw new l}if(e-- >0){yield r}else{return}}}.call(this)}e.exports.streamReturningOperators={asIndexedPairs:asIndexedPairs,drop:drop,filter:filter,flatMap:flatMap,map:map,take:take,compose:compose};e.exports.promiseReturningOperators={every:every,forEach:forEach,reduce:reduce,toArray:toArray,some:some,find:find}},667:(e,t,r)=>{"use strict";const{ObjectSetPrototypeOf:i}=r(7086);e.exports=PassThrough;const n=r(6253);i(PassThrough.prototype,n.prototype);i(PassThrough,n);function PassThrough(e){if(!(this instanceof PassThrough))return new PassThrough(e);n.call(this,e)}PassThrough.prototype._transform=function(e,t,r){r(null,e)}},5759:(e,t,r)=>{const i=r(9929);"use strict";const{ArrayIsArray:n,Promise:s,SymbolAsyncIterator:o}=r(7086);const a=r(7463);const{once:l}=r(6911);const u=r(6693);const c=r(7545);const{aggregateTwoErrors:h,codes:{ERR_INVALID_ARG_TYPE:d,ERR_INVALID_RETURN_VALUE:p,ERR_MISSING_ARGS:b,ERR_STREAM_DESTROYED:g,ERR_STREAM_PREMATURE_CLOSE:_},AbortError:m}=r(3304);const{validateFunction:y,validateAbortSignal:w}=r(2135);const{isIterable:S,isReadable:v,isReadableNodeStream:k,isNodeStream:T,isTransformStream:R,isWebStream:A,isReadableStream:I,isReadableEnded:O}=r(1089);const x=globalThis.AbortController||r(7295).AbortController;let C;let P;function destroyer(e,t,r){let i=false;e.on("close",(()=>{i=true}));const n=a(e,{readable:t,writable:r},(e=>{i=!e}));return{destroy:t=>{if(i)return;i=true;u.destroyer(e,t||new g("pipe"))},cleanup:n}}function popCallback(e){y(e[e.length-1],"streams[stream.length - 1]");return e.pop()}function makeAsyncIterable(e){if(S(e)){return e}else if(k(e)){return fromReadable(e)}throw new d("val",["Readable","Iterable","AsyncIterable"],e)}async function*fromReadable(e){if(!P){P=r(2159)}yield*P.prototype[o].call(e)}async function pumpToNode(e,t,r,{end:i}){let n;let o=null;const resume=e=>{if(e){n=e}if(o){const e=o;o=null;e()}};const wait=()=>new s(((e,t)=>{if(n){t(n)}else{o=()=>{if(n){t(n)}else{e()}}}}));t.on("drain",resume);const l=a(t,{readable:false},resume);try{if(t.writableNeedDrain){await wait()}for await(const r of e){if(!t.write(r)){await wait()}}if(i){t.end()}await wait();r()}catch(e){r(n!==e?h(n,e):e)}finally{l();t.off("drain",resume)}}async function pumpToWeb(e,t,r,{end:i}){if(R(t)){t=t.writable}const n=t.getWriter();try{for await(const t of e){await n.ready;n.write(t).catch((()=>{}))}await n.ready;if(i){await n.close()}r()}catch(e){try{await n.abort(e);r(e)}catch(e){r(e)}}}function pipeline(...e){return pipelineImpl(e,l(popCallback(e)))}function pipelineImpl(e,t,s){if(e.length===1&&n(e[0])){e=e[0]}if(e.length<2){throw new b("streams")}const o=new x;const a=o.signal;const l=s===null||s===undefined?undefined:s.signal;const u=[];w(l,"options.signal");function abort(){finishImpl(new m)}l===null||l===undefined?undefined:l.addEventListener("abort",abort);let h;let g;const _=[];let y=0;function finish(e){finishImpl(e,--y===0)}function finishImpl(e,r){if(e&&(!h||h.code==="ERR_STREAM_PREMATURE_CLOSE")){h=e}if(!h&&!r){return}while(_.length){_.shift()(h)}l===null||l===undefined?undefined:l.removeEventListener("abort",abort);o.abort();if(r){if(!h){u.forEach((e=>e()))}i.nextTick(t,h,g)}}let O;for(let t=0;t<e.length;t++){const n=e[t];const o=t<e.length-1;const l=t>0;const h=o||(s===null||s===undefined?undefined:s.end)!==false;const b=t===e.length-1;if(T(n)){if(h){const{destroy:e,cleanup:t}=destroyer(n,o,l);_.push(e);if(v(n)&&b){u.push(t)}}function onError(e){if(e&&e.name!=="AbortError"&&e.code!=="ERR_STREAM_PREMATURE_CLOSE"){finish(e)}}n.on("error",onError);if(v(n)&&b){u.push((()=>{n.removeListener("error",onError)}))}}if(t===0){if(typeof n==="function"){O=n({signal:a});if(!S(O)){throw new p("Iterable, AsyncIterable or Stream","source",O)}}else if(S(n)||k(n)||R(n)){O=n}else{O=c.from(n)}}else if(typeof n==="function"){if(R(O)){var P;O=makeAsyncIterable((P=O)===null||P===undefined?undefined:P.readable)}else{O=makeAsyncIterable(O)}O=n(O,{signal:a});if(o){if(!S(O,true)){throw new p("AsyncIterable",`transform[${t-1}]`,O)}}else{var B;if(!C){C=r(667)}const e=new C({objectMode:true});const t=(B=O)===null||B===undefined?undefined:B.then;if(typeof t==="function"){y++;t.call(O,(t=>{g=t;if(t!=null){e.write(t)}if(h){e.end()}i.nextTick(finish)}),(t=>{e.destroy(t);i.nextTick(finish,t)}))}else if(S(O,true)){y++;pumpToNode(O,e,finish,{end:h})}else if(I(O)||R(O)){const t=O.readable||O;y++;pumpToNode(t,e,finish,{end:h})}else{throw new p("AsyncIterable or Promise","destination",O)}O=e;const{destroy:n,cleanup:s}=destroyer(O,false,true);_.push(n);if(b){u.push(s)}}}else if(T(n)){if(k(O)){y+=2;const e=pipe(O,n,finish,{end:h});if(v(n)&&b){u.push(e)}}else if(R(O)||I(O)){const e=O.readable||O;y++;pumpToNode(e,n,finish,{end:h})}else if(S(O)){y++;pumpToNode(O,n,finish,{end:h})}else{throw new d("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],O)}O=n}else if(A(n)){if(k(O)){y++;pumpToWeb(makeAsyncIterable(O),n,finish,{end:h})}else if(I(O)||S(O)){y++;pumpToWeb(O,n,finish,{end:h})}else if(R(O)){y++;pumpToWeb(O.readable,n,finish,{end:h})}else{throw new d("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],O)}O=n}else{O=c.from(n)}}if(a!==null&&a!==undefined&&a.aborted||l!==null&&l!==undefined&&l.aborted){i.nextTick(abort)}return O}function pipe(e,t,r,{end:n}){let s=false;t.on("close",(()=>{if(!s){r(new _)}}));e.pipe(t,{end:false});if(n){function endFn(){s=true;t.end()}if(O(e)){i.nextTick(endFn)}else{e.once("end",endFn)}}else{r()}a(e,{readable:true,writable:false},(t=>{const i=e._readableState;if(t&&t.code==="ERR_STREAM_PREMATURE_CLOSE"&&i&&i.ended&&!i.errored&&!i.errorEmitted){e.once("end",r).once("error",r)}else{r(t)}}));return a(t,{readable:false,writable:true},r)}e.exports={pipelineImpl:pipelineImpl,pipeline:pipeline}},2159:(e,t,r)=>{const i=r(9929);"use strict";const{ArrayPrototypeIndexOf:n,NumberIsInteger:s,NumberIsNaN:o,NumberParseInt:a,ObjectDefineProperties:l,ObjectKeys:u,ObjectSetPrototypeOf:c,Promise:h,SafeSet:d,SymbolAsyncIterator:p,Symbol:b}=r(7086);e.exports=Readable;Readable.ReadableState=ReadableState;const{EventEmitter:g}=r(2361);const{Stream:_,prependListener:m}=r(2019);const{Buffer:y}=r(4300);const{addAbortSignal:w}=r(6364);const S=r(7463);let v=r(6911).debuglog("stream",(e=>{v=e}));const k=r(9471);const T=r(6693);const{getHighWaterMark:R,getDefaultHighWaterMark:A}=r(2310);const{aggregateTwoErrors:I,codes:{ERR_INVALID_ARG_TYPE:O,ERR_METHOD_NOT_IMPLEMENTED:x,ERR_OUT_OF_RANGE:C,ERR_STREAM_PUSH_AFTER_EOF:P,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:B}}=r(3304);const{validateObject:M}=r(2135);const L=b("kPaused");const{StringDecoder:N}=r(1576);const D=r(3311);c(Readable.prototype,_.prototype);c(Readable,_);const nop=()=>{};const{errorOrDestroy:W}=T;function ReadableState(e,t,i){if(typeof i!=="boolean")i=t instanceof r(7545);this.objectMode=!!(e&&e.objectMode);if(i)this.objectMode=this.objectMode||!!(e&&e.readableObjectMode);this.highWaterMark=e?R(this,e,"readableHighWaterMark",i):A(false);this.buffer=new k;this.length=0;this.pipes=[];this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.constructed=true;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this[L]=null;this.errorEmitted=false;this.emitClose=!e||e.emitClose!==false;this.autoDestroy=!e||e.autoDestroy!==false;this.destroyed=false;this.errored=null;this.closed=false;this.closeEmitted=false;this.defaultEncoding=e&&e.defaultEncoding||"utf8";this.awaitDrainWriters=null;this.multiAwaitDrain=false;this.readingMore=false;this.dataEmitted=false;this.decoder=null;this.encoding=null;if(e&&e.encoding){this.decoder=new N(e.encoding);this.encoding=e.encoding}}function Readable(e){if(!(this instanceof Readable))return new Readable(e);const t=this instanceof r(7545);this._readableState=new ReadableState(e,this,t);if(e){if(typeof e.read==="function")this._read=e.read;if(typeof e.destroy==="function")this._destroy=e.destroy;if(typeof e.construct==="function")this._construct=e.construct;if(e.signal&&!t)w(e.signal,this)}_.call(this,e);T.construct(this,(()=>{if(this._readableState.needReadable){maybeReadMore(this,this._readableState)}}))}Readable.prototype.destroy=T.destroy;Readable.prototype._undestroy=T.undestroy;Readable.prototype._destroy=function(e,t){t(e)};Readable.prototype[g.captureRejectionSymbol]=function(e){this.destroy(e)};Readable.prototype.push=function(e,t){return readableAddChunk(this,e,t,false)};Readable.prototype.unshift=function(e,t){return readableAddChunk(this,e,t,true)};function readableAddChunk(e,t,r,i){v("readableAddChunk",t);const n=e._readableState;let s;if(!n.objectMode){if(typeof t==="string"){r=r||n.defaultEncoding;if(n.encoding!==r){if(i&&n.encoding){t=y.from(t,r).toString(n.encoding)}else{t=y.from(t,r);r=""}}}else if(t instanceof y){r=""}else if(_._isUint8Array(t)){t=_._uint8ArrayToBuffer(t);r=""}else if(t!=null){s=new O("chunk",["string","Buffer","Uint8Array"],t)}}if(s){W(e,s)}else if(t===null){n.reading=false;onEofChunk(e,n)}else if(n.objectMode||t&&t.length>0){if(i){if(n.endEmitted)W(e,new B);else if(n.destroyed||n.errored)return false;else addChunk(e,n,t,true)}else if(n.ended){W(e,new P)}else if(n.destroyed||n.errored){return false}else{n.reading=false;if(n.decoder&&!r){t=n.decoder.write(t);if(n.objectMode||t.length!==0)addChunk(e,n,t,false);else maybeReadMore(e,n)}else{addChunk(e,n,t,false)}}}else if(!i){n.reading=false;maybeReadMore(e,n)}return!n.ended&&(n.length<n.highWaterMark||n.length===0)}function addChunk(e,t,r,i){if(t.flowing&&t.length===0&&!t.sync&&e.listenerCount("data")>0){if(t.multiAwaitDrain){t.awaitDrainWriters.clear()}else{t.awaitDrainWriters=null}t.dataEmitted=true;e.emit("data",r)}else{t.length+=t.objectMode?1:r.length;if(i)t.buffer.unshift(r);else t.buffer.push(r);if(t.needReadable)emitReadable(e)}maybeReadMore(e,t)}Readable.prototype.isPaused=function(){const e=this._readableState;return e[L]===true||e.flowing===false};Readable.prototype.setEncoding=function(e){const t=new N(e);this._readableState.decoder=t;this._readableState.encoding=this._readableState.decoder.encoding;const r=this._readableState.buffer;let i="";for(const e of r){i+=t.write(e)}r.clear();if(i!=="")r.push(i);this._readableState.length=i.length;return this};const j=1073741824;function computeNewHighWaterMark(e){if(e>j){throw new C("size","<= 1GiB",e)}else{e--;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;e++}return e}function howMuchToRead(e,t){if(e<=0||t.length===0&&t.ended)return 0;if(t.objectMode)return 1;if(o(e)){if(t.flowing&&t.length)return t.buffer.first().length;return t.length}if(e<=t.length)return e;return t.ended?t.length:0}Readable.prototype.read=function(e){v("read",e);if(e===undefined){e=NaN}else if(!s(e)){e=a(e,10)}const t=this._readableState;const r=e;if(e>t.highWaterMark)t.highWaterMark=computeNewHighWaterMark(e);if(e!==0)t.emittedReadable=false;if(e===0&&t.needReadable&&((t.highWaterMark!==0?t.length>=t.highWaterMark:t.length>0)||t.ended)){v("read: emitReadable",t.length,t.ended);if(t.length===0&&t.ended)endReadable(this);else emitReadable(this);return null}e=howMuchToRead(e,t);if(e===0&&t.ended){if(t.length===0)endReadable(this);return null}let i=t.needReadable;v("need readable",i);if(t.length===0||t.length-e<t.highWaterMark){i=true;v("length less than watermark",i)}if(t.ended||t.reading||t.destroyed||t.errored||!t.constructed){i=false;v("reading, ended or constructing",i)}else if(i){v("do read");t.reading=true;t.sync=true;if(t.length===0)t.needReadable=true;try{this._read(t.highWaterMark)}catch(e){W(this,e)}t.sync=false;if(!t.reading)e=howMuchToRead(r,t)}let n;if(e>0)n=fromList(e,t);else n=null;if(n===null){t.needReadable=t.length<=t.highWaterMark;e=0}else{t.length-=e;if(t.multiAwaitDrain){t.awaitDrainWriters.clear()}else{t.awaitDrainWriters=null}}if(t.length===0){if(!t.ended)t.needReadable=true;if(r!==e&&t.ended)endReadable(this)}if(n!==null&&!t.errorEmitted&&!t.closeEmitted){t.dataEmitted=true;this.emit("data",n)}return n};function onEofChunk(e,t){v("onEofChunk");if(t.ended)return;if(t.decoder){const e=t.decoder.end();if(e&&e.length){t.buffer.push(e);t.length+=t.objectMode?1:e.length}}t.ended=true;if(t.sync){emitReadable(e)}else{t.needReadable=false;t.emittedReadable=true;emitReadable_(e)}}function emitReadable(e){const t=e._readableState;v("emitReadable",t.needReadable,t.emittedReadable);t.needReadable=false;if(!t.emittedReadable){v("emitReadable",t.flowing);t.emittedReadable=true;i.nextTick(emitReadable_,e)}}function emitReadable_(e){const t=e._readableState;v("emitReadable_",t.destroyed,t.length,t.ended);if(!t.destroyed&&!t.errored&&(t.length||t.ended)){e.emit("readable");t.emittedReadable=false}t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark;flow(e)}function maybeReadMore(e,t){if(!t.readingMore&&t.constructed){t.readingMore=true;i.nextTick(maybeReadMore_,e,t)}}function maybeReadMore_(e,t){while(!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&t.length===0)){const r=t.length;v("maybeReadMore read 0");e.read(0);if(r===t.length)break}t.readingMore=false}Readable.prototype._read=function(e){throw new x("_read()")};Readable.prototype.pipe=function(e,t){const r=this;const n=this._readableState;if(n.pipes.length===1){if(!n.multiAwaitDrain){n.multiAwaitDrain=true;n.awaitDrainWriters=new d(n.awaitDrainWriters?[n.awaitDrainWriters]:[])}}n.pipes.push(e);v("pipe count=%d opts=%j",n.pipes.length,t);const s=(!t||t.end!==false)&&e!==i.stdout&&e!==i.stderr;const o=s?onend:unpipe;if(n.endEmitted)i.nextTick(o);else r.once("end",o);e.on("unpipe",onunpipe);function onunpipe(e,t){v("onunpipe");if(e===r){if(t&&t.hasUnpiped===false){t.hasUnpiped=true;cleanup()}}}function onend(){v("onend");e.end()}let a;let l=false;function cleanup(){v("cleanup");e.removeListener("close",onclose);e.removeListener("finish",onfinish);if(a){e.removeListener("drain",a)}e.removeListener("error",onerror);e.removeListener("unpipe",onunpipe);r.removeListener("end",onend);r.removeListener("end",unpipe);r.removeListener("data",ondata);l=true;if(a&&n.awaitDrainWriters&&(!e._writableState||e._writableState.needDrain))a()}function pause(){if(!l){if(n.pipes.length===1&&n.pipes[0]===e){v("false write response, pause",0);n.awaitDrainWriters=e;n.multiAwaitDrain=false}else if(n.pipes.length>1&&n.pipes.includes(e)){v("false write response, pause",n.awaitDrainWriters.size);n.awaitDrainWriters.add(e)}r.pause()}if(!a){a=pipeOnDrain(r,e);e.on("drain",a)}}r.on("data",ondata);function ondata(t){v("ondata");const r=e.write(t);v("dest.write",r);if(r===false){pause()}}function onerror(t){v("onerror",t);unpipe();e.removeListener("error",onerror);if(e.listenerCount("error")===0){const r=e._writableState||e._readableState;if(r&&!r.errorEmitted){W(e,t)}else{e.emit("error",t)}}}m(e,"error",onerror);function onclose(){e.removeListener("finish",onfinish);unpipe()}e.once("close",onclose);function onfinish(){v("onfinish");e.removeListener("close",onclose);unpipe()}e.once("finish",onfinish);function unpipe(){v("unpipe");r.unpipe(e)}e.emit("pipe",r);if(e.writableNeedDrain===true){if(n.flowing){pause()}}else if(!n.flowing){v("pipe resume");r.resume()}return e};function pipeOnDrain(e,t){return function pipeOnDrainFunctionResult(){const r=e._readableState;if(r.awaitDrainWriters===t){v("pipeOnDrain",1);r.awaitDrainWriters=null}else if(r.multiAwaitDrain){v("pipeOnDrain",r.awaitDrainWriters.size);r.awaitDrainWriters.delete(t)}if((!r.awaitDrainWriters||r.awaitDrainWriters.size===0)&&e.listenerCount("data")){e.resume()}}}Readable.prototype.unpipe=function(e){const t=this._readableState;const r={hasUnpiped:false};if(t.pipes.length===0)return this;if(!e){const e=t.pipes;t.pipes=[];this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:false});return this}const i=n(t.pipes,e);if(i===-1)return this;t.pipes.splice(i,1);if(t.pipes.length===0)this.pause();e.emit("unpipe",this,r);return this};Readable.prototype.on=function(e,t){const r=_.prototype.on.call(this,e,t);const n=this._readableState;if(e==="data"){n.readableListening=this.listenerCount("readable")>0;if(n.flowing!==false)this.resume()}else if(e==="readable"){if(!n.endEmitted&&!n.readableListening){n.readableListening=n.needReadable=true;n.flowing=false;n.emittedReadable=false;v("on readable",n.length,n.reading);if(n.length){emitReadable(this)}else if(!n.reading){i.nextTick(nReadingNextTick,this)}}}return r};Readable.prototype.addListener=Readable.prototype.on;Readable.prototype.removeListener=function(e,t){const r=_.prototype.removeListener.call(this,e,t);if(e==="readable"){i.nextTick(updateReadableListening,this)}return r};Readable.prototype.off=Readable.prototype.removeListener;Readable.prototype.removeAllListeners=function(e){const t=_.prototype.removeAllListeners.apply(this,arguments);if(e==="readable"||e===undefined){i.nextTick(updateReadableListening,this)}return t};function updateReadableListening(e){const t=e._readableState;t.readableListening=e.listenerCount("readable")>0;if(t.resumeScheduled&&t[L]===false){t.flowing=true}else if(e.listenerCount("data")>0){e.resume()}else if(!t.readableListening){t.flowing=null}}function nReadingNextTick(e){v("readable nexttick read 0");e.read(0)}Readable.prototype.resume=function(){const e=this._readableState;if(!e.flowing){v("resume");e.flowing=!e.readableListening;resume(this,e)}e[L]=false;return this};function resume(e,t){if(!t.resumeScheduled){t.resumeScheduled=true;i.nextTick(resume_,e,t)}}function resume_(e,t){v("resume",t.reading);if(!t.reading){e.read(0)}t.resumeScheduled=false;e.emit("resume");flow(e);if(t.flowing&&!t.reading)e.read(0)}Readable.prototype.pause=function(){v("call pause flowing=%j",this._readableState.flowing);if(this._readableState.flowing!==false){v("pause");this._readableState.flowing=false;this.emit("pause")}this._readableState[L]=true;return this};function flow(e){const t=e._readableState;v("flow",t.flowing);while(t.flowing&&e.read()!==null);}Readable.prototype.wrap=function(e){let t=false;e.on("data",(r=>{if(!this.push(r)&&e.pause){t=true;e.pause()}}));e.on("end",(()=>{this.push(null)}));e.on("error",(e=>{W(this,e)}));e.on("close",(()=>{this.destroy()}));e.on("destroy",(()=>{this.destroy()}));this._read=()=>{if(t&&e.resume){t=false;e.resume()}};const r=u(e);for(let t=1;t<r.length;t++){const i=r[t];if(this[i]===undefined&&typeof e[i]==="function"){this[i]=e[i].bind(e)}}return this};Readable.prototype[p]=function(){return streamToAsyncIterator(this)};Readable.prototype.iterator=function(e){if(e!==undefined){M(e,"options")}return streamToAsyncIterator(this,e)};function streamToAsyncIterator(e,t){if(typeof e.read!=="function"){e=Readable.wrap(e,{objectMode:true})}const r=createAsyncIterator(e,t);r.stream=e;return r}async function*createAsyncIterator(e,t){let r=nop;function next(t){if(this===e){r();r=nop}else{r=t}}e.on("readable",next);let i;const n=S(e,{writable:false},(e=>{i=e?I(i,e):null;r();r=nop}));try{while(true){const t=e.destroyed?null:e.read();if(t!==null){yield t}else if(i){throw i}else if(i===null){return}else{await new h(next)}}}catch(e){i=I(i,e);throw i}finally{if((i||(t===null||t===undefined?undefined:t.destroyOnReturn)!==false)&&(i===undefined||e._readableState.autoDestroy)){T.destroyer(e,null)}else{e.off("readable",next);n()}}}l(Readable.prototype,{readable:{__proto__:null,get(){const e=this._readableState;return!!e&&e.readable!==false&&!e.destroyed&&!e.errorEmitted&&!e.endEmitted},set(e){if(this._readableState){this._readableState.readable=!!e}}},readableDidRead:{__proto__:null,enumerable:false,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:false,get:function(){return!!(this._readableState.readable!==false&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:false,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:false,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:false,get:function(){return this._readableState.flowing},set:function(e){if(this._readableState){this._readableState.flowing=e}}},readableLength:{__proto__:null,enumerable:false,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:false,get(){return this._readableState?this._readableState.objectMode:false}},readableEncoding:{__proto__:null,enumerable:false,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:false,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:false}},destroyed:{__proto__:null,enumerable:false,get(){return this._readableState?this._readableState.destroyed:false},set(e){if(!this._readableState){return}this._readableState.destroyed=e}},readableEnded:{__proto__:null,enumerable:false,get(){return this._readableState?this._readableState.endEmitted:false}}});l(ReadableState.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[L]!==false},set(e){this[L]=!!e}}});Readable._fromList=fromList;function fromList(e,t){if(t.length===0)return null;let r;if(t.objectMode)r=t.buffer.shift();else if(!e||e>=t.length){if(t.decoder)r=t.buffer.join("");else if(t.buffer.length===1)r=t.buffer.first();else r=t.buffer.concat(t.length);t.buffer.clear()}else{r=t.buffer.consume(e,t.decoder)}return r}function endReadable(e){const t=e._readableState;v("endReadable",t.endEmitted);if(!t.endEmitted){t.ended=true;i.nextTick(endReadableNT,t,e)}}function endReadableNT(e,t){v("endReadableNT",e.endEmitted,e.length);if(!e.errored&&!e.closeEmitted&&!e.endEmitted&&e.length===0){e.endEmitted=true;t.emit("end");if(t.writable&&t.allowHalfOpen===false){i.nextTick(endWritableNT,t)}else if(e.autoDestroy){const e=t._writableState;const r=!e||e.autoDestroy&&(e.finished||e.writable===false);if(r){t.destroy()}}}}function endWritableNT(e){const t=e.writable&&!e.writableEnded&&!e.destroyed;if(t){e.end()}}Readable.from=function(e,t){return D(Readable,e,t)};let U;function lazyWebStreams(){if(U===undefined)U={};return U}Readable.fromWeb=function(e,t){return lazyWebStreams().newStreamReadableFromReadableStream(e,t)};Readable.toWeb=function(e,t){return lazyWebStreams().newReadableStreamFromStreamReadable(e,t)};Readable.wrap=function(e,t){var r,i;return new Readable({objectMode:(r=(i=e.readableObjectMode)!==null&&i!==undefined?i:e.objectMode)!==null&&r!==undefined?r:true,...t,destroy(t,r){T.destroyer(e,t);r(t)}}).wrap(e)}},2310:(e,t,r)=>{"use strict";const{MathFloor:i,NumberIsInteger:n}=r(7086);const{ERR_INVALID_ARG_VALUE:s}=r(3304).codes;function highWaterMarkFrom(e,t,r){return e.highWaterMark!=null?e.highWaterMark:t?e[r]:null}function getDefaultHighWaterMark(e){return e?16:16*1024}function getHighWaterMark(e,t,r,o){const a=highWaterMarkFrom(t,o,r);if(a!=null){if(!n(a)||a<0){const e=o?`options.${r}`:"options.highWaterMark";throw new s(e,a)}return i(a)}return getDefaultHighWaterMark(e.objectMode)}e.exports={getHighWaterMark:getHighWaterMark,getDefaultHighWaterMark:getDefaultHighWaterMark}},6253:(e,t,r)=>{"use strict";const{ObjectSetPrototypeOf:i,Symbol:n}=r(7086);e.exports=Transform;const{ERR_METHOD_NOT_IMPLEMENTED:s}=r(3304).codes;const o=r(7545);const{getHighWaterMark:a}=r(2310);i(Transform.prototype,o.prototype);i(Transform,o);const l=n("kCallback");function Transform(e){if(!(this instanceof Transform))return new Transform(e);const t=e?a(this,e,"readableHighWaterMark",true):null;if(t===0){e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}}o.call(this,e);this._readableState.sync=false;this[l]=null;if(e){if(typeof e.transform==="function")this._transform=e.transform;if(typeof e.flush==="function")this._flush=e.flush}this.on("prefinish",prefinish)}function final(e){if(typeof this._flush==="function"&&!this.destroyed){this._flush(((t,r)=>{if(t){if(e){e(t)}else{this.destroy(t)}return}if(r!=null){this.push(r)}this.push(null);if(e){e()}}))}else{this.push(null);if(e){e()}}}function prefinish(){if(this._final!==final){final.call(this)}}Transform.prototype._final=final;Transform.prototype._transform=function(e,t,r){throw new s("_transform()")};Transform.prototype._write=function(e,t,r){const i=this._readableState;const n=this._writableState;const s=i.length;this._transform(e,t,((e,t)=>{if(e){r(e);return}if(t!=null){this.push(t)}if(n.ended||s===i.length||i.length<i.highWaterMark){r()}else{this[l]=r}}))};Transform.prototype._read=function(){if(this[l]){const e=this[l];this[l]=null;e()}}},1089:(e,t,r)=>{"use strict";const{Symbol:i,SymbolAsyncIterator:n,SymbolIterator:s,SymbolFor:o}=r(7086);const a=i("kDestroyed");const l=i("kIsErrored");const u=i("kIsReadable");const c=i("kIsDisturbed");const h=o("nodejs.webstream.isClosedPromise");const d=o("nodejs.webstream.controllerErrorFunction");function isReadableNodeStream(e,t=false){var r;return!!(e&&typeof e.pipe==="function"&&typeof e.on==="function"&&(!t||typeof e.pause==="function"&&typeof e.resume==="function")&&(!e._writableState||((r=e._readableState)===null||r===undefined?undefined:r.readable)!==false)&&(!e._writableState||e._readableState))}function isWritableNodeStream(e){var t;return!!(e&&typeof e.write==="function"&&typeof e.on==="function"&&(!e._readableState||((t=e._writableState)===null||t===undefined?undefined:t.writable)!==false))}function isDuplexNodeStream(e){return!!(e&&typeof e.pipe==="function"&&e._readableState&&typeof e.on==="function"&&typeof e.write==="function")}function isNodeStream(e){return e&&(e._readableState||e._writableState||typeof e.write==="function"&&typeof e.on==="function"||typeof e.pipe==="function"&&typeof e.on==="function")}function isReadableStream(e){return!!(e&&!isNodeStream(e)&&typeof e.pipeThrough==="function"&&typeof e.getReader==="function"&&typeof e.cancel==="function")}function isWritableStream(e){return!!(e&&!isNodeStream(e)&&typeof e.getWriter==="function"&&typeof e.abort==="function")}function isTransformStream(e){return!!(e&&!isNodeStream(e)&&typeof e.readable==="object"&&typeof e.writable==="object")}function isWebStream(e){return isReadableStream(e)||isWritableStream(e)||isTransformStream(e)}function isIterable(e,t){if(e==null)return false;if(t===true)return typeof e[n]==="function";if(t===false)return typeof e[s]==="function";return typeof e[n]==="function"||typeof e[s]==="function"}function isDestroyed(e){if(!isNodeStream(e))return null;const t=e._writableState;const r=e._readableState;const i=t||r;return!!(e.destroyed||e[a]||i!==null&&i!==undefined&&i.destroyed)}function isWritableEnded(e){if(!isWritableNodeStream(e))return null;if(e.writableEnded===true)return true;const t=e._writableState;if(t!==null&&t!==undefined&&t.errored)return false;if(typeof(t===null||t===undefined?undefined:t.ended)!=="boolean")return null;return t.ended}function isWritableFinished(e,t){if(!isWritableNodeStream(e))return null;if(e.writableFinished===true)return true;const r=e._writableState;if(r!==null&&r!==undefined&&r.errored)return false;if(typeof(r===null||r===undefined?undefined:r.finished)!=="boolean")return null;return!!(r.finished||t===false&&r.ended===true&&r.length===0)}function isReadableEnded(e){if(!isReadableNodeStream(e))return null;if(e.readableEnded===true)return true;const t=e._readableState;if(!t||t.errored)return false;if(typeof(t===null||t===undefined?undefined:t.ended)!=="boolean")return null;return t.ended}function isReadableFinished(e,t){if(!isReadableNodeStream(e))return null;const r=e._readableState;if(r!==null&&r!==undefined&&r.errored)return false;if(typeof(r===null||r===undefined?undefined:r.endEmitted)!=="boolean")return null;return!!(r.endEmitted||t===false&&r.ended===true&&r.length===0)}function isReadable(e){if(e&&e[u]!=null)return e[u];if(typeof(e===null||e===undefined?undefined:e.readable)!=="boolean")return null;if(isDestroyed(e))return false;return isReadableNodeStream(e)&&e.readable&&!isReadableFinished(e)}function isWritable(e){if(typeof(e===null||e===undefined?undefined:e.writable)!=="boolean")return null;if(isDestroyed(e))return false;return isWritableNodeStream(e)&&e.writable&&!isWritableEnded(e)}function isFinished(e,t){if(!isNodeStream(e)){return null}if(isDestroyed(e)){return true}if((t===null||t===undefined?undefined:t.readable)!==false&&isReadable(e)){return false}if((t===null||t===undefined?undefined:t.writable)!==false&&isWritable(e)){return false}return true}function isWritableErrored(e){var t,r;if(!isNodeStream(e)){return null}if(e.writableErrored){return e.writableErrored}return(t=(r=e._writableState)===null||r===undefined?undefined:r.errored)!==null&&t!==undefined?t:null}function isReadableErrored(e){var t,r;if(!isNodeStream(e)){return null}if(e.readableErrored){return e.readableErrored}return(t=(r=e._readableState)===null||r===undefined?undefined:r.errored)!==null&&t!==undefined?t:null}function isClosed(e){if(!isNodeStream(e)){return null}if(typeof e.closed==="boolean"){return e.closed}const t=e._writableState;const r=e._readableState;if(typeof(t===null||t===undefined?undefined:t.closed)==="boolean"||typeof(r===null||r===undefined?undefined:r.closed)==="boolean"){return(t===null||t===undefined?undefined:t.closed)||(r===null||r===undefined?undefined:r.closed)}if(typeof e._closed==="boolean"&&isOutgoingMessage(e)){return e._closed}return null}function isOutgoingMessage(e){return typeof e._closed==="boolean"&&typeof e._defaultKeepAlive==="boolean"&&typeof e._removedConnection==="boolean"&&typeof e._removedContLen==="boolean"}function isServerResponse(e){return typeof e._sent100==="boolean"&&isOutgoingMessage(e)}function isServerRequest(e){var t;return typeof e._consuming==="boolean"&&typeof e._dumped==="boolean"&&((t=e.req)===null||t===undefined?undefined:t.upgradeOrConnect)===undefined}function willEmitClose(e){if(!isNodeStream(e))return null;const t=e._writableState;const r=e._readableState;const i=t||r;return!i&&isServerResponse(e)||!!(i&&i.autoDestroy&&i.emitClose&&i.closed===false)}function isDisturbed(e){var t;return!!(e&&((t=e[c])!==null&&t!==undefined?t:e.readableDidRead||e.readableAborted))}function isErrored(e){var t,r,i,n,s,o,a,u,c,h;return!!(e&&((t=(r=(i=(n=(s=(o=e[l])!==null&&o!==undefined?o:e.readableErrored)!==null&&s!==undefined?s:e.writableErrored)!==null&&n!==undefined?n:(a=e._readableState)===null||a===undefined?undefined:a.errorEmitted)!==null&&i!==undefined?i:(u=e._writableState)===null||u===undefined?undefined:u.errorEmitted)!==null&&r!==undefined?r:(c=e._readableState)===null||c===undefined?undefined:c.errored)!==null&&t!==undefined?t:(h=e._writableState)===null||h===undefined?undefined:h.errored))}e.exports={kDestroyed:a,isDisturbed:isDisturbed,kIsDisturbed:c,isErrored:isErrored,kIsErrored:l,isReadable:isReadable,kIsReadable:u,kIsClosedPromise:h,kControllerErrorFunction:d,isClosed:isClosed,isDestroyed:isDestroyed,isDuplexNodeStream:isDuplexNodeStream,isFinished:isFinished,isIterable:isIterable,isReadableNodeStream:isReadableNodeStream,isReadableStream:isReadableStream,isReadableEnded:isReadableEnded,isReadableFinished:isReadableFinished,isReadableErrored:isReadableErrored,isNodeStream:isNodeStream,isWebStream:isWebStream,isWritable:isWritable,isWritableNodeStream:isWritableNodeStream,isWritableStream:isWritableStream,isWritableEnded:isWritableEnded,isWritableFinished:isWritableFinished,isWritableErrored:isWritableErrored,isServerRequest:isServerRequest,isServerResponse:isServerResponse,willEmitClose:willEmitClose,isTransformStream:isTransformStream}},7649:(e,t,r)=>{const i=r(9929);"use strict";const{ArrayPrototypeSlice:n,Error:s,FunctionPrototypeSymbolHasInstance:o,ObjectDefineProperty:a,ObjectDefineProperties:l,ObjectSetPrototypeOf:u,StringPrototypeToLowerCase:c,Symbol:h,SymbolHasInstance:d}=r(7086);e.exports=Writable;Writable.WritableState=WritableState;const{EventEmitter:p}=r(2361);const b=r(2019).Stream;const{Buffer:g}=r(4300);const _=r(6693);const{addAbortSignal:m}=r(6364);const{getHighWaterMark:y,getDefaultHighWaterMark:w}=r(2310);const{ERR_INVALID_ARG_TYPE:S,ERR_METHOD_NOT_IMPLEMENTED:v,ERR_MULTIPLE_CALLBACK:k,ERR_STREAM_CANNOT_PIPE:T,ERR_STREAM_DESTROYED:R,ERR_STREAM_ALREADY_FINISHED:A,ERR_STREAM_NULL_VALUES:I,ERR_STREAM_WRITE_AFTER_END:O,ERR_UNKNOWN_ENCODING:x}=r(3304).codes;const{errorOrDestroy:C}=_;u(Writable.prototype,b.prototype);u(Writable,b);function nop(){}const P=h("kOnFinished");function WritableState(e,t,i){if(typeof i!=="boolean")i=t instanceof r(7545);this.objectMode=!!(e&&e.objectMode);if(i)this.objectMode=this.objectMode||!!(e&&e.writableObjectMode);this.highWaterMark=e?y(this,e,"writableHighWaterMark",i):w(false);this.finalCalled=false;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;this.destroyed=false;const n=!!(e&&e.decodeStrings===false);this.decodeStrings=!n;this.defaultEncoding=e&&e.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=onwrite.bind(undefined,t);this.writecb=null;this.writelen=0;this.afterWriteTickInfo=null;resetBuffer(this);this.pendingcb=0;this.constructed=true;this.prefinished=false;this.errorEmitted=false;this.emitClose=!e||e.emitClose!==false;this.autoDestroy=!e||e.autoDestroy!==false;this.errored=null;this.closed=false;this.closeEmitted=false;this[P]=[]}function resetBuffer(e){e.buffered=[];e.bufferedIndex=0;e.allBuffers=true;e.allNoop=true}WritableState.prototype.getBuffer=function getBuffer(){return n(this.buffered,this.bufferedIndex)};a(WritableState.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function Writable(e){const t=this instanceof r(7545);if(!t&&!o(Writable,this))return new Writable(e);this._writableState=new WritableState(e,this,t);if(e){if(typeof e.write==="function")this._write=e.write;if(typeof e.writev==="function")this._writev=e.writev;if(typeof e.destroy==="function")this._destroy=e.destroy;if(typeof e.final==="function")this._final=e.final;if(typeof e.construct==="function")this._construct=e.construct;if(e.signal)m(e.signal,this)}b.call(this,e);_.construct(this,(()=>{const e=this._writableState;if(!e.writing){clearBuffer(this,e)}finishMaybe(this,e)}))}a(Writable,d,{__proto__:null,value:function(e){if(o(this,e))return true;if(this!==Writable)return false;return e&&e._writableState instanceof WritableState}});Writable.prototype.pipe=function(){C(this,new T)};function _write(e,t,r,n){const s=e._writableState;if(typeof r==="function"){n=r;r=s.defaultEncoding}else{if(!r)r=s.defaultEncoding;else if(r!=="buffer"&&!g.isEncoding(r))throw new x(r);if(typeof n!=="function")n=nop}if(t===null){throw new I}else if(!s.objectMode){if(typeof t==="string"){if(s.decodeStrings!==false){t=g.from(t,r);r="buffer"}}else if(t instanceof g){r="buffer"}else if(b._isUint8Array(t)){t=b._uint8ArrayToBuffer(t);r="buffer"}else{throw new S("chunk",["string","Buffer","Uint8Array"],t)}}let o;if(s.ending){o=new O}else if(s.destroyed){o=new R("write")}if(o){i.nextTick(n,o);C(e,o,true);return o}s.pendingcb++;return writeOrBuffer(e,s,t,r,n)}Writable.prototype.write=function(e,t,r){return _write(this,e,t,r)===true};Writable.prototype.cork=function(){this._writableState.corked++};Writable.prototype.uncork=function(){const e=this._writableState;if(e.corked){e.corked--;if(!e.writing)clearBuffer(this,e)}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(e){if(typeof e==="string")e=c(e);if(!g.isEncoding(e))throw new x(e);this._writableState.defaultEncoding=e;return this};function writeOrBuffer(e,t,r,i,n){const s=t.objectMode?1:r.length;t.length+=s;const o=t.length<t.highWaterMark;if(!o)t.needDrain=true;if(t.writing||t.corked||t.errored||!t.constructed){t.buffered.push({chunk:r,encoding:i,callback:n});if(t.allBuffers&&i!=="buffer"){t.allBuffers=false}if(t.allNoop&&n!==nop){t.allNoop=false}}else{t.writelen=s;t.writecb=n;t.writing=true;t.sync=true;e._write(r,i,t.onwrite);t.sync=false}return o&&!t.errored&&!t.destroyed}function doWrite(e,t,r,i,n,s,o){t.writelen=i;t.writecb=o;t.writing=true;t.sync=true;if(t.destroyed)t.onwrite(new R("write"));else if(r)e._writev(n,t.onwrite);else e._write(n,s,t.onwrite);t.sync=false}function onwriteError(e,t,r,i){--t.pendingcb;i(r);errorBuffer(t);C(e,r)}function onwrite(e,t){const r=e._writableState;const n=r.sync;const s=r.writecb;if(typeof s!=="function"){C(e,new k);return}r.writing=false;r.writecb=null;r.length-=r.writelen;r.writelen=0;if(t){t.stack;if(!r.errored){r.errored=t}if(e._readableState&&!e._readableState.errored){e._readableState.errored=t}if(n){i.nextTick(onwriteError,e,r,t,s)}else{onwriteError(e,r,t,s)}}else{if(r.buffered.length>r.bufferedIndex){clearBuffer(e,r)}if(n){if(r.afterWriteTickInfo!==null&&r.afterWriteTickInfo.cb===s){r.afterWriteTickInfo.count++}else{r.afterWriteTickInfo={count:1,cb:s,stream:e,state:r};i.nextTick(afterWriteTick,r.afterWriteTickInfo)}}else{afterWrite(e,r,1,s)}}}function afterWriteTick({stream:e,state:t,count:r,cb:i}){t.afterWriteTickInfo=null;return afterWrite(e,t,r,i)}function afterWrite(e,t,r,i){const n=!t.ending&&!e.destroyed&&t.length===0&&t.needDrain;if(n){t.needDrain=false;e.emit("drain")}while(r-- >0){t.pendingcb--;i()}if(t.destroyed){errorBuffer(t)}finishMaybe(e,t)}function errorBuffer(e){if(e.writing){return}for(let r=e.bufferedIndex;r<e.buffered.length;++r){var t;const{chunk:i,callback:n}=e.buffered[r];const s=e.objectMode?1:i.length;e.length-=s;n((t=e.errored)!==null&&t!==undefined?t:new R("write"))}const r=e[P].splice(0);for(let t=0;t<r.length;t++){var i;r[t]((i=e.errored)!==null&&i!==undefined?i:new R("end"))}resetBuffer(e)}function clearBuffer(e,t){if(t.corked||t.bufferProcessing||t.destroyed||!t.constructed){return}const{buffered:r,bufferedIndex:i,objectMode:s}=t;const o=r.length-i;if(!o){return}let a=i;t.bufferProcessing=true;if(o>1&&e._writev){t.pendingcb-=o-1;const i=t.allNoop?nop:e=>{for(let t=a;t<r.length;++t){r[t].callback(e)}};const s=t.allNoop&&a===0?r:n(r,a);s.allBuffers=t.allBuffers;doWrite(e,t,true,t.length,s,"",i);resetBuffer(t)}else{do{const{chunk:i,encoding:n,callback:o}=r[a];r[a++]=null;const l=s?1:i.length;doWrite(e,t,false,l,i,n,o)}while(a<r.length&&!t.writing);if(a===r.length){resetBuffer(t)}else if(a>256){r.splice(0,a);t.bufferedIndex=0}else{t.bufferedIndex=a}}t.bufferProcessing=false}Writable.prototype._write=function(e,t,r){if(this._writev){this._writev([{chunk:e,encoding:t}],r)}else{throw new v("_write()")}};Writable.prototype._writev=null;Writable.prototype.end=function(e,t,r){const n=this._writableState;if(typeof e==="function"){r=e;e=null;t=null}else if(typeof t==="function"){r=t;t=null}let o;if(e!==null&&e!==undefined){const r=_write(this,e,t);if(r instanceof s){o=r}}if(n.corked){n.corked=1;this.uncork()}if(o){}else if(!n.errored&&!n.ending){n.ending=true;finishMaybe(this,n,true);n.ended=true}else if(n.finished){o=new A("end")}else if(n.destroyed){o=new R("end")}if(typeof r==="function"){if(o||n.finished){i.nextTick(r,o)}else{n[P].push(r)}}return this};function needFinish(e){return e.ending&&!e.destroyed&&e.constructed&&e.length===0&&!e.errored&&e.buffered.length===0&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function callFinal(e,t){let r=false;function onFinish(n){if(r){C(e,n!==null&&n!==undefined?n:k());return}r=true;t.pendingcb--;if(n){const r=t[P].splice(0);for(let e=0;e<r.length;e++){r[e](n)}C(e,n,t.sync)}else if(needFinish(t)){t.prefinished=true;e.emit("prefinish");t.pendingcb++;i.nextTick(finish,e,t)}}t.sync=true;t.pendingcb++;try{e._final(onFinish)}catch(e){onFinish(e)}t.sync=false}function prefinish(e,t){if(!t.prefinished&&!t.finalCalled){if(typeof e._final==="function"&&!t.destroyed){t.finalCalled=true;callFinal(e,t)}else{t.prefinished=true;e.emit("prefinish")}}}function finishMaybe(e,t,r){if(needFinish(t)){prefinish(e,t);if(t.pendingcb===0){if(r){t.pendingcb++;i.nextTick(((e,t)=>{if(needFinish(t)){finish(e,t)}else{t.pendingcb--}}),e,t)}else if(needFinish(t)){t.pendingcb++;finish(e,t)}}}}function finish(e,t){t.pendingcb--;t.finished=true;const r=t[P].splice(0);for(let e=0;e<r.length;e++){r[e]()}e.emit("finish");if(t.autoDestroy){const t=e._readableState;const r=!t||t.autoDestroy&&(t.endEmitted||t.readable===false);if(r){e.destroy()}}}l(Writable.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:false}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:false},set(e){if(this._writableState){this._writableState.destroyed=e}}},writable:{__proto__:null,get(){const e=this._writableState;return!!e&&e.writable!==false&&!e.destroyed&&!e.errored&&!e.ending&&!e.ended},set(e){if(this._writableState){this._writableState.writable=!!e}}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:false}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:false}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:false}},writableNeedDrain:{__proto__:null,get(){const e=this._writableState;if(!e)return false;return!e.destroyed&&!e.ending&&e.needDrain}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:false,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:false,get:function(){return!!(this._writableState.writable!==false&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const B=_.destroy;Writable.prototype.destroy=function(e,t){const r=this._writableState;if(!r.destroyed&&(r.bufferedIndex<r.buffered.length||r[P].length)){i.nextTick(errorBuffer,r)}B.call(this,e,t);return this};Writable.prototype._undestroy=_.undestroy;Writable.prototype._destroy=function(e,t){t(e)};Writable.prototype[p.captureRejectionSymbol]=function(e){this.destroy(e)};let M;function lazyWebStreams(){if(M===undefined)M={};return M}Writable.fromWeb=function(e,t){return lazyWebStreams().newStreamWritableFromWritableStream(e,t)};Writable.toWeb=function(e){return lazyWebStreams().newWritableStreamFromStreamWritable(e)}},2135:(e,t,r)=>{"use strict";const{ArrayIsArray:i,ArrayPrototypeIncludes:n,ArrayPrototypeJoin:s,ArrayPrototypeMap:o,NumberIsInteger:a,NumberIsNaN:l,NumberMAX_SAFE_INTEGER:u,NumberMIN_SAFE_INTEGER:c,NumberParseInt:h,ObjectPrototypeHasOwnProperty:d,RegExpPrototypeExec:p,String:b,StringPrototypeToUpperCase:g,StringPrototypeTrim:_}=r(7086);const{hideStackFrames:m,codes:{ERR_SOCKET_BAD_PORT:y,ERR_INVALID_ARG_TYPE:w,ERR_INVALID_ARG_VALUE:S,ERR_OUT_OF_RANGE:v,ERR_UNKNOWN_SIGNAL:k}}=r(3304);const{normalizeEncoding:T}=r(6911);const{isAsyncFunction:R,isArrayBufferView:A}=r(6911).types;const I={};function isInt32(e){return e===(e|0)}function isUint32(e){return e===e>>>0}const O=/^[0-7]+$/;const x="must be a 32-bit unsigned integer or an octal string";function parseFileMode(e,t,r){if(typeof e==="undefined"){e=r}if(typeof e==="string"){if(p(O,e)===null){throw new S(t,e,x)}e=h(e,8)}B(e,t);return e}const C=m(((e,t,r=c,i=u)=>{if(typeof e!=="number")throw new w(t,"number",e);if(!a(e))throw new v(t,"an integer",e);if(e<r||e>i)throw new v(t,`>= ${r} && <= ${i}`,e)}));const P=m(((e,t,r=-2147483648,i=2147483647)=>{if(typeof e!=="number"){throw new w(t,"number",e)}if(!a(e)){throw new v(t,"an integer",e)}if(e<r||e>i){throw new v(t,`>= ${r} && <= ${i}`,e)}}));const B=m(((e,t,r=false)=>{if(typeof e!=="number"){throw new w(t,"number",e)}if(!a(e)){throw new v(t,"an integer",e)}const i=r?1:0;const n=4294967295;if(e<i||e>n){throw new v(t,`>= ${i} && <= ${n}`,e)}}));function validateString(e,t){if(typeof e!=="string")throw new w(t,"string",e)}function validateNumber(e,t,r=undefined,i){if(typeof e!=="number")throw new w(t,"number",e);if(r!=null&&e<r||i!=null&&e>i||(r!=null||i!=null)&&l(e)){throw new v(t,`${r!=null?`>= ${r}`:""}${r!=null&&i!=null?" && ":""}${i!=null?`<= ${i}`:""}`,e)}}const M=m(((e,t,r)=>{if(!n(r,e)){const i=s(o(r,(e=>typeof e==="string"?`'${e}'`:b(e))),", ");const n="must be one of: "+i;throw new S(t,e,n)}}));function validateBoolean(e,t){if(typeof e!=="boolean")throw new w(t,"boolean",e)}function getOwnPropertyValueOrDefault(e,t,r){return e==null||!d(e,t)?r:e[t]}const L=m(((e,t,r=null)=>{const n=getOwnPropertyValueOrDefault(r,"allowArray",false);const s=getOwnPropertyValueOrDefault(r,"allowFunction",false);const o=getOwnPropertyValueOrDefault(r,"nullable",false);if(!o&&e===null||!n&&i(e)||typeof e!=="object"&&(!s||typeof e!=="function")){throw new w(t,"Object",e)}}));const N=m(((e,t)=>{if(e!=null&&typeof e!=="object"&&typeof e!=="function"){throw new w(t,"a dictionary",e)}}));const D=m(((e,t,r=0)=>{if(!i(e)){throw new w(t,"Array",e)}if(e.length<r){const i=`must be longer than ${r}`;throw new S(t,e,i)}}));function validateStringArray(e,t){D(e,t);for(let r=0;r<e.length;r++){validateString(e[r],`${t}[${r}]`)}}function validateBooleanArray(e,t){D(e,t);for(let r=0;r<e.length;r++){validateBoolean(e[r],`${t}[${r}]`)}}function validateSignalName(e,t="signal"){validateString(e,t);if(I[e]===undefined){if(I[g(e)]!==undefined){throw new k(e+" (signals must use all capital letters)")}throw new k(e)}}const W=m(((e,t="buffer")=>{if(!A(e)){throw new w(t,["Buffer","TypedArray","DataView"],e)}}));function validateEncoding(e,t){const r=T(t);const i=e.length;if(r==="hex"&&i%2!==0){throw new S("encoding",t,`is invalid for data of length ${i}`)}}function validatePort(e,t="Port",r=true){if(typeof e!=="number"&&typeof e!=="string"||typeof e==="string"&&_(e).length===0||+e!==+e>>>0||e>65535||e===0&&!r){throw new y(t,e,r)}return e|0}const j=m(((e,t)=>{if(e!==undefined&&(e===null||typeof e!=="object"||!("aborted"in e))){throw new w(t,"AbortSignal",e)}}));const U=m(((e,t)=>{if(typeof e!=="function")throw new w(t,"Function",e)}));const F=m(((e,t)=>{if(typeof e!=="function"||R(e))throw new w(t,"Function",e)}));const q=m(((e,t)=>{if(e!==undefined)throw new w(t,"undefined",e)}));function validateUnion(e,t,r){if(!n(r,e)){throw new w(t,`('${s(r,"|")}')`,e)}}const H=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function validateLinkHeaderFormat(e,t){if(typeof e==="undefined"||!p(H,e)){throw new S(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}function validateLinkHeaderValue(e){if(typeof e==="string"){validateLinkHeaderFormat(e,"hints");return e}else if(i(e)){const t=e.length;let r="";if(t===0){return r}for(let i=0;i<t;i++){const n=e[i];validateLinkHeaderFormat(n,"hints");r+=n;if(i!==t-1){r+=", "}}return r}throw new S("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}e.exports={isInt32:isInt32,isUint32:isUint32,parseFileMode:parseFileMode,validateArray:D,validateStringArray:validateStringArray,validateBooleanArray:validateBooleanArray,validateBoolean:validateBoolean,validateBuffer:W,validateDictionary:N,validateEncoding:validateEncoding,validateFunction:U,validateInt32:P,validateInteger:C,validateNumber:validateNumber,validateObject:L,validateOneOf:M,validatePlainFunction:F,validatePort:validatePort,validateSignalName:validateSignalName,validateString:validateString,validateUint32:B,validateUndefined:q,validateUnion:validateUnion,validateAbortSignal:j,validateLinkHeaderValue:validateLinkHeaderValue}},3304:(e,t,r)=>{"use strict";const{format:i,inspect:n,AggregateError:s}=r(6911);const o=globalThis.AggregateError||s;const a=Symbol("kIsNodeError");const l=["string","function","number","object","Function","Object","boolean","bigint","symbol"];const u=/^([A-Z][a-z0-9]*)+$/;const c="__node_internal_";const h={};function assert(e,t){if(!e){throw new h.ERR_INTERNAL_ASSERTION(t)}}function addNumericalSeparator(e){let t="";let r=e.length;const i=e[0]==="-"?1:0;for(;r>=i+4;r-=3){t=`_${e.slice(r-3,r)}${t}`}return`${e.slice(0,r)}${t}`}function getMessage(e,t,r){if(typeof t==="function"){assert(t.length<=r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${t.length}).`);return t(...r)}const n=(t.match(/%[dfijoOs]/g)||[]).length;assert(n===r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${n}).`);if(r.length===0){return t}return i(t,...r)}function E(e,t,r){if(!r){r=Error}class NodeError extends r{constructor(...r){super(getMessage(e,t,r))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(NodeError.prototype,{name:{value:r.name,writable:true,enumerable:false,configurable:true},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:true,enumerable:false,configurable:true}});NodeError.prototype.code=e;NodeError.prototype[a]=true;h[e]=NodeError}function hideStackFrames(e){const t=c+e.name;Object.defineProperty(e,"name",{value:t});return e}function aggregateTwoErrors(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors)){t.errors.push(e);return t}const r=new o([t,e],t.message);r.code=t.code;return r}return e||t}class AbortError extends Error{constructor(e="The operation was aborted",t=undefined){if(t!==undefined&&typeof t!=="object"){throw new h.ERR_INVALID_ARG_TYPE("options","Object",t)}super(e,t);this.code="ABORT_ERR";this.name="AbortError"}}E("ERR_ASSERTION","%s",Error);E("ERR_INVALID_ARG_TYPE",((e,t,r)=>{assert(typeof e==="string","'name' must be a string");if(!Array.isArray(t)){t=[t]}let i="The ";if(e.endsWith(" argument")){i+=`${e} `}else{i+=`"${e}" ${e.includes(".")?"property":"argument"} `}i+="must be ";const s=[];const o=[];const a=[];for(const e of t){assert(typeof e==="string","All expected entries have to be of type string");if(l.includes(e)){s.push(e.toLowerCase())}else if(u.test(e)){o.push(e)}else{assert(e!=="object",'The value "object" should be written as "Object"');a.push(e)}}if(o.length>0){const e=s.indexOf("object");if(e!==-1){s.splice(s,e,1);o.push("Object")}}if(s.length>0){switch(s.length){case 1:i+=`of type ${s[0]}`;break;case 2:i+=`one of type ${s[0]} or ${s[1]}`;break;default:{const e=s.pop();i+=`one of type ${s.join(", ")}, or ${e}`}}if(o.length>0||a.length>0){i+=" or "}}if(o.length>0){switch(o.length){case 1:i+=`an instance of ${o[0]}`;break;case 2:i+=`an instance of ${o[0]} or ${o[1]}`;break;default:{const e=o.pop();i+=`an instance of ${o.join(", ")}, or ${e}`}}if(a.length>0){i+=" or "}}switch(a.length){case 0:break;case 1:if(a[0].toLowerCase()!==a[0]){i+="an "}i+=`${a[0]}`;break;case 2:i+=`one of ${a[0]} or ${a[1]}`;break;default:{const e=a.pop();i+=`one of ${a.join(", ")}, or ${e}`}}if(r==null){i+=`. Received ${r}`}else if(typeof r==="function"&&r.name){i+=`. Received function ${r.name}`}else if(typeof r==="object"){var c;if((c=r.constructor)!==null&&c!==undefined&&c.name){i+=`. Received an instance of ${r.constructor.name}`}else{const e=n(r,{depth:-1});i+=`. Received ${e}`}}else{let e=n(r,{colors:false});if(e.length>25){e=`${e.slice(0,25)}...`}i+=`. Received type ${typeof r} (${e})`}return i}),TypeError);E("ERR_INVALID_ARG_VALUE",((e,t,r="is invalid")=>{let i=n(t);if(i.length>128){i=i.slice(0,128)+"..."}const s=e.includes(".")?"property":"argument";return`The ${s} '${e}' ${r}. Received ${i}`}),TypeError);E("ERR_INVALID_RETURN_VALUE",((e,t,r)=>{var i;const n=r!==null&&r!==undefined&&(i=r.constructor)!==null&&i!==undefined&&i.name?`instance of ${r.constructor.name}`:`type ${typeof r}`;return`Expected ${e} to be returned from the "${t}"`+` function but got ${n}.`}),TypeError);E("ERR_MISSING_ARGS",((...e)=>{assert(e.length>0,"At least one arg needs to be specified");let t;const r=e.length;e=(Array.isArray(e)?e:[e]).map((e=>`"${e}"`)).join(" or ");switch(r){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}break}return`${t} must be specified`}),TypeError);E("ERR_OUT_OF_RANGE",((e,t,r)=>{assert(t,'Missing "range" argument');let i;if(Number.isInteger(r)&&Math.abs(r)>2**32){i=addNumericalSeparator(String(r))}else if(typeof r==="bigint"){i=String(r);if(r>2n**32n||r<-(2n**32n)){i=addNumericalSeparator(i)}i+="n"}else{i=n(r)}return`The value of "${e}" is out of range. It must be ${t}. Received ${i}`}),RangeError);E("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);E("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);E("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);E("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);E("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);E("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);E("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);E("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);E("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);E("ERR_STREAM_WRITE_AFTER_END","write after end",Error);E("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);e.exports={AbortError:AbortError,aggregateTwoErrors:hideStackFrames(aggregateTwoErrors),hideStackFrames:hideStackFrames,codes:h}},9943:(e,t,r)=>{"use strict";const i=r(2781);if(i&&process.env.READABLE_STREAM==="disable"){const t=i.promises;e.exports._uint8ArrayToBuffer=i._uint8ArrayToBuffer;e.exports._isUint8Array=i._isUint8Array;e.exports.isDisturbed=i.isDisturbed;e.exports.isErrored=i.isErrored;e.exports.isReadable=i.isReadable;e.exports.Readable=i.Readable;e.exports.Writable=i.Writable;e.exports.Duplex=i.Duplex;e.exports.Transform=i.Transform;e.exports.PassThrough=i.PassThrough;e.exports.addAbortSignal=i.addAbortSignal;e.exports.finished=i.finished;e.exports.destroy=i.destroy;e.exports.pipeline=i.pipeline;e.exports.compose=i.compose;Object.defineProperty(i,"promises",{configurable:true,enumerable:true,get(){return t}});e.exports.Stream=i.Stream}else{const t=r(178);const i=r(8061);const n=t.Readable.destroy;e.exports=t.Readable;e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer;e.exports._isUint8Array=t._isUint8Array;e.exports.isDisturbed=t.isDisturbed;e.exports.isErrored=t.isErrored;e.exports.isReadable=t.isReadable;e.exports.Readable=t.Readable;e.exports.Writable=t.Writable;e.exports.Duplex=t.Duplex;e.exports.Transform=t.Transform;e.exports.PassThrough=t.PassThrough;e.exports.addAbortSignal=t.addAbortSignal;e.exports.finished=t.finished;e.exports.destroy=t.destroy;e.exports.destroy=n;e.exports.pipeline=t.pipeline;e.exports.compose=t.compose;Object.defineProperty(t,"promises",{configurable:true,enumerable:true,get(){return i}});e.exports.Stream=t.Stream}e.exports["default"]=e.exports},7086:e=>{"use strict";e.exports={ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,t){return e.includes(t)},ArrayPrototypeIndexOf(e,t){return e.indexOf(t)},ArrayPrototypeJoin(e,t){return e.join(t)},ArrayPrototypeMap(e,t){return e.map(t)},ArrayPrototypePop(e,t){return e.pop(t)},ArrayPrototypePush(e,t){return e.push(t)},ArrayPrototypeSlice(e,t,r){return e.slice(t,r)},Error:Error,FunctionPrototypeCall(e,t,...r){return e.call(t,...r)},FunctionPrototypeSymbolHasInstance(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number:Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty(e,t,r){return Object.defineProperty(e,t,r)},ObjectGetOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,t){return Object.setPrototypeOf(e,t)},Promise:Promise,PromisePrototypeCatch(e,t){return e.catch(t)},PromisePrototypeThen(e,t,r){return e.then(t,r)},PromiseReject(e){return Promise.reject(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,t){return e.test(t)},SafeSet:Set,String:String,StringPrototypeSlice(e,t,r){return e.slice(t,r)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol:Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(e,t,r){return e.set(t,r)},Uint8Array:Uint8Array}},6911:(e,t,r)=>{"use strict";const i=r(4300);const n=Object.getPrototypeOf((async function(){})).constructor;const s=globalThis.Blob||i.Blob;const o=typeof s!=="undefined"?function isBlob(e){return e instanceof s}:function isBlob(e){return false};class AggregateError extends Error{constructor(e){if(!Array.isArray(e)){throw new TypeError(`Expected input to be an Array, got ${typeof e}`)}let t="";for(let r=0;r<e.length;r++){t+=`    ${e[r].stack}\n`}super(t);this.name="AggregateError";this.errors=e}}e.exports={AggregateError:AggregateError,kEmptyObject:Object.freeze({}),once(e){let t=false;return function(...r){if(t){return}t=true;e.apply(this,r)}},createDeferredPromise:function(){let e;let t;const r=new Promise(((r,i)=>{e=r;t=i}));return{promise:r,resolve:e,reject:t}},promisify(e){return new Promise(((t,r)=>{e(((e,...i)=>{if(e){return r(e)}return t(...i)}))}))},debuglog(){return function(){}},format(e,...t){return e.replace(/%([sdifj])/g,(function(...[e,r]){const i=t.shift();if(r==="f"){return i.toFixed(6)}else if(r==="j"){return JSON.stringify(i)}else if(r==="s"&&typeof i==="object"){const e=i.constructor!==Object?i.constructor.name:"";return`${e} {}`.trim()}else{return i.toString()}}))},inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"')){return`"${e}"`}else if(!e.includes("`")&&!e.includes("${")){return`\`${e}\``}}return`'${e}'`;case"number":if(isNaN(e)){return"NaN"}else if(Object.is(e,-0)){return String(e)}return e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction(e){return e instanceof n},isArrayBufferView(e){return ArrayBuffer.isView(e)}},isBlob:o};e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},178:(e,t,r)=>{const{Buffer:i}=r(4300);"use strict";const{ObjectDefineProperty:n,ObjectKeys:s,ReflectApply:o}=r(7086);const{promisify:{custom:a}}=r(6911);const{streamReturningOperators:l,promiseReturningOperators:u}=r(2366);const{codes:{ERR_ILLEGAL_CONSTRUCTOR:c}}=r(3304);const h=r(242);const{pipeline:d}=r(5759);const{destroyer:p}=r(6693);const b=r(7463);const g={};const _=r(8061);const m=r(1089);const y=e.exports=r(2019).Stream;y.isDisturbed=m.isDisturbed;y.isErrored=m.isErrored;y.isReadable=m.isReadable;y.Readable=r(2159);for(const e of s(l)){const t=l[e];function fn(...e){if(new.target){throw c()}return y.Readable.from(o(t,this,e))}n(fn,"name",{__proto__:null,value:t.name});n(fn,"length",{__proto__:null,value:t.length});n(y.Readable.prototype,e,{__proto__:null,value:fn,enumerable:false,configurable:true,writable:true})}for(const e of s(u)){const t=u[e];function fn(...e){if(new.target){throw c()}return o(t,this,e)}n(fn,"name",{__proto__:null,value:t.name});n(fn,"length",{__proto__:null,value:t.length});n(y.Readable.prototype,e,{__proto__:null,value:fn,enumerable:false,configurable:true,writable:true})}y.Writable=r(7649);y.Duplex=r(7545);y.Transform=r(6253);y.PassThrough=r(667);y.pipeline=d;const{addAbortSignal:w}=r(6364);y.addAbortSignal=w;y.finished=b;y.destroy=p;y.compose=h;n(y,"promises",{__proto__:null,configurable:true,enumerable:true,get(){return _}});n(d,a,{__proto__:null,enumerable:true,get(){return _.pipeline}});n(b,a,{__proto__:null,enumerable:true,get(){return _.finished}});y.Stream=y;y._isUint8Array=function isUint8Array(e){return e instanceof Uint8Array};y._uint8ArrayToBuffer=function _uint8ArrayToBuffer(e){return i.from(e.buffer,e.byteOffset,e.byteLength)}},8061:(e,t,r)=>{"use strict";const{ArrayPrototypePop:i,Promise:n}=r(7086);const{isIterable:s,isNodeStream:o,isWebStream:a}=r(1089);const{pipelineImpl:l}=r(5759);const{finished:u}=r(7463);r(178);function pipeline(...e){return new n(((t,r)=>{let n;let u;const c=e[e.length-1];if(c&&typeof c==="object"&&!o(c)&&!s(c)&&!a(c)){const t=i(e);n=t.signal;u=t.end}l(e,((e,i)=>{if(e){r(e)}else{t(i)}}),{signal:n,end:u})}))}e.exports={finished:u,pipeline:pipeline}},3212:e=>{var t=1e3;var r=t*60;var i=r*60;var n=i*24;var s=n*7;var o=n*365.25;e.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0){return parse(e)}else if(r==="number"&&isFinite(e)){return t.long?fmtLong(e):fmtShort(e)}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function parse(e){e=String(e);if(e.length>100){return}var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a){return}var l=parseFloat(a[1]);var u=(a[2]||"ms").toLowerCase();switch(u){case"years":case"year":case"yrs":case"yr":case"y":return l*o;case"weeks":case"week":case"w":return l*s;case"days":case"day":case"d":return l*n;case"hours":case"hour":case"hrs":case"hr":case"h":return l*i;case"minutes":case"minute":case"mins":case"min":case"m":return l*r;case"seconds":case"second":case"secs":case"sec":case"s":return l*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return undefined}}function fmtShort(e){var s=Math.abs(e);if(s>=n){return Math.round(e/n)+"d"}if(s>=i){return Math.round(e/i)+"h"}if(s>=r){return Math.round(e/r)+"m"}if(s>=t){return Math.round(e/t)+"s"}return e+"ms"}function fmtLong(e){var s=Math.abs(e);if(s>=n){return plural(e,s,n,"day")}if(s>=i){return plural(e,s,i,"hour")}if(s>=r){return plural(e,s,r,"minute")}if(s>=t){return plural(e,s,t,"second")}return e+" ms"}function plural(e,t,r,i){var n=t>=r*1.5;return Math.round(e/r)+" "+i+(n?"s":"")}},1543:(e,t,r)=>{const i=r(5370);e.exports.NumberAllocator=i},5370:(e,t,r)=>{"use strict";const i=r(8706).hU;const n=r(6248)("number-allocator:trace");const s=r(6248)("number-allocator:error");function Interval(e,t){this.low=e;this.high=t}Interval.prototype.equals=function(e){return this.low===e.low&&this.high===e.high};Interval.prototype.compare=function(e){if(this.low<e.low&&this.high<e.low)return-1;if(e.low<this.low&&e.high<this.low)return 1;return 0};function NumberAllocator(e,t){if(!(this instanceof NumberAllocator)){return new NumberAllocator(e,t)}this.min=e;this.max=t;this.ss=new i([],((e,t)=>e.compare(t)));n("Create");this.clear()}NumberAllocator.prototype.firstVacant=function(){if(this.ss.size()===0)return null;return this.ss.front().low};NumberAllocator.prototype.alloc=function(){if(this.ss.size()===0){n("alloc():empty");return null}const e=this.ss.begin();const t=e.pointer.low;const r=e.pointer.high;const i=t;if(i+1<=r){this.ss.updateKeyByIterator(e,new Interval(t+1,r))}else{this.ss.eraseElementByPos(0)}n("alloc():"+i);return i};NumberAllocator.prototype.use=function(e){const t=new Interval(e,e);const r=this.ss.lowerBound(t);if(!r.equals(this.ss.end())){const i=r.pointer.low;const s=r.pointer.high;if(r.pointer.equals(t)){this.ss.eraseElementByIterator(r);n("use():"+e);return true}if(i>e)return false;if(i===e){this.ss.updateKeyByIterator(r,new Interval(i+1,s));n("use():"+e);return true}if(s===e){this.ss.updateKeyByIterator(r,new Interval(i,s-1));n("use():"+e);return true}this.ss.updateKeyByIterator(r,new Interval(e+1,s));this.ss.insert(new Interval(i,e-1));n("use():"+e);return true}n("use():failed");return false};NumberAllocator.prototype.free=function(e){if(e<this.min||e>this.max){s("free():"+e+" is out of range");return}const t=new Interval(e,e);const r=this.ss.upperBound(t);if(r.equals(this.ss.end())){if(r.equals(this.ss.begin())){this.ss.insert(t);return}r.pre();const i=r.pointer.high;const n=r.pointer.high;if(n+1===e){this.ss.updateKeyByIterator(r,new Interval(i,e))}else{this.ss.insert(t)}}else{if(r.equals(this.ss.begin())){if(e+1===r.pointer.low){const t=r.pointer.high;this.ss.updateKeyByIterator(r,new Interval(e,t))}else{this.ss.insert(t)}}else{const i=r.pointer.low;const n=r.pointer.high;r.pre();const s=r.pointer.low;const o=r.pointer.high;if(o+1===e){if(e+1===i){this.ss.eraseElementByIterator(r);this.ss.updateKeyByIterator(r,new Interval(s,n))}else{this.ss.updateKeyByIterator(r,new Interval(s,e))}}else{if(e+1===i){this.ss.eraseElementByIterator(r.next());this.ss.insert(new Interval(e,n))}else{this.ss.insert(t)}}}}n("free():"+e)};NumberAllocator.prototype.clear=function(){n("clear()");this.ss.clear();this.ss.insert(new Interval(this.min,this.max))};NumberAllocator.prototype.intervalCount=function(){return this.ss.size()};NumberAllocator.prototype.dump=function(){console.log("length:"+this.ss.size());for(const e of this.ss){console.log(e)}};e.exports=NumberAllocator},3550:(e,t,r)=>{var i=r(3433);e.exports=i(once);e.exports.strict=i(onceStrict);once.proto=once((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return once(this)},configurable:true});Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return onceStrict(this)},configurable:true})}));function once(e){var f=function(){if(f.called)return f.value;f.called=true;return f.value=e.apply(this,arguments)};f.called=false;return f}function onceStrict(e){var f=function(){if(f.called)throw new Error(f.onceError);f.called=true;return f.value=e.apply(this,arguments)};var t=e.name||"Function wrapped with `once`";f.onceError=t+" shouldn't be called more than once";f.called=false;return f}},5951:e=>{"use strict";if(typeof process==="undefined"||!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0){e.exports={nextTick:nextTick}}else{e.exports=process}function nextTick(e,t,r,i){if(typeof e!=="function"){throw new TypeError('"callback" argument must be a function')}var n=arguments.length;var s,o;switch(n){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick((function afterTickOne(){e.call(null,t)}));case 3:return process.nextTick((function afterTickTwo(){e.call(null,t,r)}));case 4:return process.nextTick((function afterTickThree(){e.call(null,t,r,i)}));default:s=new Array(n-1);o=0;while(o<s.length){s[o++]=arguments[o]}return process.nextTick((function afterTick(){e.apply(null,s)}))}}},9929:e=>{e.exports=global.process},7715:e=>{"use strict";const t={};function createErrorType(e,r,i){if(!i){i=Error}function getMessage(e,t,i){if(typeof r==="string"){return r}else{return r(e,t,i)}}class NodeError extends i{constructor(e,t,r){super(getMessage(e,t,r))}}NodeError.prototype.name=i.name;NodeError.prototype.code=e;t[e]=NodeError}function oneOf(e,t){if(Array.isArray(e)){const r=e.length;e=e.map((e=>String(e)));if(r>2){return`one of ${t} ${e.slice(0,r-1).join(", ")}, or `+e[r-1]}else if(r===2){return`one of ${t} ${e[0]} or ${e[1]}`}else{return`of ${t} ${e[0]}`}}else{return`of ${t} ${String(e)}`}}function startsWith(e,t,r){return e.substr(!r||r<0?0:+r,t.length)===t}function endsWith(e,t,r){if(r===undefined||r>e.length){r=e.length}return e.substring(r-t.length,r)===t}function includes(e,t,r){if(typeof r!=="number"){r=0}if(r+t.length>e.length){return false}else{return e.indexOf(t,r)!==-1}}createErrorType("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError);createErrorType("ERR_INVALID_ARG_TYPE",(function(e,t,r){let i;if(typeof t==="string"&&startsWith(t,"not ")){i="must not be";t=t.replace(/^not /,"")}else{i="must be"}let n;if(endsWith(e," argument")){n=`The ${e} ${i} ${oneOf(t,"type")}`}else{const r=includes(e,".")?"property":"argument";n=`The "${e}" ${r} ${i} ${oneOf(t,"type")}`}n+=`. Received type ${typeof r}`;return n}),TypeError);createErrorType("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");createErrorType("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"}));createErrorType("ERR_STREAM_PREMATURE_CLOSE","Premature close");createErrorType("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"}));createErrorType("ERR_MULTIPLE_CALLBACK","Callback called multiple times");createErrorType("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end");createErrorType("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);createErrorType("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError);createErrorType("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");e.exports.q=t},8906:(e,t,r)=>{"use strict";var i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=Duplex;var n=r(1959);var s=r(2263);r(757)(Duplex,n);{var o=i(s.prototype);for(var a=0;a<o.length;a++){var l=o[a];if(!Duplex.prototype[l])Duplex.prototype[l]=s.prototype[l]}}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);n.call(this,e);s.call(this,e);this.allowHalfOpen=true;if(e){if(e.readable===false)this.readable=false;if(e.writable===false)this.writable=false;if(e.allowHalfOpen===false){this.allowHalfOpen=false;this.once("end",onend)}}}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:false,get:function get(){return this._writableState.highWaterMark}});Object.defineProperty(Duplex.prototype,"writableBuffer",{enumerable:false,get:function get(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Duplex.prototype,"writableLength",{enumerable:false,get:function get(){return this._writableState.length}});function onend(){if(this._writableState.ended)return;process.nextTick(onEndNT,this)}function onEndNT(e){e.end()}Object.defineProperty(Duplex.prototype,"destroyed",{enumerable:false,get:function get(){if(this._readableState===undefined||this._writableState===undefined){return false}return this._readableState.destroyed&&this._writableState.destroyed},set:function set(e){if(this._readableState===undefined||this._writableState===undefined){return}this._readableState.destroyed=e;this._writableState.destroyed=e}})},9856:(e,t,r)=>{"use strict";e.exports=PassThrough;var i=r(8859);r(757)(PassThrough,i);function PassThrough(e){if(!(this instanceof PassThrough))return new PassThrough(e);i.call(this,e)}PassThrough.prototype._transform=function(e,t,r){r(null,e)}},1959:(e,t,r)=>{"use strict";e.exports=Readable;var i;Readable.ReadableState=ReadableState;var n=r(2361).EventEmitter;var s=function EElistenerCount(e,t){return e.listeners(t).length};var o=r(3675);var a=r(4300).Buffer;var l=(typeof global!=="undefined"?global:typeof window!=="undefined"?window:typeof self!=="undefined"?self:{}).Uint8Array||function(){};function _uint8ArrayToBuffer(e){return a.from(e)}function _isUint8Array(e){return a.isBuffer(e)||e instanceof l}var u=r(3837);var c;if(u&&u.debuglog){c=u.debuglog("stream")}else{c=function debug(){}}var h=r(6039);var d=r(4564);var p=r(7711),b=p.getHighWaterMark;var g=r(7715).q,_=g.ERR_INVALID_ARG_TYPE,m=g.ERR_STREAM_PUSH_AFTER_EOF,y=g.ERR_METHOD_NOT_IMPLEMENTED,w=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;var S;var v;var k;r(757)(Readable,o);var T=d.errorOrDestroy;var R=["error","close","destroy","pause","resume"];function prependListener(e,t,r){if(typeof e.prependListener==="function")return e.prependListener(t,r);if(!e._events||!e._events[t])e.on(t,r);else if(Array.isArray(e._events[t]))e._events[t].unshift(r);else e._events[t]=[r,e._events[t]]}function ReadableState(e,t,n){i=i||r(8906);e=e||{};if(typeof n!=="boolean")n=t instanceof i;this.objectMode=!!e.objectMode;if(n)this.objectMode=this.objectMode||!!e.readableObjectMode;this.highWaterMark=b(this,e,"readableHighWaterMark",n);this.buffer=new h;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.paused=true;this.emitClose=e.emitClose!==false;this.autoDestroy=!!e.autoDestroy;this.destroyed=false;this.defaultEncoding=e.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(e.encoding){if(!S)S=r(8541).s;this.decoder=new S(e.encoding);this.encoding=e.encoding}}function Readable(e){i=i||r(8906);if(!(this instanceof Readable))return new Readable(e);var t=this instanceof i;this._readableState=new ReadableState(e,this,t);this.readable=true;if(e){if(typeof e.read==="function")this._read=e.read;if(typeof e.destroy==="function")this._destroy=e.destroy}o.call(this)}Object.defineProperty(Readable.prototype,"destroyed",{enumerable:false,get:function get(){if(this._readableState===undefined){return false}return this._readableState.destroyed},set:function set(e){if(!this._readableState){return}this._readableState.destroyed=e}});Readable.prototype.destroy=d.destroy;Readable.prototype._undestroy=d.undestroy;Readable.prototype._destroy=function(e,t){t(e)};Readable.prototype.push=function(e,t){var r=this._readableState;var i;if(!r.objectMode){if(typeof e==="string"){t=t||r.defaultEncoding;if(t!==r.encoding){e=a.from(e,t);t=""}i=true}}else{i=true}return readableAddChunk(this,e,t,false,i)};Readable.prototype.unshift=function(e){return readableAddChunk(this,e,null,true,false)};function readableAddChunk(e,t,r,i,n){c("readableAddChunk",t);var s=e._readableState;if(t===null){s.reading=false;onEofChunk(e,s)}else{var o;if(!n)o=chunkInvalid(s,t);if(o){T(e,o)}else if(s.objectMode||t&&t.length>0){if(typeof t!=="string"&&!s.objectMode&&Object.getPrototypeOf(t)!==a.prototype){t=_uint8ArrayToBuffer(t)}if(i){if(s.endEmitted)T(e,new w);else addChunk(e,s,t,true)}else if(s.ended){T(e,new m)}else if(s.destroyed){return false}else{s.reading=false;if(s.decoder&&!r){t=s.decoder.write(t);if(s.objectMode||t.length!==0)addChunk(e,s,t,false);else maybeReadMore(e,s)}else{addChunk(e,s,t,false)}}}else if(!i){s.reading=false;maybeReadMore(e,s)}}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function addChunk(e,t,r,i){if(t.flowing&&t.length===0&&!t.sync){t.awaitDrain=0;e.emit("data",r)}else{t.length+=t.objectMode?1:r.length;if(i)t.buffer.unshift(r);else t.buffer.push(r);if(t.needReadable)emitReadable(e)}maybeReadMore(e,t)}function chunkInvalid(e,t){var r;if(!_isUint8Array(t)&&typeof t!=="string"&&t!==undefined&&!e.objectMode){r=new _("chunk",["string","Buffer","Uint8Array"],t)}return r}Readable.prototype.isPaused=function(){return this._readableState.flowing===false};Readable.prototype.setEncoding=function(e){if(!S)S=r(8541).s;var t=new S(e);this._readableState.decoder=t;this._readableState.encoding=this._readableState.decoder.encoding;var i=this._readableState.buffer.head;var n="";while(i!==null){n+=t.write(i.data);i=i.next}this._readableState.buffer.clear();if(n!=="")this._readableState.buffer.push(n);this._readableState.length=n.length;return this};var A=1073741824;function computeNewHighWaterMark(e){if(e>=A){e=A}else{e--;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;e++}return e}function howMuchToRead(e,t){if(e<=0||t.length===0&&t.ended)return 0;if(t.objectMode)return 1;if(e!==e){if(t.flowing&&t.length)return t.buffer.head.data.length;else return t.length}if(e>t.highWaterMark)t.highWaterMark=computeNewHighWaterMark(e);if(e<=t.length)return e;if(!t.ended){t.needReadable=true;return 0}return t.length}Readable.prototype.read=function(e){c("read",e);e=parseInt(e,10);var t=this._readableState;var r=e;if(e!==0)t.emittedReadable=false;if(e===0&&t.needReadable&&((t.highWaterMark!==0?t.length>=t.highWaterMark:t.length>0)||t.ended)){c("read: emitReadable",t.length,t.ended);if(t.length===0&&t.ended)endReadable(this);else emitReadable(this);return null}e=howMuchToRead(e,t);if(e===0&&t.ended){if(t.length===0)endReadable(this);return null}var i=t.needReadable;c("need readable",i);if(t.length===0||t.length-e<t.highWaterMark){i=true;c("length less than watermark",i)}if(t.ended||t.reading){i=false;c("reading or ended",i)}else if(i){c("do read");t.reading=true;t.sync=true;if(t.length===0)t.needReadable=true;this._read(t.highWaterMark);t.sync=false;if(!t.reading)e=howMuchToRead(r,t)}var n;if(e>0)n=fromList(e,t);else n=null;if(n===null){t.needReadable=t.length<=t.highWaterMark;e=0}else{t.length-=e;t.awaitDrain=0}if(t.length===0){if(!t.ended)t.needReadable=true;if(r!==e&&t.ended)endReadable(this)}if(n!==null)this.emit("data",n);return n};function onEofChunk(e,t){c("onEofChunk");if(t.ended)return;if(t.decoder){var r=t.decoder.end();if(r&&r.length){t.buffer.push(r);t.length+=t.objectMode?1:r.length}}t.ended=true;if(t.sync){emitReadable(e)}else{t.needReadable=false;if(!t.emittedReadable){t.emittedReadable=true;emitReadable_(e)}}}function emitReadable(e){var t=e._readableState;c("emitReadable",t.needReadable,t.emittedReadable);t.needReadable=false;if(!t.emittedReadable){c("emitReadable",t.flowing);t.emittedReadable=true;process.nextTick(emitReadable_,e)}}function emitReadable_(e){var t=e._readableState;c("emitReadable_",t.destroyed,t.length,t.ended);if(!t.destroyed&&(t.length||t.ended)){e.emit("readable");t.emittedReadable=false}t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark;flow(e)}function maybeReadMore(e,t){if(!t.readingMore){t.readingMore=true;process.nextTick(maybeReadMore_,e,t)}}function maybeReadMore_(e,t){while(!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&t.length===0)){var r=t.length;c("maybeReadMore read 0");e.read(0);if(r===t.length)break}t.readingMore=false}Readable.prototype._read=function(e){T(this,new y("_read()"))};Readable.prototype.pipe=function(e,t){var r=this;var i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e);break}i.pipesCount+=1;c("pipe count=%d opts=%j",i.pipesCount,t);var n=(!t||t.end!==false)&&e!==process.stdout&&e!==process.stderr;var o=n?onend:unpipe;if(i.endEmitted)process.nextTick(o);else r.once("end",o);e.on("unpipe",onunpipe);function onunpipe(e,t){c("onunpipe");if(e===r){if(t&&t.hasUnpiped===false){t.hasUnpiped=true;cleanup()}}}function onend(){c("onend");e.end()}var a=pipeOnDrain(r);e.on("drain",a);var l=false;function cleanup(){c("cleanup");e.removeListener("close",onclose);e.removeListener("finish",onfinish);e.removeListener("drain",a);e.removeListener("error",onerror);e.removeListener("unpipe",onunpipe);r.removeListener("end",onend);r.removeListener("end",unpipe);r.removeListener("data",ondata);l=true;if(i.awaitDrain&&(!e._writableState||e._writableState.needDrain))a()}r.on("data",ondata);function ondata(t){c("ondata");var n=e.write(t);c("dest.write",n);if(n===false){if((i.pipesCount===1&&i.pipes===e||i.pipesCount>1&&indexOf(i.pipes,e)!==-1)&&!l){c("false write response, pause",i.awaitDrain);i.awaitDrain++}r.pause()}}function onerror(t){c("onerror",t);unpipe();e.removeListener("error",onerror);if(s(e,"error")===0)T(e,t)}prependListener(e,"error",onerror);function onclose(){e.removeListener("finish",onfinish);unpipe()}e.once("close",onclose);function onfinish(){c("onfinish");e.removeListener("close",onclose);unpipe()}e.once("finish",onfinish);function unpipe(){c("unpipe");r.unpipe(e)}e.emit("pipe",r);if(!i.flowing){c("pipe resume");r.resume()}return e};function pipeOnDrain(e){return function pipeOnDrainFunctionResult(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain);if(t.awaitDrain)t.awaitDrain--;if(t.awaitDrain===0&&s(e,"data")){t.flowing=true;flow(e)}}}Readable.prototype.unpipe=function(e){var t=this._readableState;var r={hasUnpiped:false};if(t.pipesCount===0)return this;if(t.pipesCount===1){if(e&&e!==t.pipes)return this;if(!e)e=t.pipes;t.pipes=null;t.pipesCount=0;t.flowing=false;if(e)e.emit("unpipe",this,r);return this}if(!e){var i=t.pipes;var n=t.pipesCount;t.pipes=null;t.pipesCount=0;t.flowing=false;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:false});return this}var o=indexOf(t.pipes,e);if(o===-1)return this;t.pipes.splice(o,1);t.pipesCount-=1;if(t.pipesCount===1)t.pipes=t.pipes[0];e.emit("unpipe",this,r);return this};Readable.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t);var i=this._readableState;if(e==="data"){i.readableListening=this.listenerCount("readable")>0;if(i.flowing!==false)this.resume()}else if(e==="readable"){if(!i.endEmitted&&!i.readableListening){i.readableListening=i.needReadable=true;i.flowing=false;i.emittedReadable=false;c("on readable",i.length,i.reading);if(i.length){emitReadable(this)}else if(!i.reading){process.nextTick(nReadingNextTick,this)}}}return r};Readable.prototype.addListener=Readable.prototype.on;Readable.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);if(e==="readable"){process.nextTick(updateReadableListening,this)}return r};Readable.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);if(e==="readable"||e===undefined){process.nextTick(updateReadableListening,this)}return t};function updateReadableListening(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0;if(t.resumeScheduled&&!t.paused){t.flowing=true}else if(e.listenerCount("data")>0){e.resume()}}function nReadingNextTick(e){c("readable nexttick read 0");e.read(0)}Readable.prototype.resume=function(){var e=this._readableState;if(!e.flowing){c("resume");e.flowing=!e.readableListening;resume(this,e)}e.paused=false;return this};function resume(e,t){if(!t.resumeScheduled){t.resumeScheduled=true;process.nextTick(resume_,e,t)}}function resume_(e,t){c("resume",t.reading);if(!t.reading){e.read(0)}t.resumeScheduled=false;e.emit("resume");flow(e);if(t.flowing&&!t.reading)e.read(0)}Readable.prototype.pause=function(){c("call pause flowing=%j",this._readableState.flowing);if(this._readableState.flowing!==false){c("pause");this._readableState.flowing=false;this.emit("pause")}this._readableState.paused=true;return this};function flow(e){var t=e._readableState;c("flow",t.flowing);while(t.flowing&&e.read()!==null);}Readable.prototype.wrap=function(e){var t=this;var r=this._readableState;var i=false;e.on("end",(function(){c("wrapped end");if(r.decoder&&!r.ended){var e=r.decoder.end();if(e&&e.length)t.push(e)}t.push(null)}));e.on("data",(function(n){c("wrapped data");if(r.decoder)n=r.decoder.write(n);if(r.objectMode&&(n===null||n===undefined))return;else if(!r.objectMode&&(!n||!n.length))return;var s=t.push(n);if(!s){i=true;e.pause()}}));for(var n in e){if(this[n]===undefined&&typeof e[n]==="function"){this[n]=function methodWrap(t){return function methodWrapReturnFunction(){return e[t].apply(e,arguments)}}(n)}}for(var s=0;s<R.length;s++){e.on(R[s],this.emit.bind(this,R[s]))}this._read=function(t){c("wrapped _read",t);if(i){i=false;e.resume()}};return this};if(typeof Symbol==="function"){Readable.prototype[Symbol.asyncIterator]=function(){if(v===undefined){v=r(8567)}return v(this)}}Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:false,get:function get(){return this._readableState.highWaterMark}});Object.defineProperty(Readable.prototype,"readableBuffer",{enumerable:false,get:function get(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Readable.prototype,"readableFlowing",{enumerable:false,get:function get(){return this._readableState.flowing},set:function set(e){if(this._readableState){this._readableState.flowing=e}}});Readable._fromList=fromList;Object.defineProperty(Readable.prototype,"readableLength",{enumerable:false,get:function get(){return this._readableState.length}});function fromList(e,t){if(t.length===0)return null;var r;if(t.objectMode)r=t.buffer.shift();else if(!e||e>=t.length){if(t.decoder)r=t.buffer.join("");else if(t.buffer.length===1)r=t.buffer.first();else r=t.buffer.concat(t.length);t.buffer.clear()}else{r=t.buffer.consume(e,t.decoder)}return r}function endReadable(e){var t=e._readableState;c("endReadable",t.endEmitted);if(!t.endEmitted){t.ended=true;process.nextTick(endReadableNT,t,e)}}function endReadableNT(e,t){c("endReadableNT",e.endEmitted,e.length);if(!e.endEmitted&&e.length===0){e.endEmitted=true;t.readable=false;t.emit("end");if(e.autoDestroy){var r=t._writableState;if(!r||r.autoDestroy&&r.finished){t.destroy()}}}}if(typeof Symbol==="function"){Readable.from=function(e,t){if(k===undefined){k=r(779)}return k(Readable,e,t)}}function indexOf(e,t){for(var r=0,i=e.length;r<i;r++){if(e[r]===t)return r}return-1}},8859:(e,t,r)=>{"use strict";e.exports=Transform;var i=r(7715).q,n=i.ERR_METHOD_NOT_IMPLEMENTED,s=i.ERR_MULTIPLE_CALLBACK,o=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=i.ERR_TRANSFORM_WITH_LENGTH_0;var l=r(8906);r(757)(Transform,l);function afterTransform(e,t){var r=this._transformState;r.transforming=false;var i=r.writecb;if(i===null){return this.emit("error",new s)}r.writechunk=null;r.writecb=null;if(t!=null)this.push(t);i(e);var n=this._readableState;n.reading=false;if(n.needReadable||n.length<n.highWaterMark){this._read(n.highWaterMark)}}function Transform(e){if(!(this instanceof Transform))return new Transform(e);l.call(this,e);this._transformState={afterTransform:afterTransform.bind(this),needTransform:false,transforming:false,writecb:null,writechunk:null,writeencoding:null};this._readableState.needReadable=true;this._readableState.sync=false;if(e){if(typeof e.transform==="function")this._transform=e.transform;if(typeof e.flush==="function")this._flush=e.flush}this.on("prefinish",prefinish)}function prefinish(){var e=this;if(typeof this._flush==="function"&&!this._readableState.destroyed){this._flush((function(t,r){done(e,t,r)}))}else{done(this,null,null)}}Transform.prototype.push=function(e,t){this._transformState.needTransform=false;return l.prototype.push.call(this,e,t)};Transform.prototype._transform=function(e,t,r){r(new n("_transform()"))};Transform.prototype._write=function(e,t,r){var i=this._transformState;i.writecb=r;i.writechunk=e;i.writeencoding=t;if(!i.transforming){var n=this._readableState;if(i.needTransform||n.needReadable||n.length<n.highWaterMark)this._read(n.highWaterMark)}};Transform.prototype._read=function(e){var t=this._transformState;if(t.writechunk!==null&&!t.transforming){t.transforming=true;this._transform(t.writechunk,t.writeencoding,t.afterTransform)}else{t.needTransform=true}};Transform.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))};function done(e,t,r){if(t)return e.emit("error",t);if(r!=null)e.push(r);if(e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}},2263:(e,t,r)=>{"use strict";e.exports=Writable;function WriteReq(e,t,r){this.chunk=e;this.encoding=t;this.callback=r;this.next=null}function CorkedRequest(e){var t=this;this.next=null;this.entry=null;this.finish=function(){onCorkedFinish(t,e)}}var i;Writable.WritableState=WritableState;var n={deprecate:r(637)};var s=r(3675);var o=r(4300).Buffer;var a=(typeof global!=="undefined"?global:typeof window!=="undefined"?window:typeof self!=="undefined"?self:{}).Uint8Array||function(){};function _uint8ArrayToBuffer(e){return o.from(e)}function _isUint8Array(e){return o.isBuffer(e)||e instanceof a}var l=r(4564);var u=r(7711),c=u.getHighWaterMark;var h=r(7715).q,d=h.ERR_INVALID_ARG_TYPE,p=h.ERR_METHOD_NOT_IMPLEMENTED,b=h.ERR_MULTIPLE_CALLBACK,g=h.ERR_STREAM_CANNOT_PIPE,_=h.ERR_STREAM_DESTROYED,m=h.ERR_STREAM_NULL_VALUES,y=h.ERR_STREAM_WRITE_AFTER_END,w=h.ERR_UNKNOWN_ENCODING;var S=l.errorOrDestroy;r(757)(Writable,s);function nop(){}function WritableState(e,t,n){i=i||r(8906);e=e||{};if(typeof n!=="boolean")n=t instanceof i;this.objectMode=!!e.objectMode;if(n)this.objectMode=this.objectMode||!!e.writableObjectMode;this.highWaterMark=c(this,e,"writableHighWaterMark",n);this.finalCalled=false;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;this.destroyed=false;var s=e.decodeStrings===false;this.decodeStrings=!s;this.defaultEncoding=e.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(e){onwrite(t,e)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.emitClose=e.emitClose!==false;this.autoDestroy=!!e.autoDestroy;this.bufferedRequestCount=0;this.corkedRequestsFree=new CorkedRequest(this)}WritableState.prototype.getBuffer=function getBuffer(){var e=this.bufferedRequest;var t=[];while(e){t.push(e);e=e.next}return t};(function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:n.deprecate((function writableStateBufferGetter(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}})();var v;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){v=Function.prototype[Symbol.hasInstance];Object.defineProperty(Writable,Symbol.hasInstance,{value:function value(e){if(v.call(this,e))return true;if(this!==Writable)return false;return e&&e._writableState instanceof WritableState}})}else{v=function realHasInstance(e){return e instanceof this}}function Writable(e){i=i||r(8906);var t=this instanceof i;if(!t&&!v.call(Writable,this))return new Writable(e);this._writableState=new WritableState(e,this,t);this.writable=true;if(e){if(typeof e.write==="function")this._write=e.write;if(typeof e.writev==="function")this._writev=e.writev;if(typeof e.destroy==="function")this._destroy=e.destroy;if(typeof e.final==="function")this._final=e.final}s.call(this)}Writable.prototype.pipe=function(){S(this,new g)};function writeAfterEnd(e,t){var r=new y;S(e,r);process.nextTick(t,r)}function validChunk(e,t,r,i){var n;if(r===null){n=new m}else if(typeof r!=="string"&&!t.objectMode){n=new d("chunk",["string","Buffer"],r)}if(n){S(e,n);process.nextTick(i,n);return false}return true}Writable.prototype.write=function(e,t,r){var i=this._writableState;var n=false;var s=!i.objectMode&&_isUint8Array(e);if(s&&!o.isBuffer(e)){e=_uint8ArrayToBuffer(e)}if(typeof t==="function"){r=t;t=null}if(s)t="buffer";else if(!t)t=i.defaultEncoding;if(typeof r!=="function")r=nop;if(i.ending)writeAfterEnd(this,r);else if(s||validChunk(this,i,e,r)){i.pendingcb++;n=writeOrBuffer(this,i,s,e,t,r)}return n};Writable.prototype.cork=function(){this._writableState.corked++};Writable.prototype.uncork=function(){var e=this._writableState;if(e.corked){e.corked--;if(!e.writing&&!e.corked&&!e.bufferProcessing&&e.bufferedRequest)clearBuffer(this,e)}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(e){if(typeof e==="string")e=e.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);this._writableState.defaultEncoding=e;return this};Object.defineProperty(Writable.prototype,"writableBuffer",{enumerable:false,get:function get(){return this._writableState&&this._writableState.getBuffer()}});function decodeChunk(e,t,r){if(!e.objectMode&&e.decodeStrings!==false&&typeof t==="string"){t=o.from(t,r)}return t}Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:false,get:function get(){return this._writableState.highWaterMark}});function writeOrBuffer(e,t,r,i,n,s){if(!r){var o=decodeChunk(t,i,n);if(i!==o){r=true;n="buffer";i=o}}var a=t.objectMode?1:i.length;t.length+=a;var l=t.length<t.highWaterMark;if(!l)t.needDrain=true;if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null};if(u){u.next=t.lastBufferedRequest}else{t.bufferedRequest=t.lastBufferedRequest}t.bufferedRequestCount+=1}else{doWrite(e,t,false,a,i,n,s)}return l}function doWrite(e,t,r,i,n,s,o){t.writelen=i;t.writecb=o;t.writing=true;t.sync=true;if(t.destroyed)t.onwrite(new _("write"));else if(r)e._writev(n,t.onwrite);else e._write(n,s,t.onwrite);t.sync=false}function onwriteError(e,t,r,i,n){--t.pendingcb;if(r){process.nextTick(n,i);process.nextTick(finishMaybe,e,t);e._writableState.errorEmitted=true;S(e,i)}else{n(i);e._writableState.errorEmitted=true;S(e,i);finishMaybe(e,t)}}function onwriteStateUpdate(e){e.writing=false;e.writecb=null;e.length-=e.writelen;e.writelen=0}function onwrite(e,t){var r=e._writableState;var i=r.sync;var n=r.writecb;if(typeof n!=="function")throw new b;onwriteStateUpdate(r);if(t)onwriteError(e,r,i,t,n);else{var s=needFinish(r)||e.destroyed;if(!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest){clearBuffer(e,r)}if(i){process.nextTick(afterWrite,e,r,s,n)}else{afterWrite(e,r,s,n)}}}function afterWrite(e,t,r,i){if(!r)onwriteDrain(e,t);t.pendingcb--;i();finishMaybe(e,t)}function onwriteDrain(e,t){if(t.length===0&&t.needDrain){t.needDrain=false;e.emit("drain")}}function clearBuffer(e,t){t.bufferProcessing=true;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount;var n=new Array(i);var s=t.corkedRequestsFree;s.entry=r;var o=0;var a=true;while(r){n[o]=r;if(!r.isBuf)a=false;r=r.next;o+=1}n.allBuffers=a;doWrite(e,t,true,t.length,n,"",s.finish);t.pendingcb++;t.lastBufferedRequest=null;if(s.next){t.corkedRequestsFree=s.next;s.next=null}else{t.corkedRequestsFree=new CorkedRequest(t)}t.bufferedRequestCount=0}else{while(r){var l=r.chunk;var u=r.encoding;var c=r.callback;var h=t.objectMode?1:l.length;doWrite(e,t,false,h,l,u,c);r=r.next;t.bufferedRequestCount--;if(t.writing){break}}if(r===null)t.lastBufferedRequest=null}t.bufferedRequest=r;t.bufferProcessing=false}Writable.prototype._write=function(e,t,r){r(new p("_write()"))};Writable.prototype._writev=null;Writable.prototype.end=function(e,t,r){var i=this._writableState;if(typeof e==="function"){r=e;e=null;t=null}else if(typeof t==="function"){r=t;t=null}if(e!==null&&e!==undefined)this.write(e,t);if(i.corked){i.corked=1;this.uncork()}if(!i.ending)endWritable(this,i,r);return this};Object.defineProperty(Writable.prototype,"writableLength",{enumerable:false,get:function get(){return this._writableState.length}});function needFinish(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function callFinal(e,t){e._final((function(r){t.pendingcb--;if(r){S(e,r)}t.prefinished=true;e.emit("prefinish");finishMaybe(e,t)}))}function prefinish(e,t){if(!t.prefinished&&!t.finalCalled){if(typeof e._final==="function"&&!t.destroyed){t.pendingcb++;t.finalCalled=true;process.nextTick(callFinal,e,t)}else{t.prefinished=true;e.emit("prefinish")}}}function finishMaybe(e,t){var r=needFinish(t);if(r){prefinish(e,t);if(t.pendingcb===0){t.finished=true;e.emit("finish");if(t.autoDestroy){var i=e._readableState;if(!i||i.autoDestroy&&i.endEmitted){e.destroy()}}}}return r}function endWritable(e,t,r){t.ending=true;finishMaybe(e,t);if(r){if(t.finished)process.nextTick(r);else e.once("finish",r)}t.ended=true;e.writable=false}function onCorkedFinish(e,t,r){var i=e.entry;e.entry=null;while(i){var n=i.callback;t.pendingcb--;n(r);i=i.next}t.corkedRequestsFree.next=e}Object.defineProperty(Writable.prototype,"destroyed",{enumerable:false,get:function get(){if(this._writableState===undefined){return false}return this._writableState.destroyed},set:function set(e){if(!this._writableState){return}this._writableState.destroyed=e}});Writable.prototype.destroy=l.destroy;Writable.prototype._undestroy=l.undestroy;Writable.prototype._destroy=function(e,t){t(e)}},8567:(e,t,r)=>{"use strict";var i;function _defineProperty(e,t,r){t=_toPropertyKey(t);if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t==="symbol"?t:String(t)}function _toPrimitive(e,t){if(typeof e!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var i=r.call(e,t||"default");if(typeof i!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n=r(4503);var s=Symbol("lastResolve");var o=Symbol("lastReject");var a=Symbol("error");var l=Symbol("ended");var u=Symbol("lastPromise");var c=Symbol("handlePromise");var h=Symbol("stream");function createIterResult(e,t){return{value:e,done:t}}function readAndResolve(e){var t=e[s];if(t!==null){var r=e[h].read();if(r!==null){e[u]=null;e[s]=null;e[o]=null;t(createIterResult(r,false))}}}function onReadable(e){process.nextTick(readAndResolve,e)}function wrapForNext(e,t){return function(r,i){e.then((function(){if(t[l]){r(createIterResult(undefined,true));return}t[c](r,i)}),i)}}var d=Object.getPrototypeOf((function(){}));var p=Object.setPrototypeOf((i={get stream(){return this[h]},next:function next(){var e=this;var t=this[a];if(t!==null){return Promise.reject(t)}if(this[l]){return Promise.resolve(createIterResult(undefined,true))}if(this[h].destroyed){return new Promise((function(t,r){process.nextTick((function(){if(e[a]){r(e[a])}else{t(createIterResult(undefined,true))}}))}))}var r=this[u];var i;if(r){i=new Promise(wrapForNext(r,this))}else{var n=this[h].read();if(n!==null){return Promise.resolve(createIterResult(n,false))}i=new Promise(this[c])}this[u]=i;return i}},_defineProperty(i,Symbol.asyncIterator,(function(){return this})),_defineProperty(i,"return",(function _return(){var e=this;return new Promise((function(t,r){e[h].destroy(null,(function(e){if(e){r(e);return}t(createIterResult(undefined,true))}))}))})),i),d);var b=function createReadableStreamAsyncIterator(e){var t;var r=Object.create(p,(t={},_defineProperty(t,h,{value:e,writable:true}),_defineProperty(t,s,{value:null,writable:true}),_defineProperty(t,o,{value:null,writable:true}),_defineProperty(t,a,{value:null,writable:true}),_defineProperty(t,l,{value:e._readableState.endEmitted,writable:true}),_defineProperty(t,c,{value:function value(e,t){var i=r[h].read();if(i){r[u]=null;r[s]=null;r[o]=null;e(createIterResult(i,false))}else{r[s]=e;r[o]=t}},writable:true}),t));r[u]=null;n(e,(function(e){if(e&&e.code!=="ERR_STREAM_PREMATURE_CLOSE"){var t=r[o];if(t!==null){r[u]=null;r[s]=null;r[o]=null;t(e)}r[a]=e;return}var i=r[s];if(i!==null){r[u]=null;r[s]=null;r[o]=null;i(createIterResult(undefined,true))}r[l]=true}));e.on("readable",onReadable.bind(null,r));return r};e.exports=b},6039:(e,t,r)=>{"use strict";function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){t=_toPropertyKey(t);if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){if(t)_defineProperties(e.prototype,t);if(r)_defineProperties(e,r);Object.defineProperty(e,"prototype",{writable:false});return e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t==="symbol"?t:String(t)}function _toPrimitive(e,t){if(typeof e!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var i=r.call(e,t||"default");if(typeof i!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i=r(4300),n=i.Buffer;var s=r(3837),o=s.inspect;var a=o&&o.custom||"inspect";function copyBuffer(e,t,r){n.prototype.copy.call(e,t,r)}e.exports=function(){function BufferList(){_classCallCheck(this,BufferList);this.head=null;this.tail=null;this.length=0}_createClass(BufferList,[{key:"push",value:function push(e){var t={data:e,next:null};if(this.length>0)this.tail.next=t;else this.head=t;this.tail=t;++this.length}},{key:"unshift",value:function unshift(e){var t={data:e,next:this.head};if(this.length===0)this.tail=t;this.head=t;++this.length}},{key:"shift",value:function shift(){if(this.length===0)return;var e=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return e}},{key:"clear",value:function clear(){this.head=this.tail=null;this.length=0}},{key:"join",value:function join(e){if(this.length===0)return"";var t=this.head;var r=""+t.data;while(t=t.next)r+=e+t.data;return r}},{key:"concat",value:function concat(e){if(this.length===0)return n.alloc(0);var t=n.allocUnsafe(e>>>0);var r=this.head;var i=0;while(r){copyBuffer(r.data,t,i);i+=r.data.length;r=r.next}return t}},{key:"consume",value:function consume(e,t){var r;if(e<this.head.data.length){r=this.head.data.slice(0,e);this.head.data=this.head.data.slice(e)}else if(e===this.head.data.length){r=this.shift()}else{r=t?this._getString(e):this._getBuffer(e)}return r}},{key:"first",value:function first(){return this.head.data}},{key:"_getString",value:function _getString(e){var t=this.head;var r=1;var i=t.data;e-=i.length;while(t=t.next){var n=t.data;var s=e>n.length?n.length:e;if(s===n.length)i+=n;else i+=n.slice(0,e);e-=s;if(e===0){if(s===n.length){++r;if(t.next)this.head=t.next;else this.head=this.tail=null}else{this.head=t;t.data=n.slice(s)}break}++r}this.length-=r;return i}},{key:"_getBuffer",value:function _getBuffer(e){var t=n.allocUnsafe(e);var r=this.head;var i=1;r.data.copy(t);e-=r.data.length;while(r=r.next){var s=r.data;var o=e>s.length?s.length:e;s.copy(t,t.length-e,0,o);e-=o;if(e===0){if(o===s.length){++i;if(r.next)this.head=r.next;else this.head=this.tail=null}else{this.head=r;r.data=s.slice(o)}break}++i}this.length-=i;return t}},{key:a,value:function value(e,t){return o(this,_objectSpread(_objectSpread({},t),{},{depth:0,customInspect:false}))}}]);return BufferList}()},4564:e=>{"use strict";function destroy(e,t){var r=this;var i=this._readableState&&this._readableState.destroyed;var n=this._writableState&&this._writableState.destroyed;if(i||n){if(t){t(e)}else if(e){if(!this._writableState){process.nextTick(emitErrorNT,this,e)}else if(!this._writableState.errorEmitted){this._writableState.errorEmitted=true;process.nextTick(emitErrorNT,this,e)}}return this}if(this._readableState){this._readableState.destroyed=true}if(this._writableState){this._writableState.destroyed=true}this._destroy(e||null,(function(e){if(!t&&e){if(!r._writableState){process.nextTick(emitErrorAndCloseNT,r,e)}else if(!r._writableState.errorEmitted){r._writableState.errorEmitted=true;process.nextTick(emitErrorAndCloseNT,r,e)}else{process.nextTick(emitCloseNT,r)}}else if(t){process.nextTick(emitCloseNT,r);t(e)}else{process.nextTick(emitCloseNT,r)}}));return this}function emitErrorAndCloseNT(e,t){emitErrorNT(e,t);emitCloseNT(e)}function emitCloseNT(e){if(e._writableState&&!e._writableState.emitClose)return;if(e._readableState&&!e._readableState.emitClose)return;e.emit("close")}function undestroy(){if(this._readableState){this._readableState.destroyed=false;this._readableState.reading=false;this._readableState.ended=false;this._readableState.endEmitted=false}if(this._writableState){this._writableState.destroyed=false;this._writableState.ended=false;this._writableState.ending=false;this._writableState.finalCalled=false;this._writableState.prefinished=false;this._writableState.finished=false;this._writableState.errorEmitted=false}}function emitErrorNT(e,t){e.emit("error",t)}function errorOrDestroy(e,t){var r=e._readableState;var i=e._writableState;if(r&&r.autoDestroy||i&&i.autoDestroy)e.destroy(t);else e.emit("error",t)}e.exports={destroy:destroy,undestroy:undestroy,errorOrDestroy:errorOrDestroy}},4503:(e,t,r)=>{"use strict";var i=r(7715).q.ERR_STREAM_PREMATURE_CLOSE;function once(e){var t=false;return function(){if(t)return;t=true;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++){i[n]=arguments[n]}e.apply(this,i)}}function noop(){}function isRequest(e){return e.setHeader&&typeof e.abort==="function"}function eos(e,t,r){if(typeof t==="function")return eos(e,null,t);if(!t)t={};r=once(r||noop);var n=t.readable||t.readable!==false&&e.readable;var s=t.writable||t.writable!==false&&e.writable;var o=function onlegacyfinish(){if(!e.writable)l()};var a=e._writableState&&e._writableState.finished;var l=function onfinish(){s=false;a=true;if(!n)r.call(e)};var u=e._readableState&&e._readableState.endEmitted;var c=function onend(){n=false;u=true;if(!s)r.call(e)};var h=function onerror(t){r.call(e,t)};var d=function onclose(){var t;if(n&&!u){if(!e._readableState||!e._readableState.ended)t=new i;return r.call(e,t)}if(s&&!a){if(!e._writableState||!e._writableState.ended)t=new i;return r.call(e,t)}};var p=function onrequest(){e.req.on("finish",l)};if(isRequest(e)){e.on("complete",l);e.on("abort",d);if(e.req)p();else e.on("request",p)}else if(s&&!e._writableState){e.on("end",o);e.on("close",o)}e.on("end",c);e.on("finish",l);if(t.error!==false)e.on("error",h);e.on("close",d);return function(){e.removeListener("complete",l);e.removeListener("abort",d);e.removeListener("request",p);if(e.req)e.req.removeListener("finish",l);e.removeListener("end",o);e.removeListener("close",o);e.removeListener("finish",l);e.removeListener("end",c);e.removeListener("error",h);e.removeListener("close",d)}}e.exports=eos},779:(e,t,r)=>{"use strict";function asyncGeneratorStep(e,t,r,i,n,s,o){try{var a=e[s](o);var l=a.value}catch(e){r(e);return}if(a.done){t(l)}else{Promise.resolve(l).then(i,n)}}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var s=e.apply(t,r);function _next(e){asyncGeneratorStep(s,i,n,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(s,i,n,_next,_throw,"throw",e)}_next(undefined)}))}}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){t=_toPropertyKey(t);if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t==="symbol"?t:String(t)}function _toPrimitive(e,t){if(typeof e!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var i=r.call(e,t||"default");if(typeof i!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i=r(7715).q.ERR_INVALID_ARG_TYPE;function from(e,t,r){var n;if(t&&typeof t.next==="function"){n=t}else if(t&&t[Symbol.asyncIterator])n=t[Symbol.asyncIterator]();else if(t&&t[Symbol.iterator])n=t[Symbol.iterator]();else throw new i("iterable",["Iterable"],t);var s=new e(_objectSpread({objectMode:true},r));var o=false;s._read=function(){if(!o){o=true;next()}};function next(){return _next2.apply(this,arguments)}function _next2(){_next2=_asyncToGenerator((function*(){try{var e=yield n.next(),t=e.value,r=e.done;if(r){s.push(null)}else if(s.push(yield t)){next()}else{o=false}}catch(e){s.destroy(e)}}));return _next2.apply(this,arguments)}return s}e.exports=from},7355:(e,t,r)=>{"use strict";var i;function once(e){var t=false;return function(){if(t)return;t=true;e.apply(void 0,arguments)}}var n=r(7715).q,s=n.ERR_MISSING_ARGS,o=n.ERR_STREAM_DESTROYED;function noop(e){if(e)throw e}function isRequest(e){return e.setHeader&&typeof e.abort==="function"}function destroyer(e,t,n,s){s=once(s);var a=false;e.on("close",(function(){a=true}));if(i===undefined)i=r(4503);i(e,{readable:t,writable:n},(function(e){if(e)return s(e);a=true;s()}));var l=false;return function(t){if(a)return;if(l)return;l=true;if(isRequest(e))return e.abort();if(typeof e.destroy==="function")return e.destroy();s(t||new o("pipe"))}}function call(e){e()}function pipe(e,t){return e.pipe(t)}function popCallback(e){if(!e.length)return noop;if(typeof e[e.length-1]!=="function")return noop;return e.pop()}function pipeline(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}var i=popCallback(t);if(Array.isArray(t[0]))t=t[0];if(t.length<2){throw new s("streams")}var n;var o=t.map((function(e,r){var s=r<t.length-1;var a=r>0;return destroyer(e,s,a,(function(e){if(!n)n=e;if(e)o.forEach(call);if(s)return;o.forEach(call);i(n)}))}));return t.reduce(pipe)}e.exports=pipeline},7711:(e,t,r)=>{"use strict";var i=r(7715).q.ERR_INVALID_OPT_VALUE;function highWaterMarkFrom(e,t,r){return e.highWaterMark!=null?e.highWaterMark:t?e[r]:null}function getHighWaterMark(e,t,r,n){var s=highWaterMarkFrom(t,n,r);if(s!=null){if(!(isFinite(s)&&Math.floor(s)===s)||s<0){var o=n?r:"highWaterMark";throw new i(o,s)}return Math.floor(s)}return e.objectMode?16:16*1024}e.exports={getHighWaterMark:getHighWaterMark}},3675:(e,t,r)=>{e.exports=r(2781)},1621:(e,t,r)=>{var i=r(2781);if(process.env.READABLE_STREAM==="disable"&&i){e.exports=i.Readable;Object.assign(e.exports,i);e.exports.Stream=i}else{t=e.exports=r(1959);t.Stream=i||t;t.Readable=t;t.Writable=r(2263);t.Duplex=r(8906);t.Transform=r(8859);t.PassThrough=r(9856);t.finished=r(4503);t.pipeline=r(7355)}},590:e=>{"use strict";function ReInterval(e,t,r){var i=this;this._callback=e;this._args=r;this._interval=setInterval(e,t,this._args);this.reschedule=function(e){if(!e)e=i._interval;if(i._interval)clearInterval(i._interval);i._interval=setInterval(i._callback,e,i._args)};this.clear=function(){if(i._interval){clearInterval(i._interval);i._interval=undefined}};this.destroy=function(){if(i._interval){clearInterval(i._interval)}i._callback=undefined;i._interval=undefined;i._args=undefined}}function reInterval(){if(typeof arguments[0]!=="function")throw new Error("callback needed");if(typeof arguments[1]!=="number")throw new Error("interval needed");var e;if(arguments.length>0){e=new Array(arguments.length-2);for(var t=0;t<e.length;t++){e[t]=arguments[t+2]}}return new ReInterval(arguments[0],arguments[1],e)}e.exports=reInterval},7114:(e,t,r)=>{"use strict";e.exports=r(7597)()},7597:e=>{"use strict";e.exports=rfdc;function copyBuffer(e){if(e instanceof Buffer){return Buffer.from(e)}return new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}function rfdc(e){e=e||{};if(e.circles)return rfdcCircles(e);return e.proto?cloneProto:clone;function cloneArray(e,t){var r=Object.keys(e);var i=new Array(r.length);for(var n=0;n<r.length;n++){var s=r[n];var o=e[s];if(typeof o!=="object"||o===null){i[s]=o}else if(o instanceof Date){i[s]=new Date(o)}else if(ArrayBuffer.isView(o)){i[s]=copyBuffer(o)}else{i[s]=t(o)}}return i}function clone(e){if(typeof e!=="object"||e===null)return e;if(e instanceof Date)return new Date(e);if(Array.isArray(e))return cloneArray(e,clone);if(e instanceof Map)return new Map(cloneArray(Array.from(e),clone));if(e instanceof Set)return new Set(cloneArray(Array.from(e),clone));var t={};for(var r in e){if(Object.hasOwnProperty.call(e,r)===false)continue;var i=e[r];if(typeof i!=="object"||i===null){t[r]=i}else if(i instanceof Date){t[r]=new Date(i)}else if(i instanceof Map){t[r]=new Map(cloneArray(Array.from(i),clone))}else if(i instanceof Set){t[r]=new Set(cloneArray(Array.from(i),clone))}else if(ArrayBuffer.isView(i)){t[r]=copyBuffer(i)}else{t[r]=clone(i)}}return t}function cloneProto(e){if(typeof e!=="object"||e===null)return e;if(e instanceof Date)return new Date(e);if(Array.isArray(e))return cloneArray(e,cloneProto);if(e instanceof Map)return new Map(cloneArray(Array.from(e),cloneProto));if(e instanceof Set)return new Set(cloneArray(Array.from(e),cloneProto));var t={};for(var r in e){var i=e[r];if(typeof i!=="object"||i===null){t[r]=i}else if(i instanceof Date){t[r]=new Date(i)}else if(i instanceof Map){t[r]=new Map(cloneArray(Array.from(i),cloneProto))}else if(i instanceof Set){t[r]=new Set(cloneArray(Array.from(i),cloneProto))}else if(ArrayBuffer.isView(i)){t[r]=copyBuffer(i)}else{t[r]=cloneProto(i)}}return t}}function rfdcCircles(e){var t=[];var r=[];return e.proto?cloneProto:clone;function cloneArray(e,i){var n=Object.keys(e);var s=new Array(n.length);for(var o=0;o<n.length;o++){var a=n[o];var l=e[a];if(typeof l!=="object"||l===null){s[a]=l}else if(l instanceof Date){s[a]=new Date(l)}else if(ArrayBuffer.isView(l)){s[a]=copyBuffer(l)}else{var u=t.indexOf(l);if(u!==-1){s[a]=r[u]}else{s[a]=i(l)}}}return s}function clone(e){if(typeof e!=="object"||e===null)return e;if(e instanceof Date)return new Date(e);if(Array.isArray(e))return cloneArray(e,clone);if(e instanceof Map)return new Map(cloneArray(Array.from(e),clone));if(e instanceof Set)return new Set(cloneArray(Array.from(e),clone));var i={};t.push(e);r.push(i);for(var n in e){if(Object.hasOwnProperty.call(e,n)===false)continue;var s=e[n];if(typeof s!=="object"||s===null){i[n]=s}else if(s instanceof Date){i[n]=new Date(s)}else if(s instanceof Map){i[n]=new Map(cloneArray(Array.from(s),clone))}else if(s instanceof Set){i[n]=new Set(cloneArray(Array.from(s),clone))}else if(ArrayBuffer.isView(s)){i[n]=copyBuffer(s)}else{var o=t.indexOf(s);if(o!==-1){i[n]=r[o]}else{i[n]=clone(s)}}}t.pop();r.pop();return i}function cloneProto(e){if(typeof e!=="object"||e===null)return e;if(e instanceof Date)return new Date(e);if(Array.isArray(e))return cloneArray(e,cloneProto);if(e instanceof Map)return new Map(cloneArray(Array.from(e),cloneProto));if(e instanceof Set)return new Set(cloneArray(Array.from(e),cloneProto));var i={};t.push(e);r.push(i);for(var n in e){var s=e[n];if(typeof s!=="object"||s===null){i[n]=s}else if(s instanceof Date){i[n]=new Date(s)}else if(s instanceof Map){i[n]=new Map(cloneArray(Array.from(s),cloneProto))}else if(s instanceof Set){i[n]=new Set(cloneArray(Array.from(s),cloneProto))}else if(ArrayBuffer.isView(s)){i[n]=copyBuffer(s)}else{var o=t.indexOf(s);if(o!==-1){i[n]=r[o]}else{i[n]=cloneProto(s)}}}t.pop();r.pop();return i}}},9548:(e,t,r)=>{
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var i=r(4300);var n=i.Buffer;function copyProps(e,t){for(var r in e){t[r]=e[r]}}if(n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow){e.exports=i}else{copyProps(i,t);t.Buffer=SafeBuffer}function SafeBuffer(e,t,r){return n(e,t,r)}SafeBuffer.prototype=Object.create(n.prototype);copyProps(n,SafeBuffer);SafeBuffer.from=function(e,t,r){if(typeof e==="number"){throw new TypeError("Argument must not be a number")}return n(e,t,r)};SafeBuffer.alloc=function(e,t,r){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}var i=n(e);if(t!==undefined){if(typeof r==="string"){i.fill(t,r)}else{i.fill(t)}}else{i.fill(0)}return i};SafeBuffer.allocUnsafe=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return n(e)};SafeBuffer.allocUnsafeSlow=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return i.SlowBuffer(e)}},1080:e=>{e.exports=shift;function shift(e){var t=e._readableState;if(!t)return null;return t.objectMode||typeof e._duplexState==="number"?e.read():e.read(getStateLength(t))}function getStateLength(e){if(e.buffer.length){if(e.buffer.head){return e.buffer.head.data.length}return e.buffer[0].length}return e.length}},8541:(e,t,r)=>{"use strict";var i=r(9548).Buffer;var n=i.isEncoding||function(e){e=""+e;switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function _normalizeEncoding(e){if(!e)return"utf8";var t;while(true){switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase();t=true}}}function normalizeEncoding(e){var t=_normalizeEncoding(e);if(typeof t!=="string"&&(i.isEncoding===n||!n(e)))throw new Error("Unknown encoding: "+e);return t||e}t.s=StringDecoder;function StringDecoder(e){this.encoding=normalizeEncoding(e);var t;switch(this.encoding){case"utf16le":this.text=utf16Text;this.end=utf16End;t=4;break;case"utf8":this.fillLast=utf8FillLast;t=4;break;case"base64":this.text=base64Text;this.end=base64End;t=3;break;default:this.write=simpleWrite;this.end=simpleEnd;return}this.lastNeed=0;this.lastTotal=0;this.lastChar=i.allocUnsafe(t)}StringDecoder.prototype.write=function(e){if(e.length===0)return"";var t;var r;if(this.lastNeed){t=this.fillLast(e);if(t===undefined)return"";r=this.lastNeed;this.lastNeed=0}else{r=0}if(r<e.length)return t?t+this.text(e,r):this.text(e,r);return t||""};StringDecoder.prototype.end=utf8End;StringDecoder.prototype.text=utf8Text;StringDecoder.prototype.fillLast=function(e){if(this.lastNeed<=e.length){e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length);this.lastNeed-=e.length};function utf8CheckByte(e){if(e<=127)return 0;else if(e>>5===6)return 2;else if(e>>4===14)return 3;else if(e>>3===30)return 4;return e>>6===2?-1:-2}function utf8CheckIncomplete(e,t,r){var i=t.length-1;if(i<r)return 0;var n=utf8CheckByte(t[i]);if(n>=0){if(n>0)e.lastNeed=n-1;return n}if(--i<r||n===-2)return 0;n=utf8CheckByte(t[i]);if(n>=0){if(n>0)e.lastNeed=n-2;return n}if(--i<r||n===-2)return 0;n=utf8CheckByte(t[i]);if(n>=0){if(n>0){if(n===2)n=0;else e.lastNeed=n-3}return n}return 0}function utf8CheckExtraBytes(e,t,r){if((t[0]&192)!==128){e.lastNeed=0;return"�"}if(e.lastNeed>1&&t.length>1){if((t[1]&192)!==128){e.lastNeed=1;return"�"}if(e.lastNeed>2&&t.length>2){if((t[2]&192)!==128){e.lastNeed=2;return"�"}}}}function utf8FillLast(e){var t=this.lastTotal-this.lastNeed;var r=utf8CheckExtraBytes(this,e,t);if(r!==undefined)return r;if(this.lastNeed<=e.length){e.copy(this.lastChar,t,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}e.copy(this.lastChar,t,0,e.length);this.lastNeed-=e.length}function utf8Text(e,t){var r=utf8CheckIncomplete(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);e.copy(this.lastChar,0,i);return e.toString("utf8",t,i)}function utf8End(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed)return t+"�";return t}function utf16Text(e,t){if((e.length-t)%2===0){var r=e.toString("utf16le",t);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319){this.lastNeed=2;this.lastTotal=4;this.lastChar[0]=e[e.length-2];this.lastChar[1]=e[e.length-1];return r.slice(0,-1)}}return r}this.lastNeed=1;this.lastTotal=2;this.lastChar[0]=e[e.length-1];return e.toString("utf16le",t,e.length-1)}function utf16End(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function base64Text(e,t){var r=(e.length-t)%3;if(r===0)return e.toString("base64",t);this.lastNeed=3-r;this.lastTotal=3;if(r===1){this.lastChar[0]=e[e.length-1]}else{this.lastChar[0]=e[e.length-2];this.lastChar[1]=e[e.length-1]}return e.toString("base64",t,e.length-r)}function base64End(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed)return t+this.lastChar.toString("base64",0,3-this.lastNeed);return t}function simpleWrite(e){return e.toString(this.encoding)}function simpleEnd(e){return e&&e.length?this.write(e):""}},637:(e,t,r)=>{e.exports=r(3837).deprecate},3433:e=>{e.exports=wrappy;function wrappy(e,t){if(e&&t)return wrappy(e)(t);if(typeof e!=="function")throw new TypeError("need wrapper function");Object.keys(e).forEach((function(t){wrapper[t]=e[t]}));return wrapper;function wrapper(){var t=new Array(arguments.length);for(var r=0;r<t.length;r++){t[r]=arguments[r]}var i=e.apply(this,t);var n=t[t.length-1];if(typeof i==="function"&&i!==n){Object.keys(n).forEach((function(e){i[e]=n[e]}))}return i}}},4636:(e,t,r)=>{"use strict";const i=r(2232);i.createWebSocketStream=r(6885);i.Server=r(6136);i.Receiver=r(7527);i.Sender=r(3125);i.WebSocket=i;i.WebSocketServer=i.Server;e.exports=i},1838:(e,t,r)=>{"use strict";const{EMPTY_BUFFER:i}=r(7793);const n=Buffer[Symbol.species];function concat(e,t){if(e.length===0)return i;if(e.length===1)return e[0];const r=Buffer.allocUnsafe(t);let s=0;for(let t=0;t<e.length;t++){const i=e[t];r.set(i,s);s+=i.length}if(s<t){return new n(r.buffer,r.byteOffset,s)}return r}function _mask(e,t,r,i,n){for(let s=0;s<n;s++){r[i+s]=e[s]^t[s&3]}}function _unmask(e,t){for(let r=0;r<e.length;r++){e[r]^=t[r&3]}}function toArrayBuffer(e){if(e.length===e.buffer.byteLength){return e.buffer}return e.buffer.slice(e.byteOffset,e.byteOffset+e.length)}function toBuffer(e){toBuffer.readOnly=true;if(Buffer.isBuffer(e))return e;let t;if(e instanceof ArrayBuffer){t=new n(e)}else if(ArrayBuffer.isView(e)){t=new n(e.buffer,e.byteOffset,e.byteLength)}else{t=Buffer.from(e);toBuffer.readOnly=false}return t}e.exports={concat:concat,mask:_mask,toArrayBuffer:toArrayBuffer,toBuffer:toBuffer,unmask:_unmask};if(!process.env.WS_NO_BUFFER_UTIL){try{const t=r(3357);e.exports.mask=function(e,r,i,n,s){if(s<48)_mask(e,r,i,n,s);else t.mask(e,r,i,n,s)};e.exports.unmask=function(e,r){if(e.length<32)_unmask(e,r);else t.unmask(e,r)}}catch(e){}}},7793:e=>{"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},6374:(e,t,r)=>{"use strict";const{kForOnEventAttribute:i,kListener:n}=r(7793);const s=Symbol("kCode");const o=Symbol("kData");const a=Symbol("kError");const l=Symbol("kMessage");const u=Symbol("kReason");const c=Symbol("kTarget");const h=Symbol("kType");const d=Symbol("kWasClean");class Event{constructor(e){this[c]=null;this[h]=e}get target(){return this[c]}get type(){return this[h]}}Object.defineProperty(Event.prototype,"target",{enumerable:true});Object.defineProperty(Event.prototype,"type",{enumerable:true});class CloseEvent extends Event{constructor(e,t={}){super(e);this[s]=t.code===undefined?0:t.code;this[u]=t.reason===undefined?"":t.reason;this[d]=t.wasClean===undefined?false:t.wasClean}get code(){return this[s]}get reason(){return this[u]}get wasClean(){return this[d]}}Object.defineProperty(CloseEvent.prototype,"code",{enumerable:true});Object.defineProperty(CloseEvent.prototype,"reason",{enumerable:true});Object.defineProperty(CloseEvent.prototype,"wasClean",{enumerable:true});class ErrorEvent extends Event{constructor(e,t={}){super(e);this[a]=t.error===undefined?null:t.error;this[l]=t.message===undefined?"":t.message}get error(){return this[a]}get message(){return this[l]}}Object.defineProperty(ErrorEvent.prototype,"error",{enumerable:true});Object.defineProperty(ErrorEvent.prototype,"message",{enumerable:true});class MessageEvent extends Event{constructor(e,t={}){super(e);this[o]=t.data===undefined?null:t.data}get data(){return this[o]}}Object.defineProperty(MessageEvent.prototype,"data",{enumerable:true});const p={addEventListener(e,t,r={}){for(const s of this.listeners(e)){if(!r[i]&&s[n]===t&&!s[i]){return}}let s;if(e==="message"){s=function onMessage(e,r){const i=new MessageEvent("message",{data:r?e:e.toString()});i[c]=this;callListener(t,this,i)}}else if(e==="close"){s=function onClose(e,r){const i=new CloseEvent("close",{code:e,reason:r.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});i[c]=this;callListener(t,this,i)}}else if(e==="error"){s=function onError(e){const r=new ErrorEvent("error",{error:e,message:e.message});r[c]=this;callListener(t,this,r)}}else if(e==="open"){s=function onOpen(){const e=new Event("open");e[c]=this;callListener(t,this,e)}}else{return}s[i]=!!r[i];s[n]=t;if(r.once){this.once(e,s)}else{this.on(e,s)}},removeEventListener(e,t){for(const r of this.listeners(e)){if(r[n]===t&&!r[i]){this.removeListener(e,r);break}}}};e.exports={CloseEvent:CloseEvent,ErrorEvent:ErrorEvent,Event:Event,EventTarget:p,MessageEvent:MessageEvent};function callListener(e,t,r){if(typeof e==="object"&&e.handleEvent){e.handleEvent.call(e,r)}else{e.call(t,r)}}},5226:(e,t,r)=>{"use strict";const{tokenChars:i}=r(7312);function push(e,t,r){if(e[t]===undefined)e[t]=[r];else e[t].push(r)}function parse(e){const t=Object.create(null);let r=Object.create(null);let n=false;let s=false;let o=false;let a;let l;let u=-1;let c=-1;let h=-1;let d=0;for(;d<e.length;d++){c=e.charCodeAt(d);if(a===undefined){if(h===-1&&i[c]===1){if(u===-1)u=d}else if(d!==0&&(c===32||c===9)){if(h===-1&&u!==-1)h=d}else if(c===59||c===44){if(u===-1){throw new SyntaxError(`Unexpected character at index ${d}`)}if(h===-1)h=d;const i=e.slice(u,h);if(c===44){push(t,i,r);r=Object.create(null)}else{a=i}u=h=-1}else{throw new SyntaxError(`Unexpected character at index ${d}`)}}else if(l===undefined){if(h===-1&&i[c]===1){if(u===-1)u=d}else if(c===32||c===9){if(h===-1&&u!==-1)h=d}else if(c===59||c===44){if(u===-1){throw new SyntaxError(`Unexpected character at index ${d}`)}if(h===-1)h=d;push(r,e.slice(u,h),true);if(c===44){push(t,a,r);r=Object.create(null);a=undefined}u=h=-1}else if(c===61&&u!==-1&&h===-1){l=e.slice(u,d);u=h=-1}else{throw new SyntaxError(`Unexpected character at index ${d}`)}}else{if(s){if(i[c]!==1){throw new SyntaxError(`Unexpected character at index ${d}`)}if(u===-1)u=d;else if(!n)n=true;s=false}else if(o){if(i[c]===1){if(u===-1)u=d}else if(c===34&&u!==-1){o=false;h=d}else if(c===92){s=true}else{throw new SyntaxError(`Unexpected character at index ${d}`)}}else if(c===34&&e.charCodeAt(d-1)===61){o=true}else if(h===-1&&i[c]===1){if(u===-1)u=d}else if(u!==-1&&(c===32||c===9)){if(h===-1)h=d}else if(c===59||c===44){if(u===-1){throw new SyntaxError(`Unexpected character at index ${d}`)}if(h===-1)h=d;let i=e.slice(u,h);if(n){i=i.replace(/\\/g,"");n=false}push(r,l,i);if(c===44){push(t,a,r);r=Object.create(null);a=undefined}l=undefined;u=h=-1}else{throw new SyntaxError(`Unexpected character at index ${d}`)}}}if(u===-1||o||c===32||c===9){throw new SyntaxError("Unexpected end of input")}if(h===-1)h=d;const p=e.slice(u,h);if(a===undefined){push(t,p,r)}else{if(l===undefined){push(r,p,true)}else if(n){push(r,l,p.replace(/\\/g,""))}else{push(r,l,p)}push(t,a,r)}return t}function format(e){return Object.keys(e).map((t=>{let r=e[t];if(!Array.isArray(r))r=[r];return r.map((e=>[t].concat(Object.keys(e).map((t=>{let r=e[t];if(!Array.isArray(r))r=[r];return r.map((e=>e===true?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")}e.exports={format:format,parse:parse}},1288:e=>{"use strict";const t=Symbol("kDone");const r=Symbol("kRun");class Limiter{constructor(e){this[t]=()=>{this.pending--;this[r]()};this.concurrency=e||Infinity;this.jobs=[];this.pending=0}add(e){this.jobs.push(e);this[r]()}[r](){if(this.pending===this.concurrency)return;if(this.jobs.length){const e=this.jobs.shift();this.pending++;e(this[t])}}}e.exports=Limiter},6691:(e,t,r)=>{"use strict";const i=r(9796);const n=r(1838);const s=r(1288);const{kStatusCode:o}=r(7793);const a=Buffer[Symbol.species];const l=Buffer.from([0,0,255,255]);const u=Symbol("permessage-deflate");const c=Symbol("total-length");const h=Symbol("callback");const d=Symbol("buffers");const p=Symbol("error");let b;class PerMessageDeflate{constructor(e,t,r){this._maxPayload=r|0;this._options=e||{};this._threshold=this._options.threshold!==undefined?this._options.threshold:1024;this._isServer=!!t;this._deflate=null;this._inflate=null;this.params=null;if(!b){const e=this._options.concurrencyLimit!==undefined?this._options.concurrencyLimit:10;b=new s(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};if(this._options.serverNoContextTakeover){e.server_no_context_takeover=true}if(this._options.clientNoContextTakeover){e.client_no_context_takeover=true}if(this._options.serverMaxWindowBits){e.server_max_window_bits=this._options.serverMaxWindowBits}if(this._options.clientMaxWindowBits){e.client_max_window_bits=this._options.clientMaxWindowBits}else if(this._options.clientMaxWindowBits==null){e.client_max_window_bits=true}return e}accept(e){e=this.normalizeParams(e);this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e);return this.params}cleanup(){if(this._inflate){this._inflate.close();this._inflate=null}if(this._deflate){const e=this._deflate[h];this._deflate.close();this._deflate=null;if(e){e(new Error("The deflate stream was closed while data was being processed"))}}}acceptAsServer(e){const t=this._options;const r=e.find((e=>{if(t.serverNoContextTakeover===false&&e.server_no_context_takeover||e.server_max_window_bits&&(t.serverMaxWindowBits===false||typeof t.serverMaxWindowBits==="number"&&t.serverMaxWindowBits>e.server_max_window_bits)||typeof t.clientMaxWindowBits==="number"&&!e.client_max_window_bits){return false}return true}));if(!r){throw new Error("None of the extension offers can be accepted")}if(t.serverNoContextTakeover){r.server_no_context_takeover=true}if(t.clientNoContextTakeover){r.client_no_context_takeover=true}if(typeof t.serverMaxWindowBits==="number"){r.server_max_window_bits=t.serverMaxWindowBits}if(typeof t.clientMaxWindowBits==="number"){r.client_max_window_bits=t.clientMaxWindowBits}else if(r.client_max_window_bits===true||t.clientMaxWindowBits===false){delete r.client_max_window_bits}return r}acceptAsClient(e){const t=e[0];if(this._options.clientNoContextTakeover===false&&t.client_no_context_takeover){throw new Error('Unexpected parameter "client_no_context_takeover"')}if(!t.client_max_window_bits){if(typeof this._options.clientMaxWindowBits==="number"){t.client_max_window_bits=this._options.clientMaxWindowBits}}else if(this._options.clientMaxWindowBits===false||typeof this._options.clientMaxWindowBits==="number"&&t.client_max_window_bits>this._options.clientMaxWindowBits){throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}return t}normalizeParams(e){e.forEach((e=>{Object.keys(e).forEach((t=>{let r=e[t];if(r.length>1){throw new Error(`Parameter "${t}" must have only a single value`)}r=r[0];if(t==="client_max_window_bits"){if(r!==true){const e=+r;if(!Number.isInteger(e)||e<8||e>15){throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}r=e}else if(!this._isServer){throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}}else if(t==="server_max_window_bits"){const e=+r;if(!Number.isInteger(e)||e<8||e>15){throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}r=e}else if(t==="client_no_context_takeover"||t==="server_no_context_takeover"){if(r!==true){throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}}else{throw new Error(`Unknown parameter "${t}"`)}e[t]=r}))}));return e}decompress(e,t,r){b.add((i=>{this._decompress(e,t,((e,t)=>{i();r(e,t)}))}))}compress(e,t,r){b.add((i=>{this._compress(e,t,((e,t)=>{i();r(e,t)}))}))}_decompress(e,t,r){const s=this._isServer?"client":"server";if(!this._inflate){const e=`${s}_max_window_bits`;const t=typeof this.params[e]!=="number"?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t});this._inflate[u]=this;this._inflate[c]=0;this._inflate[d]=[];this._inflate.on("error",inflateOnError);this._inflate.on("data",inflateOnData)}this._inflate[h]=r;this._inflate.write(e);if(t)this._inflate.write(l);this._inflate.flush((()=>{const e=this._inflate[p];if(e){this._inflate.close();this._inflate=null;r(e);return}const i=n.concat(this._inflate[d],this._inflate[c]);if(this._inflate._readableState.endEmitted){this._inflate.close();this._inflate=null}else{this._inflate[c]=0;this._inflate[d]=[];if(t&&this.params[`${s}_no_context_takeover`]){this._inflate.reset()}}r(null,i)}))}_compress(e,t,r){const s=this._isServer?"server":"client";if(!this._deflate){const e=`${s}_max_window_bits`;const t=typeof this.params[e]!=="number"?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t});this._deflate[c]=0;this._deflate[d]=[];this._deflate.on("data",deflateOnData)}this._deflate[h]=r;this._deflate.write(e);this._deflate.flush(i.Z_SYNC_FLUSH,(()=>{if(!this._deflate){return}let e=n.concat(this._deflate[d],this._deflate[c]);if(t){e=new a(e.buffer,e.byteOffset,e.length-4)}this._deflate[h]=null;this._deflate[c]=0;this._deflate[d]=[];if(t&&this.params[`${s}_no_context_takeover`]){this._deflate.reset()}r(null,e)}))}}e.exports=PerMessageDeflate;function deflateOnData(e){this[d].push(e);this[c]+=e.length}function inflateOnData(e){this[c]+=e.length;if(this[u]._maxPayload<1||this[c]<=this[u]._maxPayload){this[d].push(e);return}this[p]=new RangeError("Max payload size exceeded");this[p].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH";this[p][o]=1009;this.removeListener("data",inflateOnData);this.reset()}function inflateOnError(e){this[u]._inflate=null;e[o]=1007;this[h](e)}},7527:(e,t,r)=>{"use strict";const{Writable:i}=r(2781);const n=r(6691);const{BINARY_TYPES:s,EMPTY_BUFFER:o,kStatusCode:a,kWebSocket:l}=r(7793);const{concat:u,toArrayBuffer:c,unmask:h}=r(1838);const{isValidStatusCode:d,isValidUTF8:p}=r(7312);const b=Buffer[Symbol.species];const g=0;const _=1;const m=2;const y=3;const w=4;const S=5;class Receiver extends i{constructor(e={}){super();this._binaryType=e.binaryType||s[0];this._extensions=e.extensions||{};this._isServer=!!e.isServer;this._maxPayload=e.maxPayload|0;this._skipUTF8Validation=!!e.skipUTF8Validation;this[l]=undefined;this._bufferedBytes=0;this._buffers=[];this._compressed=false;this._payloadLength=0;this._mask=undefined;this._fragmented=0;this._masked=false;this._fin=false;this._opcode=0;this._totalPayloadLength=0;this._messageLength=0;this._fragments=[];this._state=g;this._loop=false}_write(e,t,r){if(this._opcode===8&&this._state==g)return r();this._bufferedBytes+=e.length;this._buffers.push(e);this.startLoop(r)}consume(e){this._bufferedBytes-=e;if(e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];this._buffers[0]=new b(t.buffer,t.byteOffset+e,t.length-e);return new b(t.buffer,t.byteOffset,e)}const t=Buffer.allocUnsafe(e);do{const r=this._buffers[0];const i=t.length-e;if(e>=r.length){t.set(this._buffers.shift(),i)}else{t.set(new Uint8Array(r.buffer,r.byteOffset,e),i);this._buffers[0]=new b(r.buffer,r.byteOffset+e,r.length-e)}e-=r.length}while(e>0);return t}startLoop(e){let t;this._loop=true;do{switch(this._state){case g:t=this.getInfo();break;case _:t=this.getPayloadLength16();break;case m:t=this.getPayloadLength64();break;case y:this.getMask();break;case w:t=this.getData(e);break;default:this._loop=false;return}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2){this._loop=false;return}const e=this.consume(2);if((e[0]&48)!==0){this._loop=false;return error(RangeError,"RSV2 and RSV3 must be clear",true,1002,"WS_ERR_UNEXPECTED_RSV_2_3")}const t=(e[0]&64)===64;if(t&&!this._extensions[n.extensionName]){this._loop=false;return error(RangeError,"RSV1 must be clear",true,1002,"WS_ERR_UNEXPECTED_RSV_1")}this._fin=(e[0]&128)===128;this._opcode=e[0]&15;this._payloadLength=e[1]&127;if(this._opcode===0){if(t){this._loop=false;return error(RangeError,"RSV1 must be clear",true,1002,"WS_ERR_UNEXPECTED_RSV_1")}if(!this._fragmented){this._loop=false;return error(RangeError,"invalid opcode 0",true,1002,"WS_ERR_INVALID_OPCODE")}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){this._loop=false;return error(RangeError,`invalid opcode ${this._opcode}`,true,1002,"WS_ERR_INVALID_OPCODE")}this._compressed=t}else if(this._opcode>7&&this._opcode<11){if(!this._fin){this._loop=false;return error(RangeError,"FIN must be set",true,1002,"WS_ERR_EXPECTED_FIN")}if(t){this._loop=false;return error(RangeError,"RSV1 must be clear",true,1002,"WS_ERR_UNEXPECTED_RSV_1")}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){this._loop=false;return error(RangeError,`invalid payload length ${this._payloadLength}`,true,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}}else{this._loop=false;return error(RangeError,`invalid opcode ${this._opcode}`,true,1002,"WS_ERR_INVALID_OPCODE")}if(!this._fin&&!this._fragmented)this._fragmented=this._opcode;this._masked=(e[1]&128)===128;if(this._isServer){if(!this._masked){this._loop=false;return error(RangeError,"MASK must be set",true,1002,"WS_ERR_EXPECTED_MASK")}}else if(this._masked){this._loop=false;return error(RangeError,"MASK must be clear",true,1002,"WS_ERR_UNEXPECTED_MASK")}if(this._payloadLength===126)this._state=_;else if(this._payloadLength===127)this._state=m;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=false;return}this._payloadLength=this.consume(2).readUInt16BE(0);return this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=false;return}const e=this.consume(8);const t=e.readUInt32BE(0);if(t>Math.pow(2,53-32)-1){this._loop=false;return error(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",false,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")}this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4);return this.haveLength()}haveLength(){if(this._payloadLength&&this._opcode<8){this._totalPayloadLength+=this._payloadLength;if(this._totalPayloadLength>this._maxPayload&&this._maxPayload>0){this._loop=false;return error(RangeError,"Max payload size exceeded",false,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH")}}if(this._masked)this._state=y;else this._state=w}getMask(){if(this._bufferedBytes<4){this._loop=false;return}this._mask=this.consume(4);this._state=w}getData(e){let t=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=false;return}t=this.consume(this._payloadLength);if(this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0){h(t,this._mask)}}if(this._opcode>7)return this.controlMessage(t);if(this._compressed){this._state=S;this.decompress(t,e);return}if(t.length){this._messageLength=this._totalPayloadLength;this._fragments.push(t)}return this.dataMessage()}decompress(e,t){const r=this._extensions[n.extensionName];r.decompress(e,this._fin,((e,r)=>{if(e)return t(e);if(r.length){this._messageLength+=r.length;if(this._messageLength>this._maxPayload&&this._maxPayload>0){return t(error(RangeError,"Max payload size exceeded",false,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"))}this._fragments.push(r)}const i=this.dataMessage();if(i)return t(i);this.startLoop(t)}))}dataMessage(){if(this._fin){const e=this._messageLength;const t=this._fragments;this._totalPayloadLength=0;this._messageLength=0;this._fragmented=0;this._fragments=[];if(this._opcode===2){let r;if(this._binaryType==="nodebuffer"){r=u(t,e)}else if(this._binaryType==="arraybuffer"){r=c(u(t,e))}else{r=t}this.emit("message",r,true)}else{const r=u(t,e);if(!this._skipUTF8Validation&&!p(r)){this._loop=false;return error(Error,"invalid UTF-8 sequence",true,1007,"WS_ERR_INVALID_UTF8")}this.emit("message",r,false)}}this._state=g}controlMessage(e){if(this._opcode===8){this._loop=false;if(e.length===0){this.emit("conclude",1005,o);this.end()}else{const t=e.readUInt16BE(0);if(!d(t)){return error(RangeError,`invalid status code ${t}`,true,1002,"WS_ERR_INVALID_CLOSE_CODE")}const r=new b(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!p(r)){return error(Error,"invalid UTF-8 sequence",true,1007,"WS_ERR_INVALID_UTF8")}this.emit("conclude",t,r);this.end()}}else if(this._opcode===9){this.emit("ping",e)}else{this.emit("pong",e)}this._state=g}}e.exports=Receiver;function error(e,t,r,i,n){const s=new e(r?`Invalid WebSocket frame: ${t}`:t);Error.captureStackTrace(s,error);s.code=n;s[a]=i;return s}},3125:(e,t,r)=>{"use strict";const i=r(1808);const n=r(4404);const{randomFillSync:s}=r(6113);const o=r(6691);const{EMPTY_BUFFER:a}=r(7793);const{isValidStatusCode:l}=r(7312);const{mask:u,toBuffer:c}=r(1838);const h=Symbol("kByteLength");const d=Buffer.alloc(4);class Sender{constructor(e,t,r){this._extensions=t||{};if(r){this._generateMask=r;this._maskBuffer=Buffer.alloc(4)}this._socket=e;this._firstFragment=true;this._compress=false;this._bufferedBytes=0;this._deflating=false;this._queue=[]}static frame(e,t){let r;let i=false;let n=2;let o=false;if(t.mask){r=t.maskBuffer||d;if(t.generateMask){t.generateMask(r)}else{s(r,0,4)}o=(r[0]|r[1]|r[2]|r[3])===0;n=6}let a;if(typeof e==="string"){if((!t.mask||o)&&t[h]!==undefined){a=t[h]}else{e=Buffer.from(e);a=e.length}}else{a=e.length;i=t.mask&&t.readOnly&&!o}let l=a;if(a>=65536){n+=8;l=127}else if(a>125){n+=2;l=126}const c=Buffer.allocUnsafe(i?a+n:n);c[0]=t.fin?t.opcode|128:t.opcode;if(t.rsv1)c[0]|=64;c[1]=l;if(l===126){c.writeUInt16BE(a,2)}else if(l===127){c[2]=c[3]=0;c.writeUIntBE(a,4,6)}if(!t.mask)return[c,e];c[1]|=128;c[n-4]=r[0];c[n-3]=r[1];c[n-2]=r[2];c[n-1]=r[3];if(o)return[c,e];if(i){u(e,r,c,n,a);return[c]}u(e,r,e,0,a);return[c,e]}close(e,t,r,i){let n;if(e===undefined){n=a}else if(typeof e!=="number"||!l(e)){throw new TypeError("First argument must be a valid error code number")}else if(t===undefined||!t.length){n=Buffer.allocUnsafe(2);n.writeUInt16BE(e,0)}else{const r=Buffer.byteLength(t);if(r>123){throw new RangeError("The message must not be greater than 123 bytes")}n=Buffer.allocUnsafe(2+r);n.writeUInt16BE(e,0);if(typeof t==="string"){n.write(t,2)}else{n.set(t,2)}}const s={[h]:n.length,fin:true,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:8,readOnly:false,rsv1:false};if(this._deflating){this.enqueue([this.dispatch,n,false,s,i])}else{this.sendFrame(Sender.frame(n,s),i)}}ping(e,t,r){let i;let n;if(typeof e==="string"){i=Buffer.byteLength(e);n=false}else{e=c(e);i=e.length;n=c.readOnly}if(i>125){throw new RangeError("The data size must not be greater than 125 bytes")}const s={[h]:i,fin:true,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:n,rsv1:false};if(this._deflating){this.enqueue([this.dispatch,e,false,s,r])}else{this.sendFrame(Sender.frame(e,s),r)}}pong(e,t,r){let i;let n;if(typeof e==="string"){i=Buffer.byteLength(e);n=false}else{e=c(e);i=e.length;n=c.readOnly}if(i>125){throw new RangeError("The data size must not be greater than 125 bytes")}const s={[h]:i,fin:true,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:n,rsv1:false};if(this._deflating){this.enqueue([this.dispatch,e,false,s,r])}else{this.sendFrame(Sender.frame(e,s),r)}}send(e,t,r){const i=this._extensions[o.extensionName];let n=t.binary?2:1;let s=t.compress;let a;let l;if(typeof e==="string"){a=Buffer.byteLength(e);l=false}else{e=c(e);a=e.length;l=c.readOnly}if(this._firstFragment){this._firstFragment=false;if(s&&i&&i.params[i._isServer?"server_no_context_takeover":"client_no_context_takeover"]){s=a>=i._threshold}this._compress=s}else{s=false;n=0}if(t.fin)this._firstFragment=true;if(i){const i={[h]:a,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:l,rsv1:s};if(this._deflating){this.enqueue([this.dispatch,e,this._compress,i,r])}else{this.dispatch(e,this._compress,i,r)}}else{this.sendFrame(Sender.frame(e,{[h]:a,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:l,rsv1:false}),r)}}dispatch(e,t,r,i){if(!t){this.sendFrame(Sender.frame(e,r),i);return}const n=this._extensions[o.extensionName];this._bufferedBytes+=r[h];this._deflating=true;n.compress(e,r.fin,((e,t)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");if(typeof i==="function")i(e);for(let t=0;t<this._queue.length;t++){const r=this._queue[t];const i=r[r.length-1];if(typeof i==="function")i(e)}return}this._bufferedBytes-=r[h];this._deflating=false;r.readOnly=false;this.sendFrame(Sender.frame(t,r),i);this.dequeue()}))}dequeue(){while(!this._deflating&&this._queue.length){const e=this._queue.shift();this._bufferedBytes-=e[3][h];Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][h];this._queue.push(e)}sendFrame(e,t){if(e.length===2){this._socket.cork();this._socket.write(e[0]);this._socket.write(e[1],t);this._socket.uncork()}else{this._socket.write(e[0],t)}}}e.exports=Sender},6885:(e,t,r)=>{"use strict";const{Duplex:i}=r(2781);function emitClose(e){e.emit("close")}function duplexOnEnd(){if(!this.destroyed&&this._writableState.finished){this.destroy()}}function duplexOnError(e){this.removeListener("error",duplexOnError);this.destroy();if(this.listenerCount("error")===0){this.emit("error",e)}}function createWebSocketStream(e,t){let r=true;const n=new i({...t,autoDestroy:false,emitClose:false,objectMode:false,writableObjectMode:false});e.on("message",(function message(t,r){const i=!r&&n._readableState.objectMode?t.toString():t;if(!n.push(i))e.pause()}));e.once("error",(function error(e){if(n.destroyed)return;r=false;n.destroy(e)}));e.once("close",(function close(){if(n.destroyed)return;n.push(null)}));n._destroy=function(t,i){if(e.readyState===e.CLOSED){i(t);process.nextTick(emitClose,n);return}let s=false;e.once("error",(function error(e){s=true;i(e)}));e.once("close",(function close(){if(!s)i(t);process.nextTick(emitClose,n)}));if(r)e.terminate()};n._final=function(t){if(e.readyState===e.CONNECTING){e.once("open",(function open(){n._final(t)}));return}if(e._socket===null)return;if(e._socket._writableState.finished){t();if(n._readableState.endEmitted)n.destroy()}else{e._socket.once("finish",(function finish(){t()}));e.close()}};n._read=function(){if(e.isPaused)e.resume()};n._write=function(t,r,i){if(e.readyState===e.CONNECTING){e.once("open",(function open(){n._write(t,r,i)}));return}e.send(t,i)};n.on("end",duplexOnEnd);n.on("error",duplexOnError);return n}e.exports=createWebSocketStream},1426:(e,t,r)=>{"use strict";const{tokenChars:i}=r(7312);function parse(e){const t=new Set;let r=-1;let n=-1;let s=0;for(s;s<e.length;s++){const o=e.charCodeAt(s);if(n===-1&&i[o]===1){if(r===-1)r=s}else if(s!==0&&(o===32||o===9)){if(n===-1&&r!==-1)n=s}else if(o===44){if(r===-1){throw new SyntaxError(`Unexpected character at index ${s}`)}if(n===-1)n=s;const i=e.slice(r,n);if(t.has(i)){throw new SyntaxError(`The "${i}" subprotocol is duplicated`)}t.add(i);r=n=-1}else{throw new SyntaxError(`Unexpected character at index ${s}`)}}if(r===-1||n!==-1){throw new SyntaxError("Unexpected end of input")}const o=e.slice(r,s);if(t.has(o)){throw new SyntaxError(`The "${o}" subprotocol is duplicated`)}t.add(o);return t}e.exports={parse:parse}},7312:(e,t,r)=>{"use strict";const{isUtf8:i}=r(4300);const n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function isValidStatusCode(e){return e>=1e3&&e<=1014&&e!==1004&&e!==1005&&e!==1006||e>=3e3&&e<=4999}function _isValidUTF8(e){const t=e.length;let r=0;while(r<t){if((e[r]&128)===0){r++}else if((e[r]&224)===192){if(r+1===t||(e[r+1]&192)!==128||(e[r]&254)===192){return false}r+=2}else if((e[r]&240)===224){if(r+2>=t||(e[r+1]&192)!==128||(e[r+2]&192)!==128||e[r]===224&&(e[r+1]&224)===128||e[r]===237&&(e[r+1]&224)===160){return false}r+=3}else if((e[r]&248)===240){if(r+3>=t||(e[r+1]&192)!==128||(e[r+2]&192)!==128||(e[r+3]&192)!==128||e[r]===240&&(e[r+1]&240)===128||e[r]===244&&e[r+1]>143||e[r]>244){return false}r+=4}else{return false}}return true}e.exports={isValidStatusCode:isValidStatusCode,isValidUTF8:_isValidUTF8,tokenChars:n};if(i){e.exports.isValidUTF8=function(e){return e.length<24?_isValidUTF8(e):i(e)}}else if(!process.env.WS_NO_UTF_8_VALIDATE){try{const t=r(6700);e.exports.isValidUTF8=function(e){return e.length<32?_isValidUTF8(e):t(e)}}catch(e){}}},6136:(e,t,r)=>{"use strict";const i=r(2361);const n=r(3685);const s=r(5687);const o=r(1808);const a=r(4404);const{createHash:l}=r(6113);const u=r(5226);const c=r(6691);const h=r(1426);const d=r(2232);const{GUID:p,kWebSocket:b}=r(7793);const g=/^[+/0-9A-Za-z]{22}==$/;const _=0;const m=1;const y=2;class WebSocketServer extends i{constructor(e,t){super();e={maxPayload:100*1024*1024,skipUTF8Validation:false,perMessageDeflate:false,handleProtocols:null,clientTracking:true,verifyClient:null,noServer:false,backlog:null,server:null,host:null,path:null,port:null,WebSocket:d,...e};if(e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer){throw new TypeError('One and only one of the "port", "server", or "noServer" options '+"must be specified")}if(e.port!=null){this._server=n.createServer(((e,t)=>{const r=n.STATUS_CODES[426];t.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"});t.end(r)}));this._server.listen(e.port,e.host,e.backlog,t)}else if(e.server){this._server=e.server}if(this._server){const e=this.emit.bind(this,"connection");this._removeListeners=addListeners(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,r,i)=>{this.handleUpgrade(t,r,i,e)}})}if(e.perMessageDeflate===true)e.perMessageDeflate={};if(e.clientTracking){this.clients=new Set;this._shouldEmitClose=false}this.options=e;this._state=_}address(){if(this.options.noServer){throw new Error('The server is operating in "noServer" mode')}if(!this._server)return null;return this._server.address()}close(e){if(this._state===y){if(e){this.once("close",(()=>{e(new Error("The server is not running"))}))}process.nextTick(emitClose,this);return}if(e)this.once("close",e);if(this._state===m)return;this._state=m;if(this.options.noServer||this.options.server){if(this._server){this._removeListeners();this._removeListeners=this._server=null}if(this.clients){if(!this.clients.size){process.nextTick(emitClose,this)}else{this._shouldEmitClose=true}}else{process.nextTick(emitClose,this)}}else{const e=this._server;this._removeListeners();this._removeListeners=this._server=null;e.close((()=>{emitClose(this)}))}}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");const r=t!==-1?e.url.slice(0,t):e.url;if(r!==this.options.path)return false}return true}handleUpgrade(e,t,r,i){t.on("error",socketOnError);const n=e.headers["sec-websocket-key"];const s=+e.headers["sec-websocket-version"];if(e.method!=="GET"){const r="Invalid HTTP method";abortHandshakeOrEmitwsClientError(this,e,t,405,r);return}if(e.headers.upgrade.toLowerCase()!=="websocket"){const r="Invalid Upgrade header";abortHandshakeOrEmitwsClientError(this,e,t,400,r);return}if(!n||!g.test(n)){const r="Missing or invalid Sec-WebSocket-Key header";abortHandshakeOrEmitwsClientError(this,e,t,400,r);return}if(s!==8&&s!==13){const r="Missing or invalid Sec-WebSocket-Version header";abortHandshakeOrEmitwsClientError(this,e,t,400,r);return}if(!this.shouldHandle(e)){abortHandshake(t,400);return}const o=e.headers["sec-websocket-protocol"];let a=new Set;if(o!==undefined){try{a=h.parse(o)}catch(r){const i="Invalid Sec-WebSocket-Protocol header";abortHandshakeOrEmitwsClientError(this,e,t,400,i);return}}const l=e.headers["sec-websocket-extensions"];const d={};if(this.options.perMessageDeflate&&l!==undefined){const r=new c(this.options.perMessageDeflate,true,this.options.maxPayload);try{const e=u.parse(l);if(e[c.extensionName]){r.accept(e[c.extensionName]);d[c.extensionName]=r}}catch(r){const i="Invalid or unacceptable Sec-WebSocket-Extensions header";abortHandshakeOrEmitwsClientError(this,e,t,400,i);return}}if(this.options.verifyClient){const o={origin:e.headers[`${s===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(o,((s,o,l,u)=>{if(!s){return abortHandshake(t,o||401,l,u)}this.completeUpgrade(d,n,a,e,t,r,i)}));return}if(!this.options.verifyClient(o))return abortHandshake(t,401)}this.completeUpgrade(d,n,a,e,t,r,i)}completeUpgrade(e,t,r,i,n,s,o){if(!n.readable||!n.writable)return n.destroy();if(n[b]){throw new Error("server.handleUpgrade() was called more than once with the same "+"socket, possibly due to a misconfiguration")}if(this._state>_)return abortHandshake(n,503);const a=l("sha1").update(t+p).digest("base64");const h=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${a}`];const d=new this.options.WebSocket(null);if(r.size){const e=this.options.handleProtocols?this.options.handleProtocols(r,i):r.values().next().value;if(e){h.push(`Sec-WebSocket-Protocol: ${e}`);d._protocol=e}}if(e[c.extensionName]){const t=e[c.extensionName].params;const r=u.format({[c.extensionName]:[t]});h.push(`Sec-WebSocket-Extensions: ${r}`);d._extensions=e}this.emit("headers",h,i);n.write(h.concat("\r\n").join("\r\n"));n.removeListener("error",socketOnError);d.setSocket(n,s,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation});if(this.clients){this.clients.add(d);d.on("close",(()=>{this.clients.delete(d);if(this._shouldEmitClose&&!this.clients.size){process.nextTick(emitClose,this)}}))}o(d,i)}}e.exports=WebSocketServer;function addListeners(e,t){for(const r of Object.keys(t))e.on(r,t[r]);return function removeListeners(){for(const r of Object.keys(t)){e.removeListener(r,t[r])}}}function emitClose(e){e._state=y;e.emit("close")}function socketOnError(){this.destroy()}function abortHandshake(e,t,r,i){r=r||n.STATUS_CODES[t];i={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...i};e.once("finish",e.destroy);e.end(`HTTP/1.1 ${t} ${n.STATUS_CODES[t]}\r\n`+Object.keys(i).map((e=>`${e}: ${i[e]}`)).join("\r\n")+"\r\n\r\n"+r)}function abortHandshakeOrEmitwsClientError(e,t,r,i,n){if(e.listenerCount("wsClientError")){const i=new Error(n);Error.captureStackTrace(i,abortHandshakeOrEmitwsClientError);e.emit("wsClientError",i,r,t)}else{abortHandshake(r,i,n)}}},2232:(e,t,r)=>{"use strict";const i=r(2361);const n=r(5687);const s=r(3685);const o=r(1808);const a=r(4404);const{randomBytes:l,createHash:u}=r(6113);const{Readable:c}=r(2781);const{URL:h}=r(7310);const d=r(6691);const p=r(7527);const b=r(3125);const{BINARY_TYPES:g,EMPTY_BUFFER:_,GUID:m,kForOnEventAttribute:y,kListener:w,kStatusCode:S,kWebSocket:v,NOOP:k}=r(7793);const{EventTarget:{addEventListener:T,removeEventListener:R}}=r(6374);const{format:A,parse:I}=r(5226);const{toBuffer:O}=r(1838);const x=30*1e3;const C=Symbol("kAborted");const P=[8,13];const B=["CONNECTING","OPEN","CLOSING","CLOSED"];const M=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class WebSocket extends i{constructor(e,t,r){super();this._binaryType=g[0];this._closeCode=1006;this._closeFrameReceived=false;this._closeFrameSent=false;this._closeMessage=_;this._closeTimer=null;this._extensions={};this._paused=false;this._protocol="";this._readyState=WebSocket.CONNECTING;this._receiver=null;this._sender=null;this._socket=null;if(e!==null){this._bufferedAmount=0;this._isServer=false;this._redirects=0;if(t===undefined){t=[]}else if(!Array.isArray(t)){if(typeof t==="object"&&t!==null){r=t;t=[]}else{t=[t]}}initAsClient(this,e,t,r)}else{this._isServer=true}}get binaryType(){return this._binaryType}set binaryType(e){if(!g.includes(e))return;this._binaryType=e;if(this._receiver)this._receiver._binaryType=e}get bufferedAmount(){if(!this._socket)return this._bufferedAmount;return this._socket._writableState.length+this._sender._bufferedBytes}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,r){const i=new p({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:r.maxPayload,skipUTF8Validation:r.skipUTF8Validation});this._sender=new b(e,this._extensions,r.generateMask);this._receiver=i;this._socket=e;i[v]=this;e[v]=this;i.on("conclude",receiverOnConclude);i.on("drain",receiverOnDrain);i.on("error",receiverOnError);i.on("message",receiverOnMessage);i.on("ping",receiverOnPing);i.on("pong",receiverOnPong);e.setTimeout(0);e.setNoDelay();if(t.length>0)e.unshift(t);e.on("close",socketOnClose);e.on("data",socketOnData);e.on("end",socketOnEnd);e.on("error",socketOnError);this._readyState=WebSocket.OPEN;this.emit("open")}emitClose(){if(!this._socket){this._readyState=WebSocket.CLOSED;this.emit("close",this._closeCode,this._closeMessage);return}if(this._extensions[d.extensionName]){this._extensions[d.extensionName].cleanup()}this._receiver.removeAllListeners();this._readyState=WebSocket.CLOSED;this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState===WebSocket.CLOSED)return;if(this.readyState===WebSocket.CONNECTING){const e="WebSocket was closed before the connection was established";abortHandshake(this,this._req,e);return}if(this.readyState===WebSocket.CLOSING){if(this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)){this._socket.end()}return}this._readyState=WebSocket.CLOSING;this._sender.close(e,t,!this._isServer,(e=>{if(e)return;this._closeFrameSent=true;if(this._closeFrameReceived||this._receiver._writableState.errorEmitted){this._socket.end()}}));this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),x)}pause(){if(this.readyState===WebSocket.CONNECTING||this.readyState===WebSocket.CLOSED){return}this._paused=true;this._socket.pause()}ping(e,t,r){if(this.readyState===WebSocket.CONNECTING){throw new Error("WebSocket is not open: readyState 0 (CONNECTING)")}if(typeof e==="function"){r=e;e=t=undefined}else if(typeof t==="function"){r=t;t=undefined}if(typeof e==="number")e=e.toString();if(this.readyState!==WebSocket.OPEN){sendAfterClose(this,e,r);return}if(t===undefined)t=!this._isServer;this._sender.ping(e||_,t,r)}pong(e,t,r){if(this.readyState===WebSocket.CONNECTING){throw new Error("WebSocket is not open: readyState 0 (CONNECTING)")}if(typeof e==="function"){r=e;e=t=undefined}else if(typeof t==="function"){r=t;t=undefined}if(typeof e==="number")e=e.toString();if(this.readyState!==WebSocket.OPEN){sendAfterClose(this,e,r);return}if(t===undefined)t=!this._isServer;this._sender.pong(e||_,t,r)}resume(){if(this.readyState===WebSocket.CONNECTING||this.readyState===WebSocket.CLOSED){return}this._paused=false;if(!this._receiver._writableState.needDrain)this._socket.resume()}send(e,t,r){if(this.readyState===WebSocket.CONNECTING){throw new Error("WebSocket is not open: readyState 0 (CONNECTING)")}if(typeof t==="function"){r=t;t={}}if(typeof e==="number")e=e.toString();if(this.readyState!==WebSocket.OPEN){sendAfterClose(this,e,r);return}const i={binary:typeof e!=="string",mask:!this._isServer,compress:true,fin:true,...t};if(!this._extensions[d.extensionName]){i.compress=false}this._sender.send(e||_,i,r)}terminate(){if(this.readyState===WebSocket.CLOSED)return;if(this.readyState===WebSocket.CONNECTING){const e="WebSocket was closed before the connection was established";abortHandshake(this,this._req,e);return}if(this._socket){this._readyState=WebSocket.CLOSING;this._socket.destroy()}}}Object.defineProperty(WebSocket,"CONNECTING",{enumerable:true,value:B.indexOf("CONNECTING")});Object.defineProperty(WebSocket.prototype,"CONNECTING",{enumerable:true,value:B.indexOf("CONNECTING")});Object.defineProperty(WebSocket,"OPEN",{enumerable:true,value:B.indexOf("OPEN")});Object.defineProperty(WebSocket.prototype,"OPEN",{enumerable:true,value:B.indexOf("OPEN")});Object.defineProperty(WebSocket,"CLOSING",{enumerable:true,value:B.indexOf("CLOSING")});Object.defineProperty(WebSocket.prototype,"CLOSING",{enumerable:true,value:B.indexOf("CLOSING")});Object.defineProperty(WebSocket,"CLOSED",{enumerable:true,value:B.indexOf("CLOSED")});Object.defineProperty(WebSocket.prototype,"CLOSED",{enumerable:true,value:B.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(WebSocket.prototype,e,{enumerable:true})}));["open","error","close","message"].forEach((e=>{Object.defineProperty(WebSocket.prototype,`on${e}`,{enumerable:true,get(){for(const t of this.listeners(e)){if(t[y])return t[w]}return null},set(t){for(const t of this.listeners(e)){if(t[y]){this.removeListener(e,t);break}}if(typeof t!=="function")return;this.addEventListener(e,t,{[y]:true})}})}));WebSocket.prototype.addEventListener=T;WebSocket.prototype.removeEventListener=R;e.exports=WebSocket;function initAsClient(e,t,r,i){const o={protocolVersion:P[1],maxPayload:100*1024*1024,skipUTF8Validation:false,perMessageDeflate:true,followRedirects:false,maxRedirects:10,...i,createConnection:undefined,socketPath:undefined,hostname:undefined,protocol:undefined,timeout:undefined,method:"GET",host:undefined,path:undefined,port:undefined};if(!P.includes(o.protocolVersion)){throw new RangeError(`Unsupported protocol version: ${o.protocolVersion} `+`(supported versions: ${P.join(", ")})`)}let a;if(t instanceof h){a=t;e._url=t.href}else{try{a=new h(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}e._url=t}const c=a.protocol==="wss:";const p=a.protocol==="ws+unix:";let b;if(a.protocol!=="ws:"&&!c&&!p){b='The URL\'s protocol must be one of "ws:", "wss:", or "ws+unix:"'}else if(p&&!a.pathname){b="The URL's pathname is empty"}else if(a.hash){b="The URL contains a fragment identifier"}if(b){const t=new SyntaxError(b);if(e._redirects===0){throw t}else{emitErrorAndClose(e,t);return}}const g=c?443:80;const _=l(16).toString("base64");const y=c?n.request:s.request;const w=new Set;let S;o.createConnection=c?tlsConnect:netConnect;o.defaultPort=o.defaultPort||g;o.port=a.port||g;o.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname;o.headers={...o.headers,"Sec-WebSocket-Version":o.protocolVersion,"Sec-WebSocket-Key":_,Connection:"Upgrade",Upgrade:"websocket"};o.path=a.pathname+a.search;o.timeout=o.handshakeTimeout;if(o.perMessageDeflate){S=new d(o.perMessageDeflate!==true?o.perMessageDeflate:{},false,o.maxPayload);o.headers["Sec-WebSocket-Extensions"]=A({[d.extensionName]:S.offer()})}if(r.length){for(const e of r){if(typeof e!=="string"||!M.test(e)||w.has(e)){throw new SyntaxError("An invalid or duplicated subprotocol was specified")}w.add(e)}o.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(o.origin){if(o.protocolVersion<13){o.headers["Sec-WebSocket-Origin"]=o.origin}else{o.headers.Origin=o.origin}}if(a.username||a.password){o.auth=`${a.username}:${a.password}`}if(p){const e=o.path.split(":");o.socketPath=e[0];o.path=e[1]}let v;if(o.followRedirects){if(e._redirects===0){e._originalIpc=p;e._originalSecure=c;e._originalHostOrSocketPath=p?o.socketPath:a.host;const t=i&&i.headers;i={...i,headers:{}};if(t){for(const[e,r]of Object.entries(t)){i.headers[e.toLowerCase()]=r}}}else if(e.listenerCount("redirect")===0){const t=p?e._originalIpc?o.socketPath===e._originalHostOrSocketPath:false:e._originalIpc?false:a.host===e._originalHostOrSocketPath;if(!t||e._originalSecure&&!c){delete o.headers.authorization;delete o.headers.cookie;if(!t)delete o.headers.host;o.auth=undefined}}if(o.auth&&!i.headers.authorization){i.headers.authorization="Basic "+Buffer.from(o.auth).toString("base64")}v=e._req=y(o);if(e._redirects){e.emit("redirect",e.url,v)}}else{v=e._req=y(o)}if(o.timeout){v.on("timeout",(()=>{abortHandshake(e,v,"Opening handshake has timed out")}))}v.on("error",(t=>{if(v===null||v[C])return;v=e._req=null;emitErrorAndClose(e,t)}));v.on("response",(n=>{const s=n.headers.location;const a=n.statusCode;if(s&&o.followRedirects&&a>=300&&a<400){if(++e._redirects>o.maxRedirects){abortHandshake(e,v,"Maximum redirects exceeded");return}v.abort();let n;try{n=new h(s,t)}catch(t){const r=new SyntaxError(`Invalid URL: ${s}`);emitErrorAndClose(e,r);return}initAsClient(e,n,r,i)}else if(!e.emit("unexpected-response",v,n)){abortHandshake(e,v,`Unexpected server response: ${n.statusCode}`)}}));v.on("upgrade",((t,r,i)=>{e.emit("upgrade",t);if(e.readyState!==WebSocket.CONNECTING)return;v=e._req=null;if(t.headers.upgrade.toLowerCase()!=="websocket"){abortHandshake(e,r,"Invalid Upgrade header");return}const n=u("sha1").update(_+m).digest("base64");if(t.headers["sec-websocket-accept"]!==n){abortHandshake(e,r,"Invalid Sec-WebSocket-Accept header");return}const s=t.headers["sec-websocket-protocol"];let a;if(s!==undefined){if(!w.size){a="Server sent a subprotocol but none was requested"}else if(!w.has(s)){a="Server sent an invalid subprotocol"}}else if(w.size){a="Server sent no subprotocol"}if(a){abortHandshake(e,r,a);return}if(s)e._protocol=s;const l=t.headers["sec-websocket-extensions"];if(l!==undefined){if(!S){const t="Server sent a Sec-WebSocket-Extensions header but no extension "+"was requested";abortHandshake(e,r,t);return}let t;try{t=I(l)}catch(t){const i="Invalid Sec-WebSocket-Extensions header";abortHandshake(e,r,i);return}const i=Object.keys(t);if(i.length!==1||i[0]!==d.extensionName){const t="Server indicated an extension that was not requested";abortHandshake(e,r,t);return}try{S.accept(t[d.extensionName])}catch(t){const i="Invalid Sec-WebSocket-Extensions header";abortHandshake(e,r,i);return}e._extensions[d.extensionName]=S}e.setSocket(r,i,{generateMask:o.generateMask,maxPayload:o.maxPayload,skipUTF8Validation:o.skipUTF8Validation})}));if(o.finishRequest){o.finishRequest(v,e)}else{v.end()}}function emitErrorAndClose(e,t){e._readyState=WebSocket.CLOSING;e.emit("error",t);e.emitClose()}function netConnect(e){e.path=e.socketPath;return o.connect(e)}function tlsConnect(e){e.path=undefined;if(!e.servername&&e.servername!==""){e.servername=o.isIP(e.host)?"":e.host}return a.connect(e)}function abortHandshake(e,t,r){e._readyState=WebSocket.CLOSING;const i=new Error(r);Error.captureStackTrace(i,abortHandshake);if(t.setHeader){t[C]=true;t.abort();if(t.socket&&!t.socket.destroyed){t.socket.destroy()}process.nextTick(emitErrorAndClose,e,i)}else{t.destroy(i);t.once("error",e.emit.bind(e,"error"));t.once("close",e.emitClose.bind(e))}}function sendAfterClose(e,t,r){if(t){const r=O(t).length;if(e._socket)e._sender._bufferedBytes+=r;else e._bufferedAmount+=r}if(r){const t=new Error(`WebSocket is not open: readyState ${e.readyState} `+`(${B[e.readyState]})`);process.nextTick(r,t)}}function receiverOnConclude(e,t){const r=this[v];r._closeFrameReceived=true;r._closeMessage=t;r._closeCode=e;if(r._socket[v]===undefined)return;r._socket.removeListener("data",socketOnData);process.nextTick(resume,r._socket);if(e===1005)r.close();else r.close(e,t)}function receiverOnDrain(){const e=this[v];if(!e.isPaused)e._socket.resume()}function receiverOnError(e){const t=this[v];if(t._socket[v]!==undefined){t._socket.removeListener("data",socketOnData);process.nextTick(resume,t._socket);t.close(e[S])}t.emit("error",e)}function receiverOnFinish(){this[v].emitClose()}function receiverOnMessage(e,t){this[v].emit("message",e,t)}function receiverOnPing(e){const t=this[v];t.pong(e,!t._isServer,k);t.emit("ping",e)}function receiverOnPong(e){this[v].emit("pong",e)}function resume(e){e.resume()}function socketOnClose(){const e=this[v];this.removeListener("close",socketOnClose);this.removeListener("data",socketOnData);this.removeListener("end",socketOnEnd);e._readyState=WebSocket.CLOSING;let t;if(!this._readableState.endEmitted&&!e._closeFrameReceived&&!e._receiver._writableState.errorEmitted&&(t=e._socket.read())!==null){e._receiver.write(t)}e._receiver.end();this[v]=undefined;clearTimeout(e._closeTimer);if(e._receiver._writableState.finished||e._receiver._writableState.errorEmitted){e.emitClose()}else{e._receiver.on("error",receiverOnFinish);e._receiver.on("finish",receiverOnFinish)}}function socketOnData(e){if(!this[v]._receiver.write(e)){this.pause()}}function socketOnEnd(){const e=this[v];e._readyState=WebSocket.CLOSING;e._receiver.end();this.end()}function socketOnError(){const e=this[v];this.removeListener("error",socketOnError);this.on("error",k);if(e){e._readyState=WebSocket.CLOSING;this.destroy()}}},3357:module=>{module.exports=eval("require")("bufferutil")},6750:module=>{module.exports=eval("require")("supports-color")},6700:module=>{module.exports=eval("require")("utf-8-validate")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2781:e=>{"use strict";e.exports=require("stream")},1576:e=>{"use strict";e.exports=require("string_decoder")},4404:e=>{"use strict";e.exports=require("tls")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},5393:e=>{const t=typeof performance==="object"&&performance&&typeof performance.now==="function"?performance:Date;const r=typeof AbortController==="function";const i=r?AbortController:class AbortController{constructor(){this.signal=new o}abort(e=new Error("This operation was aborted")){this.signal.reason=this.signal.reason||e;this.signal.aborted=true;this.signal.dispatchEvent({type:"abort",target:this.signal})}};const n=typeof AbortSignal==="function";const s=typeof i.AbortSignal==="function";const o=n?AbortSignal:s?i.AbortController:class AbortSignal{constructor(){this.reason=undefined;this.aborted=false;this._listeners=[]}dispatchEvent(e){if(e.type==="abort"){this.aborted=true;this.onabort(e);this._listeners.forEach((t=>t(e)),this)}}onabort(){}addEventListener(e,t){if(e==="abort"){this._listeners.push(t)}}removeEventListener(e,t){if(e==="abort"){this._listeners=this._listeners.filter((e=>e!==t))}}};const a=new Set;const deprecatedOption=(e,t)=>{const r=`LRU_CACHE_OPTION_${e}`;if(shouldWarn(r)){warn(r,`${e} option`,`options.${t}`,LRUCache)}};const deprecatedMethod=(e,t)=>{const r=`LRU_CACHE_METHOD_${e}`;if(shouldWarn(r)){const{prototype:i}=LRUCache;const{get:n}=Object.getOwnPropertyDescriptor(i,e);warn(r,`${e} method`,`cache.${t}()`,n)}};const deprecatedProperty=(e,t)=>{const r=`LRU_CACHE_PROPERTY_${e}`;if(shouldWarn(r)){const{prototype:i}=LRUCache;const{get:n}=Object.getOwnPropertyDescriptor(i,e);warn(r,`${e} property`,`cache.${t}`,n)}};const emitWarning=(...e)=>{typeof process==="object"&&process&&typeof process.emitWarning==="function"?process.emitWarning(...e):console.error(...e)};const shouldWarn=e=>!a.has(e);const warn=(e,t,r,i)=>{a.add(e);const n=`The ${t} is deprecated. Please use ${r} instead.`;emitWarning(n,"DeprecationWarning",e,i)};const isPosInt=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e);const getUintArray=e=>!isPosInt(e)?null:e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?ZeroArray:null;class ZeroArray extends Array{constructor(e){super(e);this.fill(0)}}class Stack{constructor(e){if(e===0){return[]}const t=getUintArray(e);this.heap=new t(e);this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class LRUCache{constructor(e={}){const{max:t=0,ttl:r,ttlResolution:i=1,ttlAutopurge:n,updateAgeOnGet:s,updateAgeOnHas:o,allowStale:l,dispose:u,disposeAfter:c,noDisposeOnSet:h,noUpdateTTL:d,maxSize:p=0,maxEntrySize:b=0,sizeCalculation:g,fetchMethod:_,fetchContext:m,noDeleteOnFetchRejection:y,noDeleteOnStaleGet:w,allowStaleOnFetchRejection:S,allowStaleOnFetchAbort:v,ignoreFetchAbort:k}=e;const{length:T,maxAge:R,stale:A}=e instanceof LRUCache?{}:e;if(t!==0&&!isPosInt(t)){throw new TypeError("max option must be a nonnegative integer")}const I=t?getUintArray(t):Array;if(!I){throw new Error("invalid max value: "+t)}this.max=t;this.maxSize=p;this.maxEntrySize=b||this.maxSize;this.sizeCalculation=g||T;if(this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize){throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize")}if(typeof this.sizeCalculation!=="function"){throw new TypeError("sizeCalculation set to non-function")}}this.fetchMethod=_||null;if(this.fetchMethod&&typeof this.fetchMethod!=="function"){throw new TypeError("fetchMethod must be a function if specified")}this.fetchContext=m;if(!this.fetchMethod&&m!==undefined){throw new TypeError("cannot set fetchContext without fetchMethod")}this.keyMap=new Map;this.keyList=new Array(t).fill(null);this.valList=new Array(t).fill(null);this.next=new I(t);this.prev=new I(t);this.head=0;this.tail=0;this.free=new Stack(t);this.initialFill=1;this.size=0;if(typeof u==="function"){this.dispose=u}if(typeof c==="function"){this.disposeAfter=c;this.disposed=[]}else{this.disposeAfter=null;this.disposed=null}this.noDisposeOnSet=!!h;this.noUpdateTTL=!!d;this.noDeleteOnFetchRejection=!!y;this.allowStaleOnFetchRejection=!!S;this.allowStaleOnFetchAbort=!!v;this.ignoreFetchAbort=!!k;if(this.maxEntrySize!==0){if(this.maxSize!==0){if(!isPosInt(this.maxSize)){throw new TypeError("maxSize must be a positive integer if specified")}}if(!isPosInt(this.maxEntrySize)){throw new TypeError("maxEntrySize must be a positive integer if specified")}this.initializeSizeTracking()}this.allowStale=!!l||!!A;this.noDeleteOnStaleGet=!!w;this.updateAgeOnGet=!!s;this.updateAgeOnHas=!!o;this.ttlResolution=isPosInt(i)||i===0?i:1;this.ttlAutopurge=!!n;this.ttl=r||R||0;if(this.ttl){if(!isPosInt(this.ttl)){throw new TypeError("ttl must be a positive integer if specified")}this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0){throw new TypeError("At least one of max, maxSize, or ttl is required")}if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const e="LRU_CACHE_UNBOUNDED";if(shouldWarn(e)){a.add(e);const t="TTL caching without ttlAutopurge, max, or maxSize can "+"result in unbounded memory consumption.";emitWarning(t,"UnboundedCacheWarning",e,LRUCache)}}if(A){deprecatedOption("stale","allowStale")}if(R){deprecatedOption("maxAge","ttl")}if(T){deprecatedOption("length","sizeCalculation")}}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:false})?Infinity:0}initializeTTLTracking(){this.ttls=new ZeroArray(this.max);this.starts=new ZeroArray(this.max);this.setItemTTL=(e,r,i=t.now())=>{this.starts[e]=r!==0?i:0;this.ttls[e]=r;if(r!==0&&this.ttlAutopurge){const t=setTimeout((()=>{if(this.isStale(e)){this.delete(this.keyList[e])}}),r+1);if(t.unref){t.unref()}}};this.updateItemAge=e=>{this.starts[e]=this.ttls[e]!==0?t.now():0};this.statusTTL=(t,r)=>{if(t){t.ttl=this.ttls[r];t.start=this.starts[r];t.now=e||getNow();t.remainingTTL=t.now+t.ttl-t.start}};let e=0;const getNow=()=>{const r=t.now();if(this.ttlResolution>0){e=r;const t=setTimeout((()=>e=0),this.ttlResolution);if(t.unref){t.unref()}}return r};this.getRemainingTTL=t=>{const r=this.keyMap.get(t);if(r===undefined){return 0}return this.ttls[r]===0||this.starts[r]===0?Infinity:this.starts[r]+this.ttls[r]-(e||getNow())};this.isStale=t=>this.ttls[t]!==0&&this.starts[t]!==0&&(e||getNow())-this.starts[t]>this.ttls[t]}updateItemAge(e){}statusTTL(e,t){}setItemTTL(e,t,r){}isStale(e){return false}initializeSizeTracking(){this.calculatedSize=0;this.sizes=new ZeroArray(this.max);this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e];this.sizes[e]=0};this.requireSize=(e,t,r,i)=>{if(this.isBackgroundFetch(t)){return 0}if(!isPosInt(r)){if(i){if(typeof i!=="function"){throw new TypeError("sizeCalculation must be a function")}r=i(t,e);if(!isPosInt(r)){throw new TypeError("sizeCalculation return invalid (expect positive integer)")}}else{throw new TypeError("invalid size value (must be positive integer). "+"When maxSize or maxEntrySize is used, sizeCalculation or size "+"must be set.")}}return r};this.addItemSize=(e,t,r)=>{this.sizes[e]=t;if(this.maxSize){const t=this.maxSize-this.sizes[e];while(this.calculatedSize>t){this.evict(true)}}this.calculatedSize+=this.sizes[e];if(r){r.entrySize=t;r.totalCalculatedSize=this.calculatedSize}}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,r,i){if(r||i){throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}}*indexes({allowStale:e=this.allowStale}={}){if(this.size){for(let t=this.tail;true;){if(!this.isValidIndex(t)){break}if(e||!this.isStale(t)){yield t}if(t===this.head){break}else{t=this.prev[t]}}}}*rindexes({allowStale:e=this.allowStale}={}){if(this.size){for(let t=this.head;true;){if(!this.isValidIndex(t)){break}if(e||!this.isStale(t)){yield t}if(t===this.tail){break}else{t=this.next[t]}}}}isValidIndex(e){return e!==undefined&&this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes()){if(this.valList[e]!==undefined&&this.keyList[e]!==undefined&&!this.isBackgroundFetch(this.valList[e])){yield[this.keyList[e],this.valList[e]]}}}*rentries(){for(const e of this.rindexes()){if(this.valList[e]!==undefined&&this.keyList[e]!==undefined&&!this.isBackgroundFetch(this.valList[e])){yield[this.keyList[e],this.valList[e]]}}}*keys(){for(const e of this.indexes()){if(this.keyList[e]!==undefined&&!this.isBackgroundFetch(this.valList[e])){yield this.keyList[e]}}}*rkeys(){for(const e of this.rindexes()){if(this.keyList[e]!==undefined&&!this.isBackgroundFetch(this.valList[e])){yield this.keyList[e]}}}*values(){for(const e of this.indexes()){if(this.valList[e]!==undefined&&!this.isBackgroundFetch(this.valList[e])){yield this.valList[e]}}}*rvalues(){for(const e of this.rindexes()){if(this.valList[e]!==undefined&&!this.isBackgroundFetch(this.valList[e])){yield this.valList[e]}}}[Symbol.iterator](){return this.entries()}find(e,t){for(const r of this.indexes()){const i=this.valList[r];const n=this.isBackgroundFetch(i)?i.__staleWhileFetching:i;if(n===undefined)continue;if(e(n,this.keyList[r],this)){return this.get(this.keyList[r],t)}}}forEach(e,t=this){for(const r of this.indexes()){const i=this.valList[r];const n=this.isBackgroundFetch(i)?i.__staleWhileFetching:i;if(n===undefined)continue;e.call(t,n,this.keyList[r],this)}}rforEach(e,t=this){for(const r of this.rindexes()){const i=this.valList[r];const n=this.isBackgroundFetch(i)?i.__staleWhileFetching:i;if(n===undefined)continue;e.call(t,n,this.keyList[r],this)}}get prune(){deprecatedMethod("prune","purgeStale");return this.purgeStale}purgeStale(){let e=false;for(const t of this.rindexes({allowStale:true})){if(this.isStale(t)){this.delete(this.keyList[t]);e=true}}return e}dump(){const e=[];for(const r of this.indexes({allowStale:true})){const i=this.keyList[r];const n=this.valList[r];const s=this.isBackgroundFetch(n)?n.__staleWhileFetching:n;if(s===undefined)continue;const o={value:s};if(this.ttls){o.ttl=this.ttls[r];const e=t.now()-this.starts[r];o.start=Math.floor(Date.now()-e)}if(this.sizes){o.size=this.sizes[r]}e.unshift([i,o])}return e}load(e){this.clear();for(const[r,i]of e){if(i.start){const e=Date.now()-i.start;i.start=t.now()-e}this.set(r,i.value,i)}}dispose(e,t,r){}set(e,t,{ttl:r=this.ttl,start:i,noDisposeOnSet:n=this.noDisposeOnSet,size:s=0,sizeCalculation:o=this.sizeCalculation,noUpdateTTL:a=this.noUpdateTTL,status:l}={}){s=this.requireSize(e,t,s,o);if(this.maxEntrySize&&s>this.maxEntrySize){if(l){l.set="miss";l.maxEntrySizeExceeded=true}this.delete(e);return this}let u=this.size===0?undefined:this.keyMap.get(e);if(u===undefined){u=this.newIndex();this.keyList[u]=e;this.valList[u]=t;this.keyMap.set(e,u);this.next[this.tail]=u;this.prev[u]=this.tail;this.tail=u;this.size++;this.addItemSize(u,s,l);if(l){l.set="add"}a=false}else{this.moveToTail(u);const r=this.valList[u];if(t!==r){if(this.isBackgroundFetch(r)){r.__abortController.abort(new Error("replaced"))}else{if(!n){this.dispose(r,e,"set");if(this.disposeAfter){this.disposed.push([r,e,"set"])}}}this.removeItemSize(u);this.valList[u]=t;this.addItemSize(u,s,l);if(l){l.set="replace";const e=r&&this.isBackgroundFetch(r)?r.__staleWhileFetching:r;if(e!==undefined)l.oldValue=e}}else if(l){l.set="update"}}if(r!==0&&this.ttl===0&&!this.ttls){this.initializeTTLTracking()}if(!a){this.setItemTTL(u,r,i)}this.statusTTL(l,u);if(this.disposeAfter){while(this.disposed.length){this.disposeAfter(...this.disposed.shift())}}return this}newIndex(){if(this.size===0){return this.tail}if(this.size===this.max&&this.max!==0){return this.evict(false)}if(this.free.length!==0){return this.free.pop()}return this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];this.evict(true);return e}}evict(e){const t=this.head;const r=this.keyList[t];const i=this.valList[t];if(this.isBackgroundFetch(i)){i.__abortController.abort(new Error("evicted"))}else{this.dispose(i,r,"evict");if(this.disposeAfter){this.disposed.push([i,r,"evict"])}}this.removeItemSize(t);if(e){this.keyList[t]=null;this.valList[t]=null;this.free.push(t)}this.head=this.next[t];this.keyMap.delete(r);this.size--;return t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas,status:r}={}){const i=this.keyMap.get(e);if(i!==undefined){if(!this.isStale(i)){if(t){this.updateItemAge(i)}if(r)r.has="hit";this.statusTTL(r,i);return true}else if(r){r.has="stale";this.statusTTL(r,i)}}else if(r){r.has="miss"}return false}peek(e,{allowStale:t=this.allowStale}={}){const r=this.keyMap.get(e);if(r!==undefined&&(t||!this.isStale(r))){const e=this.valList[r];return this.isBackgroundFetch(e)?e.__staleWhileFetching:e}}backgroundFetch(e,t,r,n){const s=t===undefined?undefined:this.valList[t];if(this.isBackgroundFetch(s)){return s}const o=new i;if(r.signal){r.signal.addEventListener("abort",(()=>o.abort(r.signal.reason)))}const a={signal:o.signal,options:r,context:n};const cb=(i,n=false)=>{const{aborted:s}=o.signal;const u=r.ignoreFetchAbort&&i!==undefined;if(r.status){if(s&&!n){r.status.fetchAborted=true;r.status.fetchError=o.signal.reason;if(u)r.status.fetchAbortIgnored=true}else{r.status.fetchResolved=true}}if(s&&!u&&!n){return fetchFail(o.signal.reason)}if(this.valList[t]===l){if(i===undefined){if(l.__staleWhileFetching){this.valList[t]=l.__staleWhileFetching}else{this.delete(e)}}else{if(r.status)r.status.fetchUpdated=true;this.set(e,i,a.options)}}return i};const eb=e=>{if(r.status){r.status.fetchRejected=true;r.status.fetchError=e}return fetchFail(e)};const fetchFail=i=>{const{aborted:n}=o.signal;const s=n&&r.allowStaleOnFetchAbort;const a=s||r.allowStaleOnFetchRejection;const u=a||r.noDeleteOnFetchRejection;if(this.valList[t]===l){const r=!u||l.__staleWhileFetching===undefined;if(r){this.delete(e)}else if(!s){this.valList[t]=l.__staleWhileFetching}}if(a){if(r.status&&l.__staleWhileFetching!==undefined){r.status.returnedStale=true}return l.__staleWhileFetching}else if(l.__returned===l){throw i}};const pcall=(t,i)=>{this.fetchMethod(e,s,a).then((e=>t(e)),i);o.signal.addEventListener("abort",(()=>{if(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort){t();if(r.allowStaleOnFetchAbort){t=e=>cb(e,true)}}}))};if(r.status)r.status.fetchDispatched=true;const l=new Promise(pcall).then(cb,eb);l.__abortController=o;l.__staleWhileFetching=s;l.__returned=null;if(t===undefined){this.set(e,l,{...a.options,status:undefined});t=this.keyMap.get(e)}else{this.valList[t]=l}return l}isBackgroundFetch(e){return e&&typeof e==="object"&&typeof e.then==="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||e.__returned===null)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,ttl:n=this.ttl,noDisposeOnSet:s=this.noDisposeOnSet,size:o=0,sizeCalculation:a=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL,noDeleteOnFetchRejection:u=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:c=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:d=this.allowStaleOnFetchAbort,fetchContext:p=this.fetchContext,forceRefresh:b=false,status:g,signal:_}={}){if(!this.fetchMethod){if(g)g.fetch="get";return this.get(e,{allowStale:t,updateAgeOnGet:r,noDeleteOnStaleGet:i,status:g})}const m={allowStale:t,updateAgeOnGet:r,noDeleteOnStaleGet:i,ttl:n,noDisposeOnSet:s,size:o,sizeCalculation:a,noUpdateTTL:l,noDeleteOnFetchRejection:u,allowStaleOnFetchRejection:c,allowStaleOnFetchAbort:d,ignoreFetchAbort:h,status:g,signal:_};let y=this.keyMap.get(e);if(y===undefined){if(g)g.fetch="miss";const t=this.backgroundFetch(e,y,m,p);return t.__returned=t}else{const i=this.valList[y];if(this.isBackgroundFetch(i)){const e=t&&i.__staleWhileFetching!==undefined;if(g){g.fetch="inflight";if(e)g.returnedStale=true}return e?i.__staleWhileFetching:i.__returned=i}const n=this.isStale(y);if(!b&&!n){if(g)g.fetch="hit";this.moveToTail(y);if(r){this.updateItemAge(y)}this.statusTTL(g,y);return i}const s=this.backgroundFetch(e,y,m,p);const o=s.__staleWhileFetching!==undefined;const a=o&&t;if(g){g.fetch=o&&n?"stale":"refresh";if(a&&n)g.returnedStale=true}return a?s.__staleWhileFetching:s.__returned=s}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,status:n}={}){const s=this.keyMap.get(e);if(s!==undefined){const o=this.valList[s];const a=this.isBackgroundFetch(o);this.statusTTL(n,s);if(this.isStale(s)){if(n)n.get="stale";if(!a){if(!i){this.delete(e)}if(n)n.returnedStale=t;return t?o:undefined}else{if(n){n.returnedStale=t&&o.__staleWhileFetching!==undefined}return t?o.__staleWhileFetching:undefined}}else{if(n)n.get="hit";if(a){return o.__staleWhileFetching}this.moveToTail(s);if(r){this.updateItemAge(s)}return o}}else if(n){n.get="miss"}}connect(e,t){this.prev[t]=e;this.next[e]=t}moveToTail(e){if(e!==this.tail){if(e===this.head){this.head=this.next[e]}else{this.connect(this.prev[e],this.next[e])}this.connect(this.tail,e);this.tail=e}}get del(){deprecatedMethod("del","delete");return this.delete}delete(e){let t=false;if(this.size!==0){const r=this.keyMap.get(e);if(r!==undefined){t=true;if(this.size===1){this.clear()}else{this.removeItemSize(r);const t=this.valList[r];if(this.isBackgroundFetch(t)){t.__abortController.abort(new Error("deleted"))}else{this.dispose(t,e,"delete");if(this.disposeAfter){this.disposed.push([t,e,"delete"])}}this.keyMap.delete(e);this.keyList[r]=null;this.valList[r]=null;if(r===this.tail){this.tail=this.prev[r]}else if(r===this.head){this.head=this.next[r]}else{this.next[this.prev[r]]=this.next[r];this.prev[this.next[r]]=this.prev[r]}this.size--;this.free.push(r)}}}if(this.disposed){while(this.disposed.length){this.disposeAfter(...this.disposed.shift())}}return t}clear(){for(const e of this.rindexes({allowStale:true})){const t=this.valList[e];if(this.isBackgroundFetch(t)){t.__abortController.abort(new Error("deleted"))}else{const r=this.keyList[e];this.dispose(t,r,"delete");if(this.disposeAfter){this.disposed.push([t,r,"delete"])}}}this.keyMap.clear();this.valList.fill(null);this.keyList.fill(null);if(this.ttls){this.ttls.fill(0);this.starts.fill(0)}if(this.sizes){this.sizes.fill(0)}this.head=0;this.tail=0;this.initialFill=1;this.free.length=0;this.calculatedSize=0;this.size=0;if(this.disposed){while(this.disposed.length){this.disposeAfter(...this.disposed.shift())}}}get reset(){deprecatedMethod("reset","clear");return this.clear}get length(){deprecatedProperty("length","size");return this.size}static get AbortController(){return i}static get AbortSignal(){return o}}e.exports=LRUCache}};var __webpack_module_cache__={};function __nccwpck_require__(e){var t=__webpack_module_cache__[e];if(t!==undefined){return t.exports}var r=__webpack_module_cache__[e]={exports:{}};var i=true;try{__webpack_modules__[e].call(r.exports,r,r.exports,__nccwpck_require__);i=false}finally{if(i)delete __webpack_module_cache__[e]}return r.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var __webpack_exports__=__nccwpck_require__(3333);module.exports=__webpack_exports__})();